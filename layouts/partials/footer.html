<script>
  var themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
  var themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
  const imagesDark = document.querySelectorAll('.img-dark');
  const imagesLight = document.querySelectorAll('.img-light');

  // Change the icons inside the button based on previous settings
  if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) &&
      window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    themeToggleLightIcon.classList.remove('hidden');
    imagesDark.forEach((image) => { image.classList.remove('hidden'); });
  } else {
    themeToggleDarkIcon.classList.remove('hidden');
    imagesLight.forEach((image) => { image.classList.remove('hidden'); });
  }

  // Function to toggle theme
  function toggleTheme(dark) {
    if (dark) {
      document.documentElement.classList.add('dark');
      themeToggleLightIcon.classList.remove('hidden');
      themeToggleDarkIcon.classList.add('hidden');
      imagesDark.forEach((image) => { image.classList.remove('hidden'); });
      imagesLight.forEach((image) => { image.classList.add('hidden'); });
    } else {
      document.documentElement.classList.remove('dark');
      themeToggleDarkIcon.classList.remove('hidden');
      themeToggleLightIcon.classList.add('hidden');
      imagesLight.forEach((image) => { image.classList.remove('hidden'); });
      imagesDark.forEach((image) => { image.classList.add('hidden'); });
    }
  }

  var themeToggleBtn = document.getElementById('theme-toggle');
  themeToggleBtn.addEventListener('click', function () {
    // toggle icons inside button
    themeToggleDarkIcon.classList.toggle('hidden');
    themeToggleLightIcon.classList.toggle('hidden');
    imagesLight.forEach((image) => { image.classList.toggle('hidden'); });
    imagesDark.forEach((image) => { image.classList.toggle('hidden'); });

    if (event.altKey) { // If Alt key is pressed during the click, reset to OS settings
      localStorage.removeItem('color-theme');
      toggleTheme(window.matchMedia('(prefers-color-scheme: dark)').matches)
    }
    else if (localStorage.getItem('color-theme')) { // if set via local storage previously
      if (localStorage.getItem('color-theme') === 'light') {
        document.documentElement.classList.add('dark');
        localStorage.setItem('color-theme', 'dark');
      } else {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('color-theme', 'light');
      }
    } else { // if NOT set via local storage previously
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('color-theme', 'light');
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('color-theme', 'dark');
      }
    }

  });

  // Listen for changes in the OS color theme
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
    if (localStorage.getItem('color-theme') === null) {
      const newColorScheme = e.matches ? "dark" : "light";
      toggleTheme(newColorScheme === 'dark');
    }
  });
</script>

<footer
  class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800">
  <span class="dark:text-gray-400 text-center">© 2013—2023 <span class="whitespace-nowrap">{{ i18n "andreyAkinshin" }}</span></span>
  <ul class="flex flex-wrap items-center px-4 mb-1">
    <li>
      <a href="https://github.com/AndreyAkinshin">
        <svg class="fai fai-link w-5 h-5">
          <title>GitHub</title>
          <use xlink:href="/img/fa/all.svg#github"></use>
        </svg>
      </a>
    </li>
    <li>
      <a href="https://twitter.com/andrey_akinshin">
        <svg class="fai fai-link w-5 h-5">
          <title>Twitter</title>
          <use xlink:href="/img/fa/all.svg#twitter"></use>
        </svg>
      </a>
    </li>
    <li>
      <a href='{{ ((.Site.GetPage "/posts").OutputFormats.Get "rss").Permalink }}'>
        <svg class="fai fai-link w-5 h-5">
          <title>RSS</title>
          <use xlink:href="/img/fa/all.svg#rss"></use>
        </svg>
      </a>
    </li>
  </ul>
  <div class="main-content">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
  </div>
</footer>