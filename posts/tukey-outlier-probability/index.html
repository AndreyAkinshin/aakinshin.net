<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Outlier detection"><title>Probability of observing outliers using Tukey's fences | Andrey Akinshin</title><meta name=description content="Tukey&amp;rsquo;s fences is one of the most popular simple outlier detectors for one-dimensional number arrays. This approach assumes that for a given sample, ..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.4b9b1feb2fd5d603661a92526f99ae8821dceff78915a43e751f547a64ae7a5d.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Probability of observing outliers using Tukey's fences</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2022-03-01>March 1, 2022</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/outlier-detection/>Outlier detection</a></div></div><br><div class=main-content><p><a href="https://en.wikipedia.org/wiki/Outlier#Tukey's_fences">Tukey&rsquo;s fences</a> is one of the most popular
simple outlier detectors for one-dimensional number arrays.
This approach assumes that for a given sample, we calculate first and third quartiles (<span class="math inline">\(Q_1\)</span> and <span class="math inline">\(Q_3\)</span>),
and mark all the sample elements outside the interval</p><p><span class="math display">\[[Q_1 - k (Q_3 - Q_1),\, Q_3 + k (Q_3 - Q_1)]
\]</span></p><p>as outliers.
Typical recommendation for <span class="math inline">\(k\)</span> is <span class="math inline">\(1.5\)</span> for &ldquo;regular&rdquo; outliers and <span class="math inline">\(3.0\)</span> for &ldquo;far outliers&rdquo;.
Here is a box plot example for a sample taken from the standard normal distributions (sample size is <span class="math inline">\(1000\)</span>):</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/tukey-outlier-probability/img/boxplot1-light.png target=_blank alt=boxplot1><img src=/posts/tukey-outlier-probability/img/boxplot1-light.png width=800></a>
<a class="img-dark hidden" href=/posts/tukey-outlier-probability/img/boxplot1-dark.png target=_blank alt=boxplot1><img src=/posts/tukey-outlier-probability/img/boxplot1-dark.png width=800></a></div><p>As we can see, 11 elements were marked as outliers (shown as dots).
Is it an expected result or not?
The answer depends on your goals.
There is no single definition of an outlier.
In fact, the chosen outlier detector provides a unique outlier definition.</p><p>In my applications, I typically consider outliers as rare events that should be investigated.
When I detect too many outliers, all such reports become useless noise.
For example, on the above image, I wouldn&rsquo;t treat any of the sample elements as outliers.
However, If we add <span class="math inline">\(10.0\)</span> to this sample, this element is an obvious outlier (which will be the only one):</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/tukey-outlier-probability/img/boxplot2-light.png target=_blank alt=boxplot2><img src=/posts/tukey-outlier-probability/img/boxplot2-light.png width=800></a>
<a class="img-dark hidden" href=/posts/tukey-outlier-probability/img/boxplot2-dark.png target=_blank alt=boxplot2><img src=/posts/tukey-outlier-probability/img/boxplot2-dark.png width=800></a></div><p>Thus, an important property of an outlier detector is the &ldquo;false positive rate&rdquo;:
the percentage of samples with detected outliers which I wouldn&rsquo;t treat as outliers.
In this post, I perform numerical simulations that show the probability of observing outliers
using Tukey&rsquo;s fences with different <span class="math inline">\(k\)</span> values.</p><h3 id=numerical-simulations>Numerical simulations</h3><p>Let&rsquo;s conduct the following numerical simulation:</p><ul><li>Enumerate different distributions.
We consider the standard normal distribution,
the standard Gumbel distribution, and the standard exponential distribution.</li><li>Enumerate different <span class="math inline">\(k\)</span> values.
We consider <span class="math inline">\(k \in \{ 1.5, 2.0, 2.5, 3.0, 3.5 \}\)</span>.</li><li>Enumerate different samples sizes from 6 to 500.</li><li>Generate 1000 random samples from the given distribution of the given size.</li><li>For each sample, detect outliers using the considered <span class="math inline">\(k\)</span> values.</li><li>Evaluate the percentage of samples that contain at least one outlier.</li></ul><p>Here are the results:</p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/tukey-outlier-probability/img/normal-light.png target=_blank alt=normal><img src=/posts/tukey-outlier-probability/img/normal-light.png width=800></a>
<a class="img-dark hidden" href=/posts/tukey-outlier-probability/img/normal-dark.png target=_blank alt=normal><img src=/posts/tukey-outlier-probability/img/normal-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/tukey-outlier-probability/img/gumbel-light.png target=_blank alt=gumbel><img src=/posts/tukey-outlier-probability/img/gumbel-light.png width=800></a>
<a class="img-dark hidden" href=/posts/tukey-outlier-probability/img/gumbel-dark.png target=_blank alt=gumbel><img src=/posts/tukey-outlier-probability/img/gumbel-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/tukey-outlier-probability/img/exp-light.png target=_blank alt=exp><img src=/posts/tukey-outlier-probability/img/exp-light.png width=800></a>
<a class="img-dark hidden" href=/posts/tukey-outlier-probability/img/exp-dark.png target=_blank alt=exp><img src=/posts/tukey-outlier-probability/img/exp-dark.png width=800></a></div></p><p>As we can see, the &ldquo;default&rdquo; <span class="math inline">\(k=1.5\)</span> provides extremely high detection rate.
For huge samples, we detect outliers in almost all the cases regardless of the chosen distribution.</p><p>More conservative values give lower detection rate for the normal distribution,
but they are still quite high for the Gumbel and the exponential distribution.</p></div><br><br><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f&title=Probability%20of%20observing%20outliers%20using%20Tukey%27s%20fences" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Probability%20of%20observing%20outliers%20using%20Tukey%27s%20fences&url=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f&title=Probability%20of%20observing%20outliers%20using%20Tukey%27s%20fences" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2022 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>anchors.options={placement:"left",icon:"§"},anchors.add("h1"),anchors.add("h2"),anchors.add("h3")</script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>