<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.74.3"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Statistics,Outliers"><title>Probability of observing outliers using Tukey's fences | Andrey Akinshin</title><meta name=description content="Tukey&amp;rsquo;s fences is one of the most popular simple outlier detectors for one-dimensional number arrays. This approach assumes that for a given sample, ..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=/css/lumen-bootstrap.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/slate-bootstrap.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><link href=/css/syntax-light.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/syntax-dark.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.26d61b7027fe55e642f0001cef94cb75b567d721086492aab6b4e32d9ee7811d.js></script><script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.882998740b9c4c24677576b997bde5a487246e2e3bd72128a0e922eaa59db029.mjs></script><link href=https://aakinshin.net/css/fontawesome-all.min.50da8736f05b35aac9691de67fe993cbe01b7d88fcf0cb682c3a8f39933fe4a3.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.2a76db7cc14055b3bafacc363f453917ab54a818a7db2a0a9b2409c0f6bf07c5.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.ae812fc71daf5160d927febda5a991cee6c361345e3f685d3736931ed7537986.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVB6MXSX32"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-ZVB6MXSX32');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-41419012-5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-41419012-5');</script><script type=text/javascript>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");ym(28700916,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src=https://mc.yandex.ru/watch/28700916 style=position:absolute;left:-9999px alt></div></noscript><script src=/js/jquery-3.3.1.slim.min.js></script></head><body><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class=nav-item><a class=nav-link id=nav-link-posts href=https://aakinshin.net/posts/>Posts</a></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li><li class=nav-item><a class=nav-link id=nav-link-pdnb href=https://aakinshin.net/prodotnetbenchmarking/>Pro .NET Benchmarking</a></li></ul><ul class="navbar-nav ml-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Probability of observing outliers using Tukey's fences</h1><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2022-03-01>March 1, 2022</time>
&nbsp;&nbsp;
<i class="fas fa-tag"></i>&nbsp;
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/outliers/ class="badge badge-info">Outliers</a></span><br><br><p><a href="https://en.wikipedia.org/wiki/Outlier#Tukey's_fences">Tukey&rsquo;s fences</a> is one of the most popular
simple outlier detectors for one-dimensional number arrays.
This approach assumes that for a given sample, we calculate first and third quartiles (<span class="math inline">\(Q_1\)</span> and <span class="math inline">\(Q_3\)</span>),
and mark all the sample elements outside the interval</p><p><span class="math display">\[[Q_1 - k (Q_3 - Q_1),\, Q_3 + k (Q_3 - Q_1)]
\]</span></p><p>as outliers.
Typical recommendation for <span class="math inline">\(k\)</span> is <span class="math inline">\(1.5\)</span> for &ldquo;regular&rdquo; outliers and <span class="math inline">\(3.0\)</span> for &ldquo;far outliers&rdquo;.
Here is a box plot example for a sample taken from the standard normal distributions (sample size is <span class="math inline">\(1000\)</span>):</p><div class=row><div class=mx-auto><a href=/posts/tukey-outlier-probability/img/boxplot1-light.png target=_blank class=imgldlink alt=boxplot1><picture>
<source theme=dark srcset=/posts/tukey-outlier-probability/img/boxplot1-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/tukey-outlier-probability/img/boxplot1-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/tukey-outlier-probability/img/boxplot1-light.png></picture></a></div></div><br><p>As we can see, 11 elements were marked as outliers (shown as dots).
Is it an expected result or not?
The answer depends on your goals.
There is no single definition of an outlier.
In fact, the chosen outlier detector provides a unique outlier definition.</p><p>In my applications, I typically consider outliers as rare events that should be investigated.
When I detect too many outliers, all such reports become useless noise.
For example, on the above image, I wouldn&rsquo;t treat any of the sample elements as outliers.
However, If we add <span class="math inline">\(10.0\)</span> to this sample, this element is an obvious outlier (which will be the only one):</p><div class=row><div class=mx-auto><a href=/posts/tukey-outlier-probability/img/boxplot2-light.png target=_blank class=imgldlink alt=boxplot2><picture>
<source theme=dark srcset=/posts/tukey-outlier-probability/img/boxplot2-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/tukey-outlier-probability/img/boxplot2-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/tukey-outlier-probability/img/boxplot2-light.png></picture></a></div></div><br><p>Thus, an important property of an outlier detector is the &ldquo;false positive rate&rdquo;:
the percentage of samples with detected outliers which I wouldn&rsquo;t treat as outliers.
In this post, I perform numerical simulations that show the probability of observing outliers
using Tukey&rsquo;s fences with different <span class="math inline">\(k\)</span> values.</p><h3 id=numerical-simulations>Numerical simulations</h3><p>Let&rsquo;s conduct the following numerical simulation:</p><ul><li>Enumerate different distributions.
We consider the standard normal distribution,
the standard Gumbel distribution, and the standard exponential distribution.</li><li>Enumerate different <span class="math inline">\(k\)</span> values.
We consider <span class="math inline">\(k \in \{ 1.5, 2.0, 2.5, 3.0, 3.5 \}\)</span>.</li><li>Enumerate different samples sizes from 6 to 500.</li><li>Generate 1000 random samples from the given distribution of the given size.</li><li>For each sample, detect outliers using the considered <span class="math inline">\(k\)</span> values.</li><li>Evaluate the percentage of samples that contain at least one outlier.</li></ul><p>Here are the results:</p><p><div class=row><div class=mx-auto><a href=/posts/tukey-outlier-probability/img/normal-light.png target=_blank class=imgldlink alt=normal><picture>
<source theme=dark srcset=/posts/tukey-outlier-probability/img/normal-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/tukey-outlier-probability/img/normal-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/tukey-outlier-probability/img/normal-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/tukey-outlier-probability/img/gumbel-light.png target=_blank class=imgldlink alt=gumbel><picture>
<source theme=dark srcset=/posts/tukey-outlier-probability/img/gumbel-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/tukey-outlier-probability/img/gumbel-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/tukey-outlier-probability/img/gumbel-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/tukey-outlier-probability/img/exp-light.png target=_blank class=imgldlink alt=exp><picture>
<source theme=dark srcset=/posts/tukey-outlier-probability/img/exp-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/tukey-outlier-probability/img/exp-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/tukey-outlier-probability/img/exp-light.png></picture></a></div></div><br></p><p>As we can see, the &ldquo;default&rdquo; <span class="math inline">\(k=1.5\)</span> provides extremely high detection rate.
For huge samples, we detect outliers in almost all the cases regardless of the chosen distribution.</p><p>More conservative values give lower detection rate for the normal distribution,
but they are still quite high for the Gumbel and the exponential distribution.</p><br><br><div class=row><div class="mx-auto share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f&title=Probability%20of%20observing%20outliers%20using%20Tukey%27s%20fences" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Probability%20of%20observing%20outliers%20using%20Tukey%27s%20fences&url=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x"></i></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2ftukey-outlier-probability%2f&title=Probability%20of%20observing%20outliers%20using%20Tukey%27s%20fences" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div></div></div><hr></div></div></main></div><footer class=blog-footer><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub></i></a><a href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter></i></a><a href=https://aakinshin.net/posts/index.xml><i class="fas fa-rss" title=RSS></i></a>|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.082780cb948cc57eabbc0d80172a7a5347d5572b599938b4c9876dfd7978b424.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/anchor.min.js></script><script src=https://aakinshin.net/js/custom.min.11932490dde776463ed165b345838c701accc0cfdedf2e0868f13415f41f0872.js></script><script>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true,},options:{skipHtmlTags:['script','noscript','style','textarea','pre'],ignoreHtmlClass:'tex2jax_ignore',processHtmlClass:'tex2jax_process'}};</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>