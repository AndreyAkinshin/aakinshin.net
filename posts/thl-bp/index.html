<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.7"><meta name=author content='Andrey Akinshin'><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content='Mathematics,Statistics,Research,Hodges-Lehmann estimator'><title>Trimmed Hodges-Lehmann location estimator, Part 1: breakdown point | Andrey Akinshin</title>
<meta name=description content="Introducing a trimmed modification of the Hodges-Lehmann location estimator and obtaining expressions for its finite-sample and asymptotic breakdown points"><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.d6826f88345af20c0769a313557ec1355465a3091b1f9869b936f2504c4dfe26.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body class="flex flex-col min-h-screen"><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-2 xs:px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/search/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#magnifying-glass"/></svg></a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6 flex-grow"><div class=main-post><h1 class=blog-post-title id=post-title>Trimmed Hodges-Lehmann location estimator, Part 1: breakdown point</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2023-01-03>January 3, 2023</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/><svg class="rating-icon"><use xlink:href="/img/fa/all.svg#math"/></svg>
Mathematics
</a><a class=label-link href=https://aakinshin.net/tags/statistics/><svg class="rating-icon"><use xlink:href="/img/fa/all.svg#statistics"/></svg>
Statistics
</a><a class=label-link href=https://aakinshin.net/tags/research/>Research
</a><a class=label-link href=https://aakinshin.net/tags/hodges-lehmann/>Hodges-Lehmann estimator</a></div></div><br><div class=main-content><p>For a sample $\mathbf{x} = \{ x_1, x_2, \ldots, x_n \}$,
the Hodges-Lehmann location estimator is defined as follows:</p>$$
\operatorname{HL}(\mathbf{x}) =
\underset{i < j}{\operatorname{median}}\biggl(\frac{x_i + x_j}{2}\biggr).
$$<p>Its asymptotic Gaussian efficiency is $\approx 96\%$,
while its asymptotic breakdown point is $\approx 29\%$.
This makes the Hodges-Lehmann location estimator a decent robust alternative to the mean.</p><p>While the Gaussian efficiency is quite impressive (almost as efficient as the mean),
the breakdown point is not as great as in the case of the median (which has a breakdown point of $50\%$).
Could we change this trade-off a little bit and make this estimator more robust,
sacrificing a small portion of efficiency?
Yes, we can!</p><p>In this post, I want to present the idea of the trimmed Hodges-Lehmann location estimator
and provide the exact equation for its breakdown point.</p><h3 id=trimming>Trimming</h3><p>The classic Hodges-Lehmann location estimator uses all the order statistics,
including the smallest and the largest sample elements.
But do we really need all of them to estimate the location?
It does not make much sense (especially if we treat the location as a measure of central tendency).
What if we drop a bunch of order statistics from both sides?</p><p>Let us consider the trimmed modification of the Hodges-Lehmann location estimator,
which omits the first $k$ and the last $k$ order statistics:</p>$$
\newcommand{\BP}{\operatorname{BP}}
\newcommand{\HL}{\operatorname{HL}}
\newcommand{\THL}{\operatorname{THL}}
\newcommand{\x}{\mathbf{x}}
\newcommand{\med}{\operatorname{median}}
\THL(\x, k) = \underset{k < i < j \leq n - k}{\med}\biggl(\frac{x_{(i)} + x_{(j)}}{2}\biggr).
$$<p>It is easy to see that $\HL(\x) = \THL(\x, 0)$.</p><h3 id=breakdown-point-of-the-hodges-lehmann-location-estimator>Breakdown point of the Hodges-Lehmann location estimator</h3><p>First of all, let us derive the breakdown point for the classic Hodges-Lehmann location estimator.
With this approach, we estimate the location as the sample median of the following set $U$:</p>$$
U = \biggl\{\frac{x_i + x_j}{2}\biggr\}_{i < j}.
$$<p>This set contains exactly $n (n - 1) / 2$ elements.
Let $p$ be the number of contaminated elements in the original sample $\x$.
Then, the number of non-contaminated elements in $U$ is $(n-1-p)(n-p)/2$.
The median of $U$ is not contaminated if the number of non-contaminated $U$ elements is larger
than half of the total number of $U$ elements:</p>$$
\frac{(n-1-p)(n-p)}{2} > \frac{n (n-1)}{4}.
$$<p>Simplifying this expression, we get:</p>$$
p^2 + p(1 - 2n) + \frac{1}{2}(n^2-n) > 0.
$$<p>From that, we can get the critical value of $p$:</p>$$
p^*_\HL(n) = n - \frac{1}{2} - \sqrt{\frac{n^2}{2} - \frac{n}{2} + \frac{1}{4}}.
$$<p>This gives us the breakdown point of $\HL$:</p>$$
\BP_\HL(n) = \frac{p^*_\HL(n)}{n} = 1 - \frac{1}{2n} - \sqrt{\frac{1}{2} - \frac{1}{2n} + \frac{1}{4n^2}}.
$$<p>Now it is easy to get the asymptotic breakdown point of $\HL$:</p>$$
\lim_{n \to \infty} \BP_\HL(n) = 1 - \sqrt{\frac{1}{2}} \approx 0.2928932.
$$<h3 id=breakdown-point-of-the-trimmed-hodges-lehmann-location-estimator>Breakdown point of the trimmed Hodges-Lehmann location estimator</h3><p>Now we derive the breakdown point for the trimmed modifications of the Hodges-Lehmann location estimator.
The corresponding critical value of $p$ can be found as the number of dropped elements from each side $k$
plus the Hodges-Lehmann location estimator breakdown point for a sample of size $n-2k$:</p>$$
p^*_\THL(n, k) = k + p^*_\HL(n - 2k) =
n - k - \frac{1}{2} - \sqrt{\frac{n^2}{2} - 2nk + 2k^2 - \frac{n}{2} + k + \frac{1}{4}}.
$$<p>It gives us the breakdown point of $\THL$:</p>$$
\BP_\THL(n, k) = \frac{p^*_\THL(n, k)}{n} =
1 - \frac{k}{n} - \frac{1}{2n} -
\sqrt{\frac{1}{2} - \frac{2k}{n} + \frac{2k^2}{n^2} - \frac{1}{2n} + \frac{k}{n^2} + \frac{1}{4n^2}}.
$$<p>Now let us express $k$ as a portion of $n$: $k = s \cdot n$.
With this substitution, $\BP_\THL(n, k)$ becomes:</p>$$
\BP_\THL(n, sn) = 1 - s - \frac{1}{2n} -
\sqrt{\frac{1}{2} - 2s + 2s^2 - \frac{1}{2n} + \frac{s}{n} + \frac{1}{4n^2}}.
$$<p>Now we can derive the asymptotic breakdown point of $\THL$:</p>$$
\lim_{n \to \infty} \BP_\THL(n, sn) = 1 - s - \sqrt{\frac{1}{2} - 2s + 2s^2}.
$$<p>Since</p>$$
\frac{1}{2} - 2s + 2s^2 = \Biggl(\frac{1}{\sqrt{2}} - \sqrt{2}s \Biggr)^2,
$$<p>the asymptotic breakdown point of $\THL$ can be expressed as</p>$$
\lim_{n \to \infty} \BP_\THL(n, sn) = 1 - s - \Biggl( \frac{1}{\sqrt{2}} - \sqrt{2}s \Biggr) =
\Biggl( \sqrt{2} - 1 \Biggr) \Biggl( s + \frac{1}{\sqrt{2}} \Biggr).
$$<p>As we can see, it is a linear dependency on $s$:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/thl-bp/img/thl_abp-light.svg target=_blank alt=thl_abp><img src=/posts/thl-bp/img/thl_abp-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/thl-bp/img/thl_abp-dark.svg target=_blank alt=thl_abp><img src=/posts/thl-bp/img/thl_abp-dark.svg width=800></a></div><h3 id=conclusion>Conclusion</h3><p>In this post, we introduced the concept of the trimmed Hodges-Lehmann location estimator
and derived the exact expressions for its finite-sample and asymptotic breakdown point.
In the next post, we explore its Gaussian efficiency values.</p><h3 id=references>References</h3><ul><li><b id=Hodges1963>[Hodges1963]</b><br>Hodges, J. L., and E. L. Lehmann. 1963. Estimates of location based on rank tests.
The Annals of Mathematical Statistics 34 (2):598–611.<br>DOI: <a href=https://dx.doi.org/10.1214/aoms/1177704172>10.1214/aoms/1177704172</a></li></ul></div><hr><h3 id=backlinks>Backlinks (1)</h3><ol><li><a href=https://aakinshin.net/posts/ title="Library / posts"><svg class="rating-icon"><use xlink:href="/img/fa/all.svg#note"/></svg>
</a><a href=https://aakinshin.net/posts/thl-ge/>Trimmed Hodges-Lehmann location estimator, Part 2: Gaussian efficiency
</a>(2023-01-10)
<span class=label title=References:1><svg class="rating-icon"><use xlink:href="/img/fa/all.svg#reference"/></svg>1</span>
<a href=https://aakinshin.net/tags/mathematics/><svg class="rating-icon"><title>Mathematics</title><use xlink:href="/img/fa/all.svg#math"/></svg>
</a><a href=https://aakinshin.net/tags/statistics/><svg class="rating-icon"><title>Statistics</title><use xlink:href="/img/fa/all.svg#statistics"/></svg></a></li></ol></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>