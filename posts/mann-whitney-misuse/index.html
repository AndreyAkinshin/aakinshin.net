<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Mann-Whitney U-test"><title>Examples of the Mann–Whitney U test misuse cases | Andrey Akinshin</title><meta name=description content="The Mann–Whitney U test is one of the most popular nonparametric statistical tests. Its alternative hypothesis claims that one distribution is stochastically greater than the other. However, people often misuse this test and try to apply it to check if two ..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.3694189c64d6e73f07022b9b02e5f1a3ce7adaa4b67d9bd3ed23e8f8115e6411.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Examples of the Mann–Whitney U test misuse cases</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2023-02-14>February 14, 2023</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/mann-whitney/>Mann-Whitney U-test</a></div></div><br><div class=main-content><p>The Mann–Whitney U test is one of the most popular nonparametric statistical tests.
Its alternative hypothesis claims that one distribution is stochastically greater than the other.
However, people often misuse this test and try to apply it to check
if two nonparametric distributions are not identical
or that there is a difference in distribution medians
(while there are no additional assumptions on the shapes of the distributions).
In this post, I show several cases in which the Mann–Whitney U test is not applicable
for comparing two distributions.</p><h3 id=simulation-design>Simulation design</h3><p>In the below case studies, we conduct numerical simulations according to the following scheme.
In each case study, we consider two different distributions: <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.
We
draw <span class="math inline">\(500\)</span> random samples of size <span class="math inline">\(5\,000\)</span> from each distribution,
perform the Mann–Whitney U test for each pair of samples,
calculate the p-value,
and build a distribution of p-values.
When the null hypothesis is true, we expect that p-values form the standard uniform distribution <span class="math inline">\(\mathcal{U}(0, 1)\)</span>.
When the alternative hypothesis is true, the distribution of p-values is expected to be heavily skewed.</p><p>If we falsely (!) assume that the alternative hypothesis claims that the distributions are non-identical,
we may expect a skewed distribution of p-values.
However, as we will see, this distribution is close to the uniform one.
This demonstrates that the Mann–Whitney U test is unsuitable for comparing such distributions.
Of course, it is not thorough research, but I believe that it is enough to illustrate the problem.</p><h3 id=case-study-1-normal-distributions-with-different-variances>Case study 1: Normal distributions with different variances</h3><p>For the first case study, we consider two normal distributions:
the standard normal distribution (<span class="math inline">\(\mu = 0,\, \sigma = 1\)</span>)
and a normal distribution with the same mean but increased variance (<span class="math inline">\(\mu = 0,\, \sigma = 10\)</span>):</p><p><span class="math display">\[\begin{split}
A =\; & \mathcal{N}(0, 1), \\
B =\; & \mathcal{N}(0, 10^2).
\end{split}
\]</span></p><p>Here are the density plots for <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/mann-whitney-misuse/img/density1-light.svg target=_blank alt=density1><img src=/posts/mann-whitney-misuse/img/density1-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/mann-whitney-misuse/img/density1-dark.svg target=_blank alt=density1><img src=/posts/mann-whitney-misuse/img/density1-dark.svg width=800></a></div><p>Although <span class="math inline">\(A \neq B\)</span> (there is a huge difference in variance), the Mann–Whitney U test is not capable of detecting it:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/mann-whitney-misuse/img/mw1-light.svg target=_blank alt=mw1><img src=/posts/mann-whitney-misuse/img/mw1-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/mann-whitney-misuse/img/mw1-dark.svg target=_blank alt=mw1><img src=/posts/mann-whitney-misuse/img/mw1-dark.svg width=800></a></div><h3 id=case-study-2-non-overlapping-distributions>Case study 2: Non-overlapping distributions</h3><p>In the second case study, we compare a uniform distribution on <span class="math inline">\([-1;1]\)</span> and
a mixture of two uniform distributions on <span class="math inline">\([-3;-2]\)</span> and <span class="math inline">\([2;3]\)</span>:</p><p><span class="math display">\[\begin{split}
A =\; & \mathcal{U}(-1, 1), \\
B =\; & 0.5 \cdot \mathcal{U}(-3, -2) + 0.5 \cdot \mathcal{U}(2, 3).
\end{split}
\]</span></p><p>Here are the density plots for <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/mann-whitney-misuse/img/density2-light.svg target=_blank alt=density2><img src=/posts/mann-whitney-misuse/img/density2-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/mann-whitney-misuse/img/density2-dark.svg target=_blank alt=density2><img src=/posts/mann-whitney-misuse/img/density2-dark.svg width=800></a></div><p>Although <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are non-overlapping distributions, the Mann–Whitney U test is not capable of detecting it:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/mann-whitney-misuse/img/mw2-light.svg target=_blank alt=mw2><img src=/posts/mann-whitney-misuse/img/mw2-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/mann-whitney-misuse/img/mw2-dark.svg target=_blank alt=mw2><img src=/posts/mann-whitney-misuse/img/mw2-dark.svg width=800></a></div><h3 id=case-study-3-different-medians>Case study 3: Different medians</h3><p>Sometimes, the Mann–Whitney U test is considered a test that checks the difference and medians.
Let us consider the following two distributions with a noticeable difference in medians:</p><p><span class="math display">\[\begin{split}
A =\; & 0.51 \cdot \mathcal{U}(0, 1) + 0.49 \cdot \mathcal{U}(10, 11), \\
B =\; & 0.49 \cdot \mathcal{U}(2, 3) + 0.51 \cdot \mathcal{U}(8, 9).
\end{split}
\]</span></p><p>It is easy to see that <span class="math inline">\(\operatorname{median}(A) \approx 1\)</span>, <span class="math inline">\(\operatorname{median}(B) \approx 8\)</span>.
Here are the density plots for <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/mann-whitney-misuse/img/density3-light.svg target=_blank alt=density3><img src=/posts/mann-whitney-misuse/img/density3-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/mann-whitney-misuse/img/density3-dark.svg target=_blank alt=density3><img src=/posts/mann-whitney-misuse/img/density3-dark.svg width=800></a></div><p>Although <span class="math inline">\(\operatorname{median}(A) \ll \operatorname{median}(B)\)</span>, the Mann–Whitney U test is not capable of detecting it:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/mann-whitney-misuse/img/mw3-light.svg target=_blank alt=mw3><img src=/posts/mann-whitney-misuse/img/mw3-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/mann-whitney-misuse/img/mw3-dark.svg target=_blank alt=mw3><img src=/posts/mann-whitney-misuse/img/mw3-dark.svg width=800></a></div><h3 id=conclusion>Conclusion</h3><p>The Mann–Whitney U test is a useful nonparametric test when it is used correctly.
If we compare population <span class="math inline">\(A\)</span> and population <span class="math inline">\(B\)</span>, the alternative hypothesis claims that</p><p><span class="math display">\[\mathbb{P}(A < B) + 0.5\cdot \mathbb{P}(A=B) \neq 0.5.
\]</span></p><p>If there are no additional assumptions related to <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, this statement cannot be converted to
&ldquo;the distributions are not identical&rdquo; or &ldquo;the distribution medians are not equal.&rdquo;
If you want to use statistical tests properly, always pay attention to the hypothesis statements and
the <a href=https://aakinshin.net/posts/mann-whitney-min-stat-level/>limitations of the used test</a>.</p><h3 id=references>References</h3><ul><li><b id=Hart2001>[Hart2001]</b><br>Hart, Anna.
&ldquo;Mann-Whitney test is not just a test of medians: differences in spread can be important.&rdquo;
Bmj 323, no. 7309 (2001): 391-393.
DOI:<a href=https://dx.doi.org/10.1136/bmj.323.7309.391>10.1136/bmj.323.7309.391</a></li><li><b id=Conroy2012>[Conroy2012]</b><br>Conroy, Ronán M.
&ldquo;What hypotheses do “nonparametric” two-group tests actually test?.&rdquo;
The Stata Journal 12, no. 2 (2012): 182-190.
DOI:<a href=https://dx.doi.org/10.1177/1536867X1201200202>10.1177/1536867X1201200202</a></li><li><b id=Divine2018>[Divine2018]</b><br>Divine, George W., H. James Norton, Anna E. Barón, and Elizabeth Juarez-Colunga.
&ldquo;The Wilcoxon–Mann–Whitney procedure fails as a test of medians.&rdquo;
The American Statistician 72, no. 3 (2018): 278-286.
DOI:<a href=https://dx.doi.org/10.1080/00031305.2017.1305291>10.1080/00031305.2017.1305291</a></li></ul></div><br><br><div class="flex flex-wrap justify-center items-center">The source code of this post and all the relevant files are&nbsp;<a href=https://github.com/AndreyAkinshin/aakinshin.net/tree/master/content/en/posts/2023/02/mann-whitney-misuse/index.md>available on GitHub</a>.</div><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-misuse%2f&title=Examples%20of%20the%20Mann%e2%80%93Whitney%20U%20test%20misuse%20cases" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Examples%20of%20the%20Mann%e2%80%93Whitney%20U%20test%20misuse%20cases&url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-misuse%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-misuse%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-misuse%2f&title=Examples%20of%20the%20Mann%e2%80%93Whitney%20U%20test%20misuse%20cases" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2023 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>