<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Mann-Whitney U-test"><title>Minimum meaningful statistical level for the Mann–Whitney U test | Andrey Akinshin</title><meta name=description content="The Mann–Whitney U test is one of the most popular nonparametric null hypothesis significance tests. However, like any statistical test, it has limitations. We should always carefully match them with our business requirements. In this post, we discuss how t..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.3746982c0855975eba2f485ef34018c70576ba5fe5ea2f4333daa717341a2831.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><div class="flex items-center justify-end justify-self-start"><div class="flex nav-item h-12 items-center" title='Support this blog'><a class="px-3 text-white" href=https://github.com/sponsors/AndreyAkinshin><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#heart"/></svg></a></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Minimum meaningful statistical level for the Mann–Whitney U test</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2022-04-12>April 12, 2022</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/mann-whitney/>Mann-Whitney U-test</a></div></div><br><div class=main-content><p>The <a href=https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test>Mann–Whitney U test</a> is one of the most popular
nonparametric null hypothesis significance tests.
However, like any statistical test, it has limitations.
We should always carefully match them with our business requirements.
In this post, we discuss how to properly choose the statistical level for the Mann–Whitney U test on small samples.</p><p>Let&rsquo;s say we want to compare two samples <span class="math inline">\(x = \{ x_1, x_2, \ldots, x_n \}\)</span> and <span class="math inline">\(y = \{ y_1, y_2, \ldots, y_m \}\)</span>
using the one-sided Mann–Whitney U test.
Sometimes, we don&rsquo;t have an opportunity to gather enough data and we have to work with small samples.
Imagine that the size of both samples is six: <span class="math inline">\(n=m=6\)</span>.
We want to set the statistical level <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(0.001\)</span> (because we really don&rsquo;t want to get false-positive results).
Is it a valid requirement?
In fact, the minimum p-value we can observe with <span class="math inline">\(n=m=6\)</span> is <span class="math inline">\(\approx 0.001082\)</span>.
Thus, with <span class="math inline">\(\alpha = 0.001\)</span>, it&rsquo;s impossible to get a positive result.
Meanwhile, everything is correct from the technical point of view:
since we can&rsquo;t get any positive results, the false positive rate is exactly zero which is less than <span class="math inline">\(0.001\)</span>.
However, it&rsquo;s definitely not something that we want: with this setup the test becomes useless because
it always provides negative results regardless of the input data.</p><p>This brings an important question: what is the minimum meaningful statistical level
that we can require for the one-sided Mann–Whitney U test knowing the sample sizes?</p><p>The Mann–Whitney U test is a rank-based test.
It means that it takes into account only the relative positions of the sample elements.
The worst case for this test is a situation when all elements from one sample are less (or greater)
then all samples of the other sample.
Here is an example of such a configuration:</p><p><span class="math display">\[x_1 \leq x_2 \leq \ldots \leq x_n < y_1 \leq y_2 \leq \ldots \leq y_m.
\]</span></p><p>Now let&rsquo;s assume that the null hypothesis is true and that both samples were taken from the same distribution.
What is the probability of getting the above configuration by chance?
The answer is the same as the probability of having the first <span class="math inline">\(n\)</span> elements on the first <span class="math inline">\(n\)</span> positions among
<span class="math inline">\(n+m\)</span> elements.
Thus, the minimum p-value that we can observe is</p><p><span class="math display">\[p_{\min} = \frac{1}{C_{n+m}^n} = \frac{n! \cdot m!}{(n+m)!}
\]</span></p><p>Here are some <span class="math inline">\(p_{\min}\)</span> values for <span class="math inline">\(n,m \leq 10\)</span>:</p><table><thead><tr><th align=left></th><th align=right>1</th><th align=right>2</th><th align=right>3</th><th align=right>4</th><th align=right>5</th><th align=right>6</th><th align=right>7</th><th align=right>8</th><th align=right>9</th><th align=right>10</th></tr></thead><tbody><tr><td align=left>1</td><td align=right>0.500000</td><td align=right>0.333333</td><td align=right>0.250000</td><td align=right>0.200000</td><td align=right>0.166667</td><td align=right>0.142857</td><td align=right>0.125000</td><td align=right>0.111111</td><td align=right>0.100000</td><td align=right>0.090909</td></tr><tr><td align=left>2</td><td align=right>0.333333</td><td align=right>0.166667</td><td align=right>0.100000</td><td align=right>0.066667</td><td align=right>0.047619</td><td align=right>0.035714</td><td align=right>0.027778</td><td align=right>0.022222</td><td align=right>0.018182</td><td align=right>0.015152</td></tr><tr><td align=left>3</td><td align=right>0.250000</td><td align=right>0.100000</td><td align=right>0.050000</td><td align=right>0.028571</td><td align=right>0.017857</td><td align=right>0.011905</td><td align=right>0.008333</td><td align=right>0.006061</td><td align=right>0.004545</td><td align=right>0.003497</td></tr><tr><td align=left>4</td><td align=right>0.200000</td><td align=right>0.066667</td><td align=right>0.028571</td><td align=right>0.014286</td><td align=right>0.007937</td><td align=right>0.004762</td><td align=right>0.003030</td><td align=right>0.002020</td><td align=right>0.001399</td><td align=right>0.000999</td></tr><tr><td align=left>5</td><td align=right>0.166667</td><td align=right>0.047619</td><td align=right>0.017857</td><td align=right>0.007937</td><td align=right>0.003968</td><td align=right>0.002165</td><td align=right>0.001263</td><td align=right>0.000777</td><td align=right>0.000500</td><td align=right>0.000333</td></tr><tr><td align=left>6</td><td align=right>0.142857</td><td align=right>0.035714</td><td align=right>0.011905</td><td align=right>0.004762</td><td align=right>0.002165</td><td align=right>0.001082</td><td align=right>0.000583</td><td align=right>0.000333</td><td align=right>0.000200</td><td align=right>0.000125</td></tr><tr><td align=left>7</td><td align=right>0.125000</td><td align=right>0.027778</td><td align=right>0.008333</td><td align=right>0.003030</td><td align=right>0.001263</td><td align=right>0.000583</td><td align=right>0.000291</td><td align=right>0.000155</td><td align=right>0.000087</td><td align=right>0.000051</td></tr><tr><td align=left>8</td><td align=right>0.111111</td><td align=right>0.022222</td><td align=right>0.006061</td><td align=right>0.002020</td><td align=right>0.000777</td><td align=right>0.000333</td><td align=right>0.000155</td><td align=right>0.000078</td><td align=right>0.000041</td><td align=right>0.000023</td></tr><tr><td align=left>9</td><td align=right>0.100000</td><td align=right>0.018182</td><td align=right>0.004545</td><td align=right>0.001399</td><td align=right>0.000500</td><td align=right>0.000200</td><td align=right>0.000087</td><td align=right>0.000041</td><td align=right>0.000021</td><td align=right>0.000011</td></tr><tr><td align=left>10</td><td align=right>0.090909</td><td align=right>0.015152</td><td align=right>0.003497</td><td align=right>0.000999</td><td align=right>0.000333</td><td align=right>0.000125</td><td align=right>0.000051</td><td align=right>0.000023</td><td align=right>0.000011</td><td align=right>0.000005</td></tr></tbody></table><p>From this table, we can find the answer for the example from the beginning of this post.
Fo <span class="math inline">\(n=m=6\)</span>, the lowest p-value we can observe is <span class="math inline">\(1/C_{12}^6 \approx 0.001082\)</span>.
If we set the statistical level <span class="math inline">\(\alpha = 0.001\)</span>, the Mann–Whitney U test will never provide a positive result.</p><p>If we want to make the use of the one-sided Mann–Whitney U test meaningful,
we always should choose <span class="math inline">\(\alpha\)</span> which is bigger than <span class="math inline">\(1/C_{n+m}^n\)</span>.</p></div><br><br><div class="flex flex-wrap justify-center items-center">The source code of this post and all the relevant files are&nbsp;<a href=https://github.com/AndreyAkinshin/aakinshin.net/tree/master/content/en/posts/2022/04/mann-whitney-min-stat-level/index.md>available on GitHub</a>.</div><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f&title=Minimum%20meaningful%20statistical%20level%20for%20the%20Mann%e2%80%93Whitney%20U%20test" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Minimum%20meaningful%20statistical%20level%20for%20the%20Mann%e2%80%93Whitney%20U%20test&url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f&title=Minimum%20meaningful%20statistical%20level%20for%20the%20Mann%e2%80%93Whitney%20U%20test" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2023 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li><li><a href=https://github.com/sponsors/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>Support this blog</title><use xlink:href="/img/fa/all.svg#heart"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>