<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research"><title>Minimum meaningful statistical level for the Mann–Whitney U test | Andrey Akinshin</title><meta name=description content="The Mann–Whitney U test is one of the most popular nonparametric null hypothesis significance tests. However, like any statistical test, it has limitations..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=https://aakinshin.net/sass/bootstrap-light.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=https://aakinshin.net/sass/bootstrap-dark.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.d7f6578e23ad3f0c33c589f9bcb34f995b45121f1f3ce888869c86b26826c845.js></script>
<script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.9e68d431432744c07a43381a8a833ffe0921cc0e006d84ad97f0b0d43c5cd82d.mjs></script>
<link href=https://aakinshin.net/css/fontawesome-all.min.178e95bba6ea2e9a90838cd646658f4bf6667a6ceaa057cb587bf7e6eb8412d3.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.60773ab7266ecc6e9625306f57c0a82a219b011dc3ea2d83763d1ecdf11c86d2.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.7e186db80d8c431d196b3e0718afb0636b82a269a8c92521c11a55267a24fc27.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVB6MXSX32"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZVB6MXSX32")</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-41419012-5"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-41419012-5")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(28700916,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/28700916 style=position:absolute;left:-9999px alt></div></noscript><script src=/js/jquery-3.3.1.slim.min.js></script></head><body><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Blog</a><ul class="dropdown-menu bg-primary"><li><a class=dropdown-item href=https://aakinshin.net/posts/>All Posts</a></li><li><a class=dropdown-item href=https://aakinshin.net/tags/statistics/>Posts about Statistics</a></li><li></li><a class=dropdown-item href=https://aakinshin.net/tags/>All Tags</a></li></ul></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Minimum meaningful statistical level for the Mann–Whitney U test</h1><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2022-04-12>April 12, 2022</time>
&nbsp;&nbsp;
<i class="fas fa-tag"></i>
&nbsp;
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/research/ class="badge badge-info">Research</a></span><br><br><p>The <a href=https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test>Mann–Whitney U test</a> is one of the most popular
nonparametric null hypothesis significance tests.
However, like any statistical test, it has limitations.
We should always carefully match them with our business requirements.
In this post, we discuss how to properly choose the statistical level for the Mann–Whitney U test on small samples.</p><p>Let&rsquo;s say we want to compare two samples <span class="math inline">\(x = \{ x_1, x_2, \ldots, x_n \}\)</span> and <span class="math inline">\(y = \{ y_1, y_2, \ldots, y_m \}\)</span>
using the one-sided Mann–Whitney U test.
Sometimes, we don&rsquo;t have an opportunity to gather enough data and we have to work with small samples.
Imagine that the size of both samples is six: <span class="math inline">\(n=m=6\)</span>.
We want to set the statistical level <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(0.001\)</span> (because we really don&rsquo;t want to get false-positive results).
Is it a valid requirement?
In fact, the minimum p-value we can observe with <span class="math inline">\(n=m=6\)</span> is <span class="math inline">\(\approx 0.001082\)</span>.
Thus, with <span class="math inline">\(\alpha = 0.001\)</span>, it&rsquo;s impossible to get a positive result.
Meanwhile, everything is correct from the technical point of view:
since we can&rsquo;t get any positive results, the false positive rate is exactly zero which is less than <span class="math inline">\(0.001\)</span>.
However, it&rsquo;s definitely not something that we want: with this setup the test becomes useless because
it always provides negative results regardless of the input data.</p><p>This brings an important question: what is the minimum meaningful statistical level
that we can require for the one-sided Mann–Whitney U test knowing the sample sizes?</p><p>The Mann–Whitney U test is a rank-based test.
It means that it takes into account only the relative positions of the sample elements.
The worst case for this test is a situation when all elements from one sample are less (or greater)
then all samples of the other sample.
Here is an example of such a configuration:</p><p><span class="math display">\[x_1 \leq x_2 \leq \ldots \leq x_n < y_1 \leq y_2 \leq \ldots \leq y_m.
\]</span></p><p>Now let&rsquo;s assume that the null hypothesis is true and that both samples were taken from the same distribution.
What is the probability of getting the above configuration by chance?
The answer is the same as the probability of having the first <span class="math inline">\(n\)</span> elements on the first <span class="math inline">\(n\)</span> positions among
<span class="math inline">\(n+m\)</span> elements.
Thus, the minimum p-value that we can observe is</p><p><span class="math display">\[p_{\min} = \frac{1}{C_{n+m}^n} = \frac{n! \cdot m!}{(n+m)!}
\]</span></p><p>Here are some <span class="math inline">\(p_{\min}\)</span> values for <span class="math inline">\(n,m \leq 10\)</span>:</p><table><thead><tr><th align=left></th><th align=right>1</th><th align=right>2</th><th align=right>3</th><th align=right>4</th><th align=right>5</th><th align=right>6</th><th align=right>7</th><th align=right>8</th><th align=right>9</th><th align=right>10</th></tr></thead><tbody><tr><td align=left>1</td><td align=right>0.500000</td><td align=right>0.333333</td><td align=right>0.250000</td><td align=right>0.200000</td><td align=right>0.166667</td><td align=right>0.142857</td><td align=right>0.125000</td><td align=right>0.111111</td><td align=right>0.100000</td><td align=right>0.090909</td></tr><tr><td align=left>2</td><td align=right>0.333333</td><td align=right>0.166667</td><td align=right>0.100000</td><td align=right>0.066667</td><td align=right>0.047619</td><td align=right>0.035714</td><td align=right>0.027778</td><td align=right>0.022222</td><td align=right>0.018182</td><td align=right>0.015152</td></tr><tr><td align=left>3</td><td align=right>0.250000</td><td align=right>0.100000</td><td align=right>0.050000</td><td align=right>0.028571</td><td align=right>0.017857</td><td align=right>0.011905</td><td align=right>0.008333</td><td align=right>0.006061</td><td align=right>0.004545</td><td align=right>0.003497</td></tr><tr><td align=left>4</td><td align=right>0.200000</td><td align=right>0.066667</td><td align=right>0.028571</td><td align=right>0.014286</td><td align=right>0.007937</td><td align=right>0.004762</td><td align=right>0.003030</td><td align=right>0.002020</td><td align=right>0.001399</td><td align=right>0.000999</td></tr><tr><td align=left>5</td><td align=right>0.166667</td><td align=right>0.047619</td><td align=right>0.017857</td><td align=right>0.007937</td><td align=right>0.003968</td><td align=right>0.002165</td><td align=right>0.001263</td><td align=right>0.000777</td><td align=right>0.000500</td><td align=right>0.000333</td></tr><tr><td align=left>6</td><td align=right>0.142857</td><td align=right>0.035714</td><td align=right>0.011905</td><td align=right>0.004762</td><td align=right>0.002165</td><td align=right>0.001082</td><td align=right>0.000583</td><td align=right>0.000333</td><td align=right>0.000200</td><td align=right>0.000125</td></tr><tr><td align=left>7</td><td align=right>0.125000</td><td align=right>0.027778</td><td align=right>0.008333</td><td align=right>0.003030</td><td align=right>0.001263</td><td align=right>0.000583</td><td align=right>0.000291</td><td align=right>0.000155</td><td align=right>0.000087</td><td align=right>0.000051</td></tr><tr><td align=left>8</td><td align=right>0.111111</td><td align=right>0.022222</td><td align=right>0.006061</td><td align=right>0.002020</td><td align=right>0.000777</td><td align=right>0.000333</td><td align=right>0.000155</td><td align=right>0.000078</td><td align=right>0.000041</td><td align=right>0.000023</td></tr><tr><td align=left>9</td><td align=right>0.100000</td><td align=right>0.018182</td><td align=right>0.004545</td><td align=right>0.001399</td><td align=right>0.000500</td><td align=right>0.000200</td><td align=right>0.000087</td><td align=right>0.000041</td><td align=right>0.000021</td><td align=right>0.000011</td></tr><tr><td align=left>10</td><td align=right>0.090909</td><td align=right>0.015152</td><td align=right>0.003497</td><td align=right>0.000999</td><td align=right>0.000333</td><td align=right>0.000125</td><td align=right>0.000051</td><td align=right>0.000023</td><td align=right>0.000011</td><td align=right>0.000005</td></tr></tbody></table><p>From this table, we can find the answer for the example from the beginning of this post.
Fo <span class="math inline">\(n=m=6\)</span>, the lowest p-value we can observe is <span class="math inline">\(1/C_{12}^6 \approx 0.001082\)</span>.
If we set the statistical level <span class="math inline">\(\alpha = 0.001\)</span>, the Mann–Whitney U test will never provide a positive result.</p><p>If we want to make the use of the one-sided Mann–Whitney U test meaningful,
we always should choose <span class="math inline">\(\alpha\)</span> which is bigger than <span class="math inline">\(1/C_{n+m}^n\)</span>.</p><br><br><div class=row><div class="justify-content-center share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f&title=Minimum%20meaningful%20statistical%20level%20for%20the%20Mann%e2%80%93Whitney%20U%20test" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Minimum%20meaningful%20statistical%20level%20for%20the%20Mann%e2%80%93Whitney%20U%20test&url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x"></i></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fmann-whitney-min-stat-level%2f&title=Minimum%20meaningful%20statistical%20level%20for%20the%20Mann%e2%80%93Whitney%20U%20test" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div></div></div><hr></div></div></main></div><footer class=blog-footer><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub></i></a>
<a href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter></i></a>
<a href=https://aakinshin.net/posts/index.xml><i class="fas fa-rss" title=RSS></i></a>
|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.c26550621ac13c2221d7f6f5e6fe862345d3919723c50d730893e3e4856ecf35.js></script>
<script src=/js/bootstrap.bundle.min.js></script>
<script src=/js/anchor.min.js></script>
<script src=https://aakinshin.net/js/custom.min.f6e5d13fe39f305056cc743ee4cb8d117c1aba26176e58c82c79a480d02fe4b7.js></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>