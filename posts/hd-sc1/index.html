<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research"><title>Sensitivity curve of the Harrell-Davis quantile estimator, Part 1 | Andrey Akinshin</title><meta name=description content="The Harrell-Davis quantile estimator is an efficient replacement for the traditional quantile estimator, especially in the case of light-tailed distributio..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=https://aakinshin.net/sass/bootstrap-light.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=https://aakinshin.net/sass/bootstrap-dark.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.d7f6578e23ad3f0c33c589f9bcb34f995b45121f1f3ce888869c86b26826c845.js></script>
<script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.9e68d431432744c07a43381a8a833ffe0921cc0e006d84ad97f0b0d43c5cd82d.mjs></script>
<link href=https://aakinshin.net/css/main.min.d3894e60e337fa8d9f2c81dcda5dcb9144502462aaabed3c6bad2fcf178a8410.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body class="d-flex flex-column min-vh-100"><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><svg class="fai"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></li><li class=nav-item><a class=nav-link id=nav-link-posts href=https://aakinshin.net/posts/>Posts</a></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Sensitivity curve of the Harrell-Davis quantile estimator, Part 1</h1><span class=blog-post-meta><svg class="fai"><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2022-09-27>September 27, 2022</time>
&nbsp;&nbsp;<svg class="fai"><use xlink:href="/img/fa/all.svg#tag"/></svg>
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/research/ class="badge badge-info">Research</a></span><br><br><p>The Harrell-Davis quantile estimator is an efficient replacement for the traditional quantile estimator,
especially in the case of light-tailed distributions.
Unfortunately, it is not robust: its breakdown point is zero.
However, the breakdown point is not the only descriptor of robustness.
While the breakdown point describes the portion of the distribution that should be replaced by
arbitrary large values to corrupt the estimation,
it does not describe the actual impact of finite outliers.
The arithmetic mean also has the breakdown point of zero,
but the practical robustness of the mean and the Harrell-Davis quantile estimator are not the same.
The Harrell-Davis quantile estimator is an L-estimator
that assigns extremely low weights to sample elements near the tails
(especially, for reasonably large sample sizes).
Therefore, the actual impact of potential outliers is not so noticeable.
In this post, we use the standardized sensitivity curve to evaluate this impact.</p><p>The classic Harrell-Davis quantile estimator (see <a href=#Harrell1982>[Harrell1982]</a>) is defined as follows:</p><p><span class="math display">\[Q_{\operatorname{HD}}(p) = \sum_{i=1}^{n} W_{\operatorname{HD},i} \cdot x_{(i)},\quad
W_{\operatorname{HD},i} = I_{i/n}(\alpha, \beta) - I_{(i-1)/n}(\alpha, \beta),
\]</span></p><p>where <span class="math inline">\(I_t(\alpha, \beta)\)</span> is the regularized incomplete beta function,
<span class="math inline">\(\alpha = (n+1)p\)</span>, <span class="math inline">\(\;\beta = (n+1)(1-p)\)</span>.
In this post we consider the Harrell-Davis median estimator <span class="math inline">\(Q_{\operatorname{HD}}(0.5)\)</span>.</p><p>The standardized sensitivity curve (SC) of an estimator <span class="math inline">\(\hat{\theta}\)</span> is given by</p><p><span class="math display">\[\operatorname{SC}_n(x_0) = \frac{
\hat{\theta}_{n+1}(x_1, x_2, \ldots, x_n, x_0) - \hat{\theta}_n(x_1, x_2, \ldots, x_n)
}{1 / (n + 1)}
\]</span></p><p>Thus, the SC shows the standardized change of the estimator value for situation,
when we add a new element <span class="math inline">\(x_0\)</span> to an existing sample <span class="math inline">\(\mathbf{x} = \{ x_1, x_2, \ldots, x_n \}\)</span>.
In the context of this post, we perform simulations using the standard normal distribution
given by its quantile function <span class="math inline">\(\Phi^{-1}\)</span>.
Following the approach from <a href=#Maronna2019>[Maronna2019, Section 3.1]</a>,
we define the sample <span class="math inline">\(\mathbf{x}\)</span> as</p><p><span class="math display">\[\mathbf{x} = \Bigg\{
\Phi^{-1}\Big(\frac{1}{n+1}\Big),
\Phi^{-1}\Big(\frac{2}{n+1}\Big),
\ldots,
\Phi^{-1}\Big(\frac{n}{n+1}\Big)
\Bigg\}
\]</span></p><p>Now let&rsquo;s explore the SC values for different sample sizes for <span class="math inline">\(x_0 \in [-100; 100]\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/hd-sc1/img/sc1-light.png target=_blank class=imgldlink alt=sc1><picture><source theme=dark srcset=/posts/hd-sc1/img/sc1-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/hd-sc1/img/sc1-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/hd-sc1/img/sc1-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/hd-sc1/img/sc2-light.png target=_blank class=imgldlink alt=sc2><picture><source theme=dark srcset=/posts/hd-sc1/img/sc2-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/hd-sc1/img/sc2-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/hd-sc1/img/sc2-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/hd-sc1/img/sc3-light.png target=_blank class=imgldlink alt=sc3><picture><source theme=dark srcset=/posts/hd-sc1/img/sc3-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/hd-sc1/img/sc3-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/hd-sc1/img/sc3-light.png></picture></a></div></div><br><p>As we can see, for <span class="math inline">\(n \geq 15\)</span> the actual impact of <span class="math inline">\(x_0\)</span> is negligible,
which makes the Harrell-Davis median estimator a practically reasonable choice.</p><h3 id=references>References</h3><ul><li><b id=Harrell1982>[Harrell1982]</b><br>Harrell, F.E. and Davis, C.E., 1982. A new distribution-free quantile estimator.
<em>Biometrika</em>, 69(3), pp.635-640.<br><a href=https://doi.org/10.2307/2335999>https://doi.org/10.2307/2335999</a></li><li><b id=Maronna2019>[Maronna2019]</b><br>Maronna, Ricardo A., R. Douglas Martin, Victor J. Yohai, and Matías Salibián-Barrera.
Robust statistics: theory and methods (with R). John Wiley & Sons, 2019.</li></ul><br><br><div class=row><div class="justify-content-center share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fhd-sc1%2f&title=Sensitivity%20curve%20of%20the%20Harrell-Davis%20quantile%20estimator%2c%20Part%201" target=_blank title="Share on Reddit"><svg class="fai"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Sensitivity%20curve%20of%20the%20Harrell-Davis%20quantile%20estimator%2c%20Part%201&url=https%3a%2f%2faakinshin.net%2fposts%2fhd-sc1%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fhd-sc1%2f" target=_blank title="Share on HackerNews"><svg class="fai"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fhd-sc1%2f&title=Sensitivity%20curve%20of%20the%20Harrell-Davis%20quantile%20estimator%2c%20Part%201" target=_blank title="Add to Pocket"><svg class="fai"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><hr></div></div></main></div><footer class="blog-footer mt-auto"><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><svg class="fai"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a><a href=https://twitter.com/andrey_akinshin><svg class="fai"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a><a href=https://aakinshin.net/posts/index.xml><svg class="fai"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a>|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://aakinshin.net/js/theme-after.min.29520a8e1176193da7ea4e6cb56cf9b3e634b867c9979234d8dafb5ab61dd494.js></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>