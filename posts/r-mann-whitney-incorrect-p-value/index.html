<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.3"><meta name=author content='Andrey Akinshin'><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content='Mathematics,Statistics,Research,Mann-Whitney U-test,R'><title>When R's Mann-Whitney U test returns extremely distorted p-values | Andrey Akinshin</title>
<meta name=description content="Discussing corner cases in which wilcox.test returns distorted p-values"><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.507552e362c73186c7b6d8d093247a479099e01f527bcc3432990c78c2e426d8.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-2 xs:px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>When R's Mann-Whitney U Test Returns Extremely Distorted P-Values</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2023-04-25>April 25, 2023</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/mann-whitney/>Mann-Whitney U-Test</a>
<a class=label-link href=https://aakinshin.net/tags/r/>R</a></div></div><br><div class=main-content><p>The <a href=https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test>Mann–Whitney U test</a>
(also known as the Wilcoxon rank-sum test)
is one of the most popular nonparametric statistical tests.
In R, it can be accessed using
the <a href=https://stat.ethz.ch/R-manual/R-devel/library/stats/html/wilcox.test.html>wilcox.test</a> function,
which has been <a href=https://github.com/wch/r-source/blob/tags/R-1-0/src/library/ctest/R/wilcox.test.R>available</a>
since R 1.0.0 (February 2000).
With its extensive adoption and long-standing presence in R,
the <code>wilcox.test</code> function has become a trusted tool for many researchers.
But is it truly reliable, and to what extent can we rely on its accuracy by default?</p><p>In my work,
I often encounter the task of comparing a large sample (e.g., of size 50+) with a small sample (e.g., of size 5).
In some cases, the ranges of these samples do not overlap with each other,
which is the extreme case of the Mann–Whitney U test: it gives the minimum possible p-value.
In <a href=https://aakinshin.net/posts/mann-whitney-min-stat-level/>one of the previous posts</a>,
I presented the exact equation for such a p-value.
If we compare two samples of sizes $n$ and $m$,
the minimum p-value we can observe with the one-tailed Mann–Whitney U test is $1/C_{n+m}^n$.
For example, if $n=50$ and $m=5$, we get $1/C_{55}^5 \approx 0.0000002874587$.
Let&rsquo;s check these calculations using R:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>wilcox.test</span><span class=p>(</span><span class=m>101</span><span class=o>:</span><span class=m>105</span><span class=p>,</span> <span class=m>1</span><span class=o>:</span><span class=m>50</span><span class=p>,</span> <span class=n>alternative</span> <span class=o>=</span> <span class=s>&#34;greater&#34;</span><span class=p>)</span><span class=o>$</span><span class=n>p.value</span>
</span></span><span class=line><span class=cl><span class=n>[1]</span> <span class=m>0.0001337028</span>
</span></span></code></pre></div><p>The obtained p-value is $\approx 0.0001337028$, which is $\approx 465$ times larger than we expected!
Have we discovered a critical bug in <code>wilcox.test</code>?
Can we now trust this function?
Let&rsquo;s find out!</p><p>In fact, the <code>wilcox.test</code> has two implementations of the Mann–Whitney U test: the exact one and the approximated one.
The choice of a particular strategy is controlled by the <code>exact</code> parameter of this function.
Here is an example from the official documentation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>0.80</span><span class=p>,</span> <span class=m>0.83</span><span class=p>,</span> <span class=m>1.89</span><span class=p>,</span> <span class=m>1.04</span><span class=p>,</span> <span class=m>1.45</span><span class=p>,</span> <span class=m>1.38</span><span class=p>,</span> <span class=m>1.91</span><span class=p>,</span> <span class=m>1.64</span><span class=p>,</span> <span class=m>0.73</span><span class=p>,</span> <span class=m>1.46</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>y</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1.15</span><span class=p>,</span> <span class=m>0.88</span><span class=p>,</span> <span class=m>0.90</span><span class=p>,</span> <span class=m>0.74</span><span class=p>,</span> <span class=m>1.21</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>wilcox.test</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>alternative</span> <span class=o>=</span> <span class=s>&#34;greater&#34;</span><span class=p>,</span> <span class=n>exact</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span><span class=o>$</span><span class=n>p.value</span>
</span></span><span class=line><span class=cl><span class=n>[1]</span> <span class=m>0.1272061</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>wilcox.test</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>alternative</span> <span class=o>=</span> <span class=s>&#34;greater&#34;</span><span class=p>,</span> <span class=n>exact</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span><span class=o>$</span><span class=n>p.value</span>
</span></span><span class=line><span class=cl><span class=n>[1]</span> <span class=m>0.1223118</span>
</span></span></code></pre></div><p>In this example, the approximation looks accurate, with a difference ofhis makes it an impra only about $5\%$.
When the <code>exact</code> parameter is not specified, it is determined
<a href=https://github.com/wch/r-source/blob/tags/R-4-3-0/src/library/stats/R/wilcox.test.R#L279>as follows</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=kr>if</span><span class=p>(</span><span class=nf>is.null</span><span class=p>(</span><span class=n>exact</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>exact</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=n>n.x</span> <span class=o>&lt;</span> <span class=m>50</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>n.y</span> <span class=o>&lt;</span> <span class=m>50</span><span class=p>)</span>
</span></span></code></pre></div><p>Before we start exploring different extreme cases,
let us briefly review both methods to estimate the p-value within this test.</p><p>The first step of the Mann–Whitney U test is calculating the U statistic:</p><p>$$
U(x, y) = \sum_{i=1}^n \sum_{j=1}^m S(x_i, y_j),\quad</p><p>S(a,b) = \begin{cases}
1, & \text{if } a > b, \
0.5, & \text{if } a = b, \
0, & \text{if } a &lt; b.
\end{cases}
$$</p><p>It is a simple rank-based statistic, which varies from $0$ to $nm$.
Once we get the value of $U$,
we should match it with the distribution of $U$ statistics under the valid null hypothesis.
The distribution can be obtained in two different ways:</p><ul><li><strong>The exact implementation</strong><br>The <a href=https://github.com/wch/r-source/blob/tags/R-4-3-0/src/nmath/wilcox.c#L111>straightforward implementation</a> uses
<a href=https://en.wikipedia.org/wiki/Dynamic_programming>dynamic programming</a>
to obtain the exact probability of obtaining the given $U$ statistic for the given $n$ and $m$.
The only drawback of this solution is its computational complexity
(which is $\mathcal{O}(n^2 m^2)$ for both time and memory).
This makes this approach an impractical solution for large samples.</li><li><strong>The approximated implementation</strong><br>Fortunately, we have a method of large sample approximation
(see <a href=/posts/r-mann-whitney-incorrect-p-value/#Hollander1973>[Hollander1973]</a>, pages 68–75).
Long story short, we approximate the distribution of $U$ statistics with the following normal distribution
(in the case of tied values, a small correction is needed):</li></ul>$$
\mathcal{N}\left( \frac{nm}{2},\, \frac{nm(n+m+1)}{12} \right)
$$<p>For the middle values of $U$ (around $nm/2$), this approximation provides reasonably accurate results.
However, it performs extremely poorly at the tails.
To illustrate the problems, we perform a simple numerical study:</p><ul><li>Enumerate $n$ from $1$ to $50$, set $m$ to $50$
(since $50$ is a critical value, after which <code>wilcox.text</code> switches to the approximated algorithm);</li><li>For each pair of $n,\, m$, we consider two non-overlapped samples
$x = \{ 101, 102, \ldots, 100 + n \}$ and $y = \{ 1, 2, \ldots, m \}$;</li><li>For each pair of samples $x$ and $y$, we estimate the exact and approximated p-values using <code>wilcox.test</code>
(R <a href=https://cran.r-project.org/bin/windows/base/NEWS.R-4.3.0.html>4.3.0</a>).
We also evaluate the ratio between two obtained p-values.</li></ul><p>This simulation can be performed using the following simple script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=nf>options</span><span class=p>(</span><span class=n>scipen</span> <span class=o>=</span> <span class=m>999</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>n</span> <span class=o>=</span> <span class=m>1</span><span class=o>:</span><span class=m>50</span><span class=p>,</span> <span class=n>m</span> <span class=o>=</span> <span class=m>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>$</span><span class=n>approx</span> <span class=o>&lt;-</span> <span class=nf>sapply</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=nf>nrow</span><span class=p>(</span><span class=n>df</span><span class=p>),</span> <span class=kr>function</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=nf>wilcox.test</span><span class=p>(</span><span class=m>101</span><span class=o>:</span><span class=p>(</span><span class=m>100</span><span class=o>+</span><span class=n>df</span><span class=o>$</span><span class=n>n[i]</span><span class=p>),</span> <span class=m>1</span><span class=o>:</span><span class=n>df</span><span class=o>$</span><span class=n>m[i]</span><span class=p>,</span> <span class=s>&#34;g&#34;</span><span class=p>,</span> <span class=n>exact</span> <span class=o>=</span> <span class=bp>F</span><span class=p>)</span><span class=o>$</span><span class=n>p.value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>$</span><span class=n>exact</span> <span class=o>&lt;-</span>  <span class=nf>sapply</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=nf>nrow</span><span class=p>(</span><span class=n>df</span><span class=p>),</span> <span class=kr>function</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=nf>wilcox.test</span><span class=p>(</span><span class=m>101</span><span class=o>:</span><span class=p>(</span><span class=m>100</span><span class=o>+</span><span class=n>df</span><span class=o>$</span><span class=n>n[i]</span><span class=p>),</span> <span class=m>1</span><span class=o>:</span><span class=n>df</span><span class=o>$</span><span class=n>m[i]</span><span class=p>,</span> <span class=s>&#34;g&#34;</span><span class=p>,</span> <span class=n>exact</span> <span class=o>=</span> <span class=bp>T</span><span class=p>)</span><span class=o>$</span><span class=n>p.value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>$</span><span class=n>ratio</span> <span class=o>&lt;-</span> <span class=n>df</span><span class=o>$</span><span class=n>approx</span> <span class=o>/</span> <span class=n>df</span><span class=o>$</span><span class=n>exact</span>
</span></span><span class=line><span class=cl><span class=n>df</span>
</span></span></code></pre></div><p>Here are the results:</p><table><thead><tr><th align=right>n</th><th align=right>m</th><th align=right>approx</th><th align=right>exact</th><th align=right>ratio</th></tr></thead><tbody><tr><td align=right>1</td><td align=right>50</td><td align=right>0.048011543131958198116216</td><td align=right>0.019607843137254901688670827297755750</td><td align=right>2.448589</td></tr><tr><td align=right>2</td><td align=right>50</td><td align=right>0.009252304327263300917639</td><td align=right>0.000754147812971342414341269222433084</td><td align=right>12.268556</td></tr><tr><td align=right>3</td><td align=right>50</td><td align=right>0.002068602594726797437585</td><td align=right>0.000042687612054981640980627632941946</td><td align=right>48.459084</td></tr><tr><td align=right>4</td><td align=right>50</td><td align=right>0.000507425712710512176983</td><td align=right>0.000003162045337406047683961830482846</td><td align=right>160.473889</td></tr><tr><td align=right>5</td><td align=right>50</td><td align=right>0.000133702777437926781292</td><td align=right>0.000000287458667036913421002024661768</td><td align=right>465.120008</td></tr><tr><td align=right>6</td><td align=right>50</td><td align=right>0.000037419721898732403792</td><td align=right>0.000000030799142896812156031614014003</td><td align=right>1214.959846</td></tr><tr><td align=right>7</td><td align=right>50</td><td align=right>0.000011044391063200054742</td><td align=right>0.000000003782350882064650319878251473</td><td align=right>2919.980564</td></tr><tr><td align=right>8</td><td align=right>50</td><td align=right>0.000003420097224807733340</td><td align=right>0.000000000521703569939951803913405917</td><td align=right>6555.633164</td></tr><tr><td align=right>9</td><td align=right>50</td><td align=right>0.000001106806028706227259</td><td align=right>0.000000000079581900499314674285699250</td><td align=right>13907.760706</td></tr><tr><td align=right>10</td><td align=right>50</td><td align=right>0.000000373114142492364927</td><td align=right>0.000000000013263650083219112919478920</td><td align=right>28130.577944</td></tr><tr><td align=right>11</td><td align=right>50</td><td align=right>0.000000130667516485322913</td><td align=right>0.000000000002391805752711643505365161</td><td align=right>54631.324612</td></tr><tr><td align=right>12</td><td align=right>50</td><td align=right>0.000000047426982847987003</td><td align=right>0.000000000000462930145686124477766408</td><td align=right>102449.545120</td></tr><tr><td align=right>13</td><td align=right>50</td><td align=right>0.000000017803734950873793</td><td align=right>0.000000000000095525268157454267935196</td><td align=right>186377.230803</td></tr><tr><td align=right>14</td><td align=right>50</td><td align=right>0.000000006899453656698780</td><td align=right>0.000000000000020896152409443119138672</td><td align=right>330178.184075</td></tr><tr><td align=right>15</td><td align=right>50</td><td align=right>0.000000002755517795088092</td><td align=right>0.000000000000004822189017563796906354</td><td align=right>571424.675609</td></tr><tr><td align=right>16</td><td align=right>50</td><td align=right>0.000000001132420441204299</td><td align=right>0.000000000000001169015519409405310631</td><td align=right>968695.814899</td></tr><tr><td align=right>17</td><td align=right>50</td><td align=right>0.000000000478204516517026</td><td align=right>0.000000000000000296615878059102926844</td><td align=right>1612201.341500</td></tr><tr><td align=right>18</td><td align=right>50</td><td align=right>0.000000000207230566590806</td><td align=right>0.000000000000000078515967721527219964</td><td align=right>2639342.959203</td></tr><tr><td align=right>19</td><td align=right>50</td><td align=right>0.000000000092045404447794</td><td align=right>0.000000000000000021620338937811845233</td><td align=right>4257352.519429</td></tr><tr><td align=right>20</td><td align=right>50</td><td align=right>0.000000000041857100940344</td><td align=right>0.000000000000000006177239696517670397</td><td align=right>6776020.196196</td></tr><tr><td align=right>21</td><td align=right>50</td><td align=right>0.000000000019466963240158</td><td align=right>0.000000000000000001827070896153113595</td><td align=right>10654738.839717</td></tr><tr><td align=right>22</td><td align=right>50</td><td align=right>0.000000000009250432374139</td><td align=right>0.000000000000000000558271662713451387</td><td align=right>16569768.791735</td></tr><tr><td align=right>23</td><td align=right>50</td><td align=right>0.000000000004487040794828</td><td align=right>0.000000000000000000175893811539854518</td><td align=right>25509941.228442</td></tr><tr><td align=right>24</td><td align=right>50</td><td align=right>0.000000000002219810231291</td><td align=right>0.000000000000000000057046641580493394</td><td align=right>38912198.330882</td></tr><tr><td align=right>25</td><td align=right>50</td><td align=right>0.000000000001119116799357</td><td align=right>0.000000000000000000019015547193497798</td><td align=right>58852726.559442</td></tr><tr><td align=right>26</td><td align=right>50</td><td align=right>0.000000000000574519790304</td><td align=right>0.000000000000000000006505318776722924</td><td align=right>88315393.914190</td></tr><tr><td align=right>27</td><td align=right>50</td><td align=right>0.000000000000300116336043</td><td align=right>0.000000000000000000002281085804824923</td><td align=right>131567315.621484</td></tr><tr><td align=right>28</td><td align=right>50</td><td align=right>0.000000000000159415937793</td><td align=right>0.000000000000000000000818851314552536</td><td align=right>194682398.330711</td></tr><tr><td align=right>29</td><td align=right>50</td><td align=right>0.000000000000086049778707</td><td align=right>0.000000000000000000000300590988886374</td><td align=right>286268657.038994</td></tr><tr><td align=right>30</td><td align=right>50</td><td align=right>0.000000000000047171214487</td><td align=right>0.000000000000000000000112721620832390</td><td align=right>418475303.483840</td></tr><tr><td align=right>31</td><td align=right>50</td><td align=right>0.000000000000026245863540</td><td align=right>0.000000000000000000000043140373404989</td><td align=right>608382855.044904</td></tr><tr><td align=right>32</td><td align=right>50</td><td align=right>0.000000000000014813624414</td><td align=right>0.000000000000000000000016835267670240</td><td align=right>879916179.758513</td></tr><tr><td align=right>33</td><td align=right>50</td><td align=right>0.000000000000008477165239</td><td align=right>0.000000000000000000000006693540158047</td><td align=right>1266469616.742985</td></tr><tr><td align=right>34</td><td align=right>50</td><td align=right>0.000000000000004916004777</td><td align=right>0.000000000000000000000002709290063971</td><td align=right>1814499245.458048</td></tr><tr><td align=right>35</td><td align=right>50</td><td align=right>0.000000000000002887621675</td><td align=right>0.000000000000000000000001115590026341</td><td align=right>2588425503.078257</td></tr><tr><td align=right>36</td><td align=right>50</td><td align=right>0.000000000000001717269860</td><td align=right>0.000000000000000000000000466991173817</td><td align=right>3677306886.886681</td></tr><tr><td align=right>37</td><td align=right>50</td><td align=right>0.000000000000001033523240</td><td align=right>0.000000000000000000000000198605441738</td><td align=right>5203901920.395980</td></tr><tr><td align=right>38</td><td align=right>50</td><td align=right>0.000000000000000629226919</td><td align=right>0.000000000000000000000000085761440751</td><td align=right>7336944364.786281</td></tr><tr><td align=right>39</td><td align=right>50</td><td align=right>0.000000000000000387373398</td><td align=right>0.000000000000000000000000037580856059</td><td align=right>10307732138.774328</td></tr><tr><td align=right>40</td><td align=right>50</td><td align=right>0.000000000000000241060228</td><td align=right>0.000000000000000000000000016702602693</td><td align=right>14432494906.850683</td></tr><tr><td align=right>41</td><td align=right>50</td><td align=right>0.000000000000000151579231</td><td align=right>0.000000000000000000000000007525348466</td><td align=right>20142486658.620667</td></tr><tr><td align=right>42</td><td align=right>50</td><td align=right>0.000000000000000096277356</td><td align=right>0.000000000000000000000000003435485169</td><td align=right>28024384121.614346</td></tr><tr><td align=right>43</td><td align=right>50</td><td align=right>0.000000000000000061750057</td><td align=right>0.000000000000000000000000001588450132</td><td align=right>38874406735.166344</td></tr><tr><td align=right>44</td><td align=right>50</td><td align=right>0.000000000000000039980098</td><td align=right>0.000000000000000000000000000743529849</td><td align=right>53770670472.618752</td></tr><tr><td align=right>45</td><td align=right>50</td><td align=right>0.000000000000000026122455</td><td align=right>0.000000000000000000000000000352198350</td><td align=right>74169725522.991974</td></tr><tr><td align=right>46</td><td align=right>50</td><td align=right>0.000000000000000017219619</td><td align=right>0.000000000000000000000000000168761709</td><td align=right>102035109626.813110</td></tr><tr><td align=right>47</td><td align=right>50</td><td align=right>0.000000000000000011448630</td><td align=right>0.000000000000000000000000000081771137</td><td align=right>140008207685.065460</td></tr><tr><td align=right>48</td><td align=right>50</td><td align=right>0.000000000000000007675202</td><td align=right>0.000000000000000000000000000040051169</td><td align=right>191634915718.995544</td></tr><tr><td align=right>49</td><td align=right>50</td><td align=right>0.000000000000000005187081</td><td align=right>0.000000000000000000000000000019823306</td><td align=right>261665784427.152771</td></tr><tr><td align=right>50</td><td align=right>50</td><td align=right>0.000000000000000003533036</td><td align=right>0.000000000000000000000000000009911653</td><td align=right>356452748856.307617</td></tr></tbody></table><p>Thus, for $n=m=50$, the ratio between the exact (the correct one) and approximated (the default one) solutions
is about $3.5 \cdot 10^{11}$.
Of course, both p-values are pretty small in this case.
If you are using the notorious $\alpha = 0.05$, you will most likely avoid such a problem
(however, for $n=1,\, m = 50$, the exact true p-value is $0.0196$, while the approximated one is $0.0480$,
whish is alarmingly close to $0.05$).</p><p>If you prefer using extremely low statistical significance levels
and there are non-zero chances of getting extreme values of the $U$ statistic,
you may consider making <code>exact = TRUE</code> your default way to call <code>wilcox.test</code>.
Such a simple trick may save you from misleading research results.</p><h3 id=references>References</h3><ul><li><b id=Hollander1973>[Hollander1973]</b><br>Myles Hollander and Douglas A. Wolfe (1973)
Nonparametric Statistical Methods.
New York: John Wiley & Sons.
DOI:<a href=https://dx.doi.org/10.1002/9781119196037>10.1002/9781119196037</a></li></ul></div><br><br></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>