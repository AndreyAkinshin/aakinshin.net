<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.122.0"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics"><title>Non-normal median sampling distribution | Andrey Akinshin</title>
<meta name=description content="Let&amp;rsquo;s consider the classic sample median. If a sample is sorted and the number of sample elements is odd, the median is the middle element. In the case of an even number of sample elements, the median is an arithmetic average of the two middle element..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.a032e875598f97999dcca4aec47ea745e5896949ccc57dfcd01331a89561c222.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-2 xs:px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Non-normal median sampling distribution</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2021-11-23>November 23, 2021</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a></div></div><br><div class=main-content><p>Let&rsquo;s consider the classic sample median.
If a sample is sorted and the number of sample elements is odd, the median is the middle element.
In the case of an even number of sample elements, the median is an arithmetic average of the two middle elements.</p><p>Now let&rsquo;s say we randomly take many samples from the same distribution and calculate the median for each of them.
Next, we build a sampling distribution based on these median values.
There is a well-known fact that this distribution is asymptotically normal with mean $M$ and variance $1/(4nf^2(M))$,
where $n$ is the number of elements in samples,
$f$ is the probability density function of the original distribution,
and $M$ is the true median of the original distribution.</p><p>Unfortunately, if we try to build such sampling distributions in practice,
we may see that they are not always normal.
There are some corner cases that prevent us from using the normal model in general.
If you implement general routines that analyze the median behavior,
you should keep such cases in mind.
In this post, we briefly talk about some of these cases.</p><h3 id=regular-case>Regular case</h3><p>We start with a regular case when the median sampling distribution actually behaves like a normal one.
Let&rsquo;s consider the standard exponential distribution ($\lambda = 1$):</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/non-normal-median-distribution/img/exp-pdf-light.png target=_blank alt=exp-pdf><img src=/posts/non-normal-median-distribution/img/exp-pdf-light.png width=800>
</a><a class="img-dark hidden" href=/posts/non-normal-median-distribution/img/exp-pdf-dark.png target=_blank alt=exp-pdf><img src=/posts/non-normal-median-distribution/img/exp-pdf-dark.png width=800></a></div><p>Its median of this distribution is well-known:</p>$$
M = \frac{\ln 2}{\lambda}
$$<p>The corresponding PDF is also known:</p>$$
f(x) = \lambda e^{-\lambda x}
$$<p>Thus, the mean of the sampling distribution is $\mu = M = \ln 2 \approx 0.693$.
If we set $n = 50$, the variance is
$\sigma^2 = 1/(4nf^2(m)) = 0.02$.</p><p>Now let&rsquo;s generate $10\,000$ samples of size $50$,
get the sample median for each of them,
and build the kernel density estimation of the sampling distribution using the Sheather & Jones method:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/non-normal-median-distribution/img/exp-medians1-light.png target=_blank alt=exp-medians1><img src=/posts/non-normal-median-distribution/img/exp-medians1-light.png width=800>
</a><a class="img-dark hidden" href=/posts/non-normal-median-distribution/img/exp-medians1-dark.png target=_blank alt=exp-medians1><img src=/posts/non-normal-median-distribution/img/exp-medians1-dark.png width=800></a></div><p>As we can see, the actual sampling distribution is pretty close to the theoretical one.
So far, the normality assumption works as expected.</p><h3 id=small-samples>Small samples</h3><p>Now let&rsquo;s reduce the sample size to $n=5$ and repeat the experiment.
The theoretical model has the same mean,
but the variance is $\sigma^2 = 0.2$.
Here are the simulation results:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/non-normal-median-distribution/img/exp-medians2-light.png target=_blank alt=exp-medians2><img src=/posts/non-normal-median-distribution/img/exp-medians2-light.png width=800>
</a><a class="img-dark hidden" href=/posts/non-normal-median-distribution/img/exp-medians2-dark.png target=_blank alt=exp-medians2><img src=/posts/non-normal-median-distribution/img/exp-medians2-dark.png width=800></a></div><p>Now the theoretical model is not so close to the empirical one.
The median sampling distribution is only <em>asymptotically</em> normal.
Thus, we shouldn&rsquo;t expect the predicted normality on small samples.
The &ldquo;proper&rdquo; sample size heavily depends on the underlying distributions.
In some cases, you may need several hundreds of elements in each sample to achieve the expected normality.</p><h3 id=zero-pdf>Zero PDF</h3><p>Now let&rsquo;s talk about corner cases.
The variance of the sampling distribution should be asymptotically equal $1/(4nf^2(M))$.
But what if $f(M) = 0$?</p><p>Let&rsquo;s consider a perfect bimodal distribution formed by two uniform distributions
$\mathcal{U}(-2, -1)$ and $\mathcal{U}(1, 2)$:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/non-normal-median-distribution/img/bi-pdf-light.png target=_blank alt=bi-pdf><img src=/posts/non-normal-median-distribution/img/bi-pdf-light.png width=800>
</a><a class="img-dark hidden" href=/posts/non-normal-median-distribution/img/bi-pdf-dark.png target=_blank alt=bi-pdf><img src=/posts/non-normal-median-distribution/img/bi-pdf-dark.png width=800></a></div><p>Here is the corresponding empirical sampling distribution:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/non-normal-median-distribution/img/bi-medians-light.png target=_blank alt=bi-medians><img src=/posts/non-normal-median-distribution/img/bi-medians-light.png width=800>
</a><a class="img-dark hidden" href=/posts/non-normal-median-distribution/img/bi-medians-dark.png target=_blank alt=bi-medians><img src=/posts/non-normal-median-distribution/img/bi-medians-dark.png width=800></a></div><p>As we can see, it&rsquo;s trimodal.
Doesn&rsquo;t look like a normal one, does it?
Unfortunately, when $f(M) = 0$, we can&rsquo;t rely on the normal model anymore.</p><h3 id=infinite-pdf>Infinite PDF</h3><p>Another corner case is $f(M) = \infty$.
Let&rsquo;s consider the rectified Gaussian distribution which could be obtained
from the normal distribution by replacing all the negative values with zeros:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/non-normal-median-distribution/img/rg-pdf-light.png target=_blank alt=rg-pdf><img src=/posts/non-normal-median-distribution/img/rg-pdf-light.png width=800>
</a><a class="img-dark hidden" href=/posts/non-normal-median-distribution/img/rg-pdf-dark.png target=_blank alt=rg-pdf><img src=/posts/non-normal-median-distribution/img/rg-pdf-dark.png width=800></a></div><p>This distribution is a mixture of
a discrete one (the Dirac delta function $\delta(0)$)
and a continuous one (the &ldquo;right part&rdquo; of the normal distribution)
with equal weights.
Such cases often arise in real life when we have common &ldquo;border&rdquo; values across sampling data.</p><p>Here is the corresponding sampling distribution:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/non-normal-median-distribution/img/rg-medians-light.png target=_blank alt=rg-medians><img src=/posts/non-normal-median-distribution/img/rg-medians-light.png width=800>
</a><a class="img-dark hidden" href=/posts/non-normal-median-distribution/img/rg-medians-dark.png target=_blank alt=rg-medians><img src=/posts/non-normal-median-distribution/img/rg-medians-dark.png width=800></a></div><p>It definitely doesn&rsquo;t look like a normal one.</p><h3 id=conclusion>Conclusion</h3><p>Asymptotical models could be useful in statistical analysis
when we are sure that external conditions allow getting a picture
that is close enough to the theoretical one.
Without careful analysis of these conditions, we couldn&rsquo;t apply the asymptotical model in the general case.
As we can see, a mindless usage of the normal model for the median sampling distribution
could bring a lot of trouble in corner cases.</p></div><br><br></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>