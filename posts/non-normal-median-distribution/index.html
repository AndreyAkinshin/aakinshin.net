<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.74.3"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Statistics"><title>Non-normal median sampling distribution | Andrey Akinshin</title><meta name=description content="Let&amp;rsquo;s consider the classic sample median. If a sample is sorted and the number of sample elements is odd, the median is the middle element. In the ca..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=/css/lumen-bootstrap.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/slate-bootstrap.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><link href=/css/syntax-light.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/syntax-dark.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.26d61b7027fe55e642f0001cef94cb75b567d721086492aab6b4e32d9ee7811d.js></script><script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.882998740b9c4c24677576b997bde5a487246e2e3bd72128a0e922eaa59db029.mjs></script><link href=https://aakinshin.net/css/fontawesome-all.min.50da8736f05b35aac9691de67fe993cbe01b7d88fcf0cb682c3a8f39933fe4a3.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.2a76db7cc14055b3bafacc363f453917ab54a818a7db2a0a9b2409c0f6bf07c5.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.ae812fc71daf5160d927febda5a991cee6c361345e3f685d3736931ed7537986.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVB6MXSX32"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-ZVB6MXSX32');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-41419012-5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-41419012-5');</script><script type=text/javascript>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");ym(28700916,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src=https://mc.yandex.ru/watch/28700916 style=position:absolute;left:-9999px alt></div></noscript><script src=/js/jquery-3.3.1.slim.min.js></script></head><body><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class=nav-item><a class=nav-link id=nav-link-posts href=https://aakinshin.net/posts/>Posts</a></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li><li class=nav-item><a class=nav-link id=nav-link-pdnb href=https://aakinshin.net/prodotnetbenchmarking/>Pro .NET Benchmarking</a></li></ul><ul class="navbar-nav ml-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Non-normal median sampling distribution</h1><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2021-11-23>November 23, 2021</time>
&nbsp;&nbsp;
<i class="fas fa-tag"></i>&nbsp;
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a></span><br><br><p>Let&rsquo;s consider the classic sample median.
If a sample is sorted and the number of sample elements is odd, the median is the middle element.
In the case of an even number of sample elements, the median is an arithmetic average of the two middle elements.</p><p>Now let&rsquo;s say we randomly take many samples from the same distribution and calculate the median for each of them.
Next, we build a sampling distribution based on these median values.
There is a well-known fact that this distribution is asymptotically normal with mean <span class="math inline">\(M\)</span> and variance <span class="math inline">\(1/(4nf^2(M))\)</span>,
where <span class="math inline">\(n\)</span> is the number of elements in samples,
<span class="math inline">\(f\)</span> is the probability density function of the original distribution,
and <span class="math inline">\(M\)</span> is the true median of the original distribution.</p><p>Unfortunately, if we try to build such sampling distributions in practice,
we may see that they are not always normal.
There are some corner cases that prevent us from using the normal model in general.
If you implement general routines that analyze the median behavior,
you should keep such cases in mind.
In this post, we briefly talk about some of these cases.</p><h3 id=regular-case>Regular case</h3><p>We start with a regular case when the median sampling distribution actually behaves like a normal one.
Let&rsquo;s consider the standard exponential distribution (<span class="math inline">\(\lambda = 1\)</span>):</p><div class=row><div class=mx-auto><a href=/posts/non-normal-median-distribution/img/exp-pdf-light.png target=_blank class=imgldlink alt=exp-pdf><picture>
<source theme=dark srcset=/posts/non-normal-median-distribution/img/exp-pdf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/non-normal-median-distribution/img/exp-pdf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/non-normal-median-distribution/img/exp-pdf-light.png></picture></a></div></div><br><p>Its median of this distribution is well-known:</p><p><span class="math display">\[M = \frac{\ln 2}{\lambda}
\]</span></p><p>The corresponding PDF is also known:</p><p><span class="math display">\[f(x) = \lambda e^{-\lambda x}
\]</span></p><p>Thus, the mean of the sampling distribution is <span class="math inline">\(\mu = M = \ln 2 \approx 0.693\)</span>.
If we set <span class="math inline">\(n = 50\)</span>, the variance is
<span class="math inline">\(\sigma^2 = 1/(4nf^2(m)) = 0.02\)</span>.</p><p>Now let&rsquo;s generate <span class="math inline">\(10\,000\)</span> samples of size <span class="math inline">\(50\)</span>,
get the sample median for each of them,
and build the kernel density estimation of the sampling distribution using the Sheather & Jones method:</p><div class=row><div class=mx-auto><a href=/posts/non-normal-median-distribution/img/exp-medians1-light.png target=_blank class=imgldlink alt=exp-medians1><picture>
<source theme=dark srcset=/posts/non-normal-median-distribution/img/exp-medians1-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/non-normal-median-distribution/img/exp-medians1-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/non-normal-median-distribution/img/exp-medians1-light.png></picture></a></div></div><br><p>As we can see, the actual sampling distribution is pretty close to the theoretical one.
So far, the normality assumption works as expected.</p><h3 id=small-samples>Small samples</h3><p>Now let&rsquo;s reduce the sample size to <span class="math inline">\(n=5\)</span> and repeat the experiment.
The theoretical model has the same mean,
but the variance is <span class="math inline">\(\sigma^2 = 0.2\)</span>.
Here are the simulation results:</p><div class=row><div class=mx-auto><a href=/posts/non-normal-median-distribution/img/exp-medians2-light.png target=_blank class=imgldlink alt=exp-medians2><picture>
<source theme=dark srcset=/posts/non-normal-median-distribution/img/exp-medians2-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/non-normal-median-distribution/img/exp-medians2-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/non-normal-median-distribution/img/exp-medians2-light.png></picture></a></div></div><br><p>Now the theoretical model is not so close to the empirical one.
The median sampling distribution is only <em>asymptotically</em> normal.
Thus, we shouldn&rsquo;t expect the predicted normality on small samples.
The &ldquo;proper&rdquo; sample size heavily depends on the underlying distributions.
In some cases, you may need several hundreds of elements in each sample to achieve the expected normality.</p><h3 id=zero-pdf>Zero PDF</h3><p>Now let&rsquo;s talk about corner cases.
The variance of the sampling distribution should be asymptotically equal <span class="math inline">\(1/(4nf^2(M))\)</span>.
But what if <span class="math inline">\(f(M) = 0\)</span>?</p><p>Let&rsquo;s consider a perfect bimodal distribution formed by two uniform distributions
<span class="math inline">\(\mathcal{U}(-2, -1)\)</span> and <span class="math inline">\(\mathcal{U}(1, 2)\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/non-normal-median-distribution/img/bi-pdf-light.png target=_blank class=imgldlink alt=bi-pdf><picture>
<source theme=dark srcset=/posts/non-normal-median-distribution/img/bi-pdf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/non-normal-median-distribution/img/bi-pdf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/non-normal-median-distribution/img/bi-pdf-light.png></picture></a></div></div><br><p>Here is the corresponding empirical sampling distribution:</p><div class=row><div class=mx-auto><a href=/posts/non-normal-median-distribution/img/bi-medians-light.png target=_blank class=imgldlink alt=bi-medians><picture>
<source theme=dark srcset=/posts/non-normal-median-distribution/img/bi-medians-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/non-normal-median-distribution/img/bi-medians-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/non-normal-median-distribution/img/bi-medians-light.png></picture></a></div></div><br><p>As we can see, it&rsquo;s trimodal.
Doesn&rsquo;t look like a normal one, does it?
Unfortunately, when <span class="math inline">\(f(M) = 0\)</span>, we can&rsquo;t rely on the normal model anymore.</p><h3 id=infinite-pdf>Infinite PDF</h3><p>Another corner case is <span class="math inline">\(f(M) = \infty\)</span>.
Let&rsquo;s consider the rectified Gaussian distribution which could be obtained
from the normal distribution by replacing all the negative values with zeros:</p><div class=row><div class=mx-auto><a href=/posts/non-normal-median-distribution/img/rg-pdf-light.png target=_blank class=imgldlink alt=rg-pdf><picture>
<source theme=dark srcset=/posts/non-normal-median-distribution/img/rg-pdf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/non-normal-median-distribution/img/rg-pdf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/non-normal-median-distribution/img/rg-pdf-light.png></picture></a></div></div><br><p>This distribution is a mixture of
a discrete one (the Dirac delta function <span class="math inline">\(\delta(0)\)</span>)
and a continuous one (the &ldquo;right part&rdquo; of the normal distribution)
with equal weights.
Such cases often arise in real life when we have common &ldquo;border&rdquo; values across sampling data.</p><p>Here is the corresponding sampling distribution:</p><div class=row><div class=mx-auto><a href=/posts/non-normal-median-distribution/img/rg-medians-light.png target=_blank class=imgldlink alt=rg-medians><picture>
<source theme=dark srcset=/posts/non-normal-median-distribution/img/rg-medians-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/non-normal-median-distribution/img/rg-medians-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/non-normal-median-distribution/img/rg-medians-light.png></picture></a></div></div><br><p>It definitely doesn&rsquo;t look like a normal one.</p><h3 id=conclusion>Conclusion</h3><p>Asymptotical models could be useful in statistical analysis
when we are sure that external conditions allow getting a picture
that is close enough to the theoretical one.
Without careful analysis of these conditions, we couldn&rsquo;t apply the asymptotical model in the general case.
As we can see, a mindless usage of the normal model for the median sampling distribution
could bring a lot of trouble in corner cases.</p><br><br><div class=row><div class="mx-auto share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fnon-normal-median-distribution%2f&title=Non-normal%20median%20sampling%20distribution" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Non-normal%20median%20sampling%20distribution&url=https%3a%2f%2faakinshin.net%2fposts%2fnon-normal-median-distribution%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x"></i></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fnon-normal-median-distribution%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=share-button><a href="https://facebook.com/sharer.php?u=https%3a%2f%2faakinshin.net%2fposts%2fnon-normal-median-distribution%2f" rel=nofollow target=_blank title="Share on Facebook"><i class="fab fa-facebook fa-2x"></i></a></div><div class=share-button><a href="http://vk.com/share.php?url=https%3a%2f%2faakinshin.net%2fposts%2fnon-normal-median-distribution%2f" target=_blank title="Share on VKontakte"><i class="fab fa-vk fa-2x"></i></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fnon-normal-median-distribution%2f&title=Non-normal%20median%20sampling%20distribution" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div></div></div><hr></div></div></main></div><footer class=blog-footer><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub></i></a><a href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter></i></a><a href=https://aakinshin.net/posts/index.xml><i class="fas fa-rss" title=RSS></i></a>|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.082780cb948cc57eabbc0d80172a7a5347d5572b599938b4c9876dfd7978b424.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/anchor.min.js></script><script src=https://aakinshin.net/js/custom.min.11932490dde776463ed165b345838c701accc0cfdedf2e0868f13415f41f0872.js></script><script>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true,},options:{skipHtmlTags:['script','noscript','style','textarea','pre'],ignoreHtmlClass:'tex2jax_ignore',processHtmlClass:'tex2jax_process'}};</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>