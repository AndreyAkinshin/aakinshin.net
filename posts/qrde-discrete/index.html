<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Quantile,QRDE,Density estimation,Discrete distribution,Ties,Jittering"><title>Improving quantile-respectful density estimation for discrete distributions using jittering | Andrey Akinshin</title><meta name=description content="A discussion about quantile-respectful density estimation problems for distributions with discrete features"><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=https://aakinshin.net/sass/bootstrap-light.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=https://aakinshin.net/sass/bootstrap-dark.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.d7f6578e23ad3f0c33c589f9bcb34f995b45121f1f3ce888869c86b26826c845.js></script>
<script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.9e68d431432744c07a43381a8a833ffe0921cc0e006d84ad97f0b0d43c5cd82d.mjs></script>
<link href=https://aakinshin.net/css/fontawesome-all.min.178e95bba6ea2e9a90838cd646658f4bf6667a6ceaa057cb587bf7e6eb8412d3.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.60773ab7266ecc6e9625306f57c0a82a219b011dc3ea2d83763d1ecdf11c86d2.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.7e186db80d8c431d196b3e0718afb0636b82a269a8c92521c11a55267a24fc27.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVB6MXSX32"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZVB6MXSX32")</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-41419012-5"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-41419012-5")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(28700916,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/28700916 style=position:absolute;left:-9999px alt></div></noscript><script src=/js/jquery-3.3.1.slim.min.js></script></head><body><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Blog</a><ul class="dropdown-menu bg-primary"><li><a class=dropdown-item href=https://aakinshin.net/posts/>All Posts</a></li><li><a class=dropdown-item href=https://aakinshin.net/tags/statistics/>Posts about Statistics</a></li><li></li><a class=dropdown-item href=https://aakinshin.net/tags/>All Tags</a></li></ul></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Improving quantile-respectful density estimation for discrete distributions using jittering</h1><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2021-04-27>April 27, 2021</time>
&nbsp;&nbsp;
<i class="fas fa-tag"></i>
&nbsp;
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/research/ class="badge badge-info">Research</a>
<a href=https://aakinshin.net/tags/quantile/ class="badge badge-info">Quantile</a>
<a href=https://aakinshin.net/tags/qrde/ class="badge badge-info">QRDE</a>
<a href=https://aakinshin.net/tags/density-estimation/ class="badge badge-info">Density estimation</a>
<a href=https://aakinshin.net/tags/discrete-distribution/ class="badge badge-info">Discrete distribution</a>
<a href=https://aakinshin.net/tags/ties/ class="badge badge-info">Ties</a>
<a href=https://aakinshin.net/tags/jittering/ class="badge badge-info">Jittering</a></span><br><br><p>In my previous posts, I already discussed the <a href=https://aakinshin.net/posts/kde-discrete/>problem</a> that arise
when we try to build the kernel density estimation (KDE) for samples with ties.
We may get such samples in real life from discrete or mixed discrete/continuous distributions.
Even if the original distribution is continuous,
we may observe artificial sample discretization due to a limited resolution of the measuring tool.
Such discretization may lead to inaccurate density plots due to undersmoothing.
The problem can be resolved using a nice technique called <em>jittering</em>.
I also discussed <a href=https://aakinshin.net/posts/discrete-sample-jittering/>how to apply</a> jittering to get a smoother version of KDE.</p><p>However, I&rsquo;m not a huge fan of KDE because of two reasons.
The first one is the <a href=https://aakinshin.net/posts/kde-bw/>problem of choosing a proper bandwidth value</a>.
With poorly chosen bandwidth, we can easily get oversmoothing or undersmoothing even without the discretization problem.
The second one is an inconsistency between the KDE-based probability density function and evaluated sample quantiles.
It could lead to inconsistent visualizations (e.g., KDE-based violin plots with non-KDE-based quantile values)
or it could introduce problems for algorithms that require density function and quantile values at the same time.
The inconsistency could be resolved using <a href=https://aakinshin.net/posts/qrde-hd/>quantile-respectful density estimation</a> (QRDE).
This kind of estimation builds the density function which matches the evaluated sample quantiles.
To get a smooth QRDE, we also need a smooth quantile estimator like the Harrell-Davis quantile estimator.
The robustness and componential efficiency of this approach can be improved using
the <a href=https://aakinshin.net/posts/winsorized-hdqe/>winsorized</a> and <a href=https://aakinshin.net/posts/trimmed-hdqe/>trimmed</a>
modifications of the Harrell-Davis quantile estimator
(which also have a <a href=https://aakinshin.net/posts/wthdqe-efficiency/>decent statistical efficiency level</a>).</p><p>Unfortunately, the straightforward QRDE calculation is not always applicable for samples with ties
because it&rsquo;s impossible to build an &ldquo;honest&rdquo; density function for discrete distributions
without using the Dirac delta function.
This is a severe problem for QRDE-based algorithms like the
<a href=https://aakinshin.net/posts/lowland-multimodality-detection/>lowland multimodality detection algorithm</a>.
In this post, I will show how jittering could help to solve this problem and get a smooth QRDE on samples with ties.</p><h3 id=continuous-distribution>Continuous distribution</h3><p>First of all, let&rsquo;s briefly discuss the connection between
the quantile function,
the cumulative distribution function (CDF),
and the probability density function (PDF)
for continuous distributions.
As a continuous distribution example, we take the Gumbel distribution.</p><p>Here is the Gumbel distribution quantile function <span class="math inline">\(Q_{\textrm{Gum}}(p)\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/gumbel-quantile-light.png target=_blank class=imgldlink alt=gumbel-quantile><picture><source theme=dark srcset=/posts/qrde-discrete/img/gumbel-quantile-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/gumbel-quantile-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/gumbel-quantile-light.png></picture></a></div></div><br><p>For the Gumbel distribution, all the quantile values are different.
For any <span class="math inline">\(p_1 < p_2\)</span>, we can say that <span class="math inline">\(Q_{\textrm{Gum}}(p_1) < Q_{\textrm{Gum}}(p_2)\)</span>.
It means that the quantile function <span class="math inline">\(Q_{\textrm{Gum}}(p)\)</span> is strictly increasing
(it doesn&rsquo;t have any horizontal segments).</p><p>The CDF is an inversion of the quantile function.
Here is the CDF of the Gumbel distribution <span class="math inline">\(F_{\textrm{Gum}} = Q^{-1}_{\textrm{Gum}}\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/gumbel-cdf-light.png target=_blank class=imgldlink alt=gumbel-cdf><picture><source theme=dark srcset=/posts/qrde-discrete/img/gumbel-cdf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/gumbel-cdf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/gumbel-cdf-light.png></picture></a></div></div><br><p>Since the quantile function doesn&rsquo;t have horizontal segments,
the CDF doesn&rsquo;t have vertical segments.
Thus, the CDF is also a continuous and strictly increasing function.</p><p>The PDF is the CDF derivative.
Here is the PDF of the gumbel distribution <span class="math inline">\(f_{\textrm{Gum}} = F'_{\textrm{Gum}}\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/gumbel-pdf-light.png target=_blank class=imgldlink alt=gumbel-pdf><picture><source theme=dark srcset=/posts/qrde-discrete/img/gumbel-pdf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/gumbel-pdf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/gumbel-pdf-light.png></picture></a></div></div><br><p>Since the CDF is continuous, the PDF is also a continuous function that has finite values at each point.</p><h3 id=discrete-distribution>Discrete distribution</h3><p>As a discrete distribution example, we take the Poisson distribution (<span class="math inline">\(\lambda = 1\)</span>).
Here is the corresponding quantile function <span class="math inline">\(Q_{\textrm{Pois}}\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-quantile-light.png target=_blank class=imgldlink alt=poisson-quantile><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-quantile-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-quantile-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-quantile-light.png></picture></a></div></div><br><p>Since the Poisson distribution contains only integer numbers, the values of <span class="math inline">\(Q_{\textrm{Pois}}\)</span> are also integers.
The quantile function consists of horizontal segments.
Now let&rsquo;s look at the CDF which is an inversion of the quantile function <span class="math inline">\(F_{\textrm{Pois}} = Q^{-1}_{\textrm{Pois}}\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-cdf-light.png target=_blank class=imgldlink alt=poisson-cdf><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-cdf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-cdf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-cdf-light.png></picture></a></div></div><br><p>Since quantile function has horizontal segments,
the CDF is discontinuous at the integers.
For discrete distributions, we typically use the probability mass function (PMF) instead of the PDF.
Unlike the PDF, the PMF has a discrete argument, so it could be shown in the histogram form.
Here is the PMF of the Poisson distribution:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-pmf-light.png target=_blank class=imgldlink alt=poisson-pmf><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-pmf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-pmf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-pmf-light.png></picture></a></div></div><br><p>If we really want to build the PDF, it&rsquo;s possible with the help of the Dirac delta function:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-pdf-light.png target=_blank class=imgldlink alt=poisson-pdf><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-pdf-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-pdf-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-pdf-light.png></picture></a></div></div><br><p>Such PDF is not continuous.</p><h3 id=qrde>QRDE</h3><p>The detailed description and motivation of quantile-respectful density estimation (QRDE)
can be found <a href=https://aakinshin.net/posts/qrde-hd/>here</a>.
Let&rsquo;s briefly recall the main idea of this approach.
We are going to build a density estimation for a sample from an unknown distribution.
This estimation should be consistent with the evaluated quantile values.
To get a smooth estimation, we need a smooth quantile estimator like the Harrell-Davis quantile estimator
(or its <a href=https://aakinshin.net/posts/winsorized-hdqe/>winsorized</a> or <a href=https://aakinshin.net/posts/trimmed-hdqe/>trimmed</a> modifications).
Let <span class="math inline">\(Q(p)\)</span> be the target quantile estimator.
Now we are going to estimate <span class="math inline">\(k\)</span>-quantiles at the following positions:</p><p><span class="math display">\[p_i = i / k, \quad i = 0, \ldots, k.
\]</span></p><p>For example, if <span class="math inline">\(k = 100\)</span> (we work with percentile), here are the <span class="math inline">\(p_i\)</span> values:</p><p><span class="math display">\[p = \{ 0.00, 0.01, 0.02, \ldots, 0.99, 1.00 \}.
\]</span></p><p>The QRDE could be presented as a histogram.
For each <span class="math inline">\(i = 0, \ldots, k - 1\)</span>, we could introduce a histogram bar.
The left (<span class="math inline">\(x_l\)</span>) and the right (<span class="math inline">\(x_r\)</span>) borders of the bar are defined as quantile values:</p><p><span class="math display">\[x_l = Q(p_i), \quad x_r = Q(p_{i+1}).
\]</span></p><p>By definition, the total area of the density plot should equal <span class="math inline">\(1.0\)</span>.
If we split it into <span class="math inline">\(k\)</span> equal bars, the area of each bar should equal <span class="math inline">\(1.0 / k\)</span>.
Since we know the width and the area of each bar, it&rsquo;s easy to calculate its height:</p><p><span class="math display">\[h = \frac{1/k}{x_r - x_l}
\]</span></p><p>That&rsquo;s all: now we know the borders and the height of each bar.
Here is an example of the QRDE for a sample from the normal distribution
(with a rug plot at the bottom):</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/norm-qrde-light.png target=_blank class=imgldlink alt=norm-qrde><picture><source theme=dark srcset=/posts/qrde-discrete/img/norm-qrde-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/norm-qrde-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/norm-qrde-light.png></picture></a></div></div><br><h3 id=degenerate-qrde-on-discrete-distribution>Degenerate QRDE on discrete distribution</h3><p>Let&rsquo;s look one more time at the definition of the bar height:</p><p><span class="math display">\[h = \frac{1/k}{x_r - x_l} = \frac{1/k}{Q(p_{i+1}) - Q(p_i)}.
\]</span></p><p>Thus, if <span class="math inline">\(Q(p_i) = Q(p_{i+1})\)</span>, the histogram bar should be transformed to the Dirac delta function.
In practice, if the given sample contains tied values,
we may get a situation when <span class="math inline">\(|Q(p_i) - Q(p_{i+1})|\)</span> is extremely small,
which leads to an extremely huge <span class="math inline">\(h\)</span> value.
As a result, we get degenerated QRDE.
Let&rsquo;s check how it looks in real life.</p><p>Here is a sample from the Poisson distribution:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>x1</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span> <span class=p>}</span>
</span></span></code></pre></div><p><code>x1</code> gives us the following QRDE plot:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-qrde1-light.png target=_blank class=imgldlink alt=poisson-qrde1><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-qrde1-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-qrde1-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-qrde1-light.png></picture></a></div></div><br><p>Because of the ties, we have a high peak around zero (<span class="math inline">\(h \approx 30\)</span>).
Now let&rsquo;s add another zero value to <code>x1</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>x2</span> <span class=o>=</span> <span class=p>{</span><span class=nx>x1</span><span class=p>,</span> <span class=mi>0</span><span class=p>}</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span> <span class=p>}</span>
</span></span></code></pre></div><p>The situation became worse (<span class="math inline">\(h \approx 130\)</span>):</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-qrde2-light.png target=_blank class=imgldlink alt=poisson-qrde2><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-qrde2-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-qrde2-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-qrde2-light.png></picture></a></div></div><br><p>Let&rsquo;s continue this procedure and add one more zero value:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>x3</span> <span class=o>=</span> <span class=p>{</span><span class=nx>x1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span> <span class=p>}</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span> <span class=p>}</span>
</span></span></code></pre></div><p>Now <span class="math inline">\(h \approx 600\)</span>, the QRDE plot became useless:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-qrde3-light.png target=_blank class=imgldlink alt=poisson-qrde3><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-qrde3-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-qrde3-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-qrde3-light.png></picture></a></div></div><br><h3 id=improving-qrde-using-jittering>Improving QRDE using jittering</h3><p>To fix the problem, we can use the jittering technique based on the Beta function as described in the
<a href=https://aakinshin.net/posts/discrete-sample-jittering/>previous post</a>.
The suggested technique has the following advantages:</p><ul><li>It doesn&rsquo;t involve randomization, so it produces the same result each time.</li><li>It preserves sample range: the minimum and the maximum value will not be corrupted.</li><li>It ensures high density near the original values</li></ul><p>If we apply jittering (based on the Beta function) to <code>x3</code>, we get the following sample:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>x4</span> <span class=o>=</span> <span class=nx>jittering</span><span class=p>(</span><span class=nx>x3</span><span class=p>)</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=mf>0.00000000</span><span class=p>,</span> <span class=mf>0.02957037</span><span class=p>,</span> <span class=mf>0.06495575</span><span class=p>,</span> <span class=mf>0.10929974</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=mf>0.16944062</span><span class=p>,</span> <span class=mf>0.26618052</span><span class=p>,</span> <span class=mf>0.58622006</span><span class=p>,</span> <span class=mf>0.69481940</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mf>0.77159043</span><span class=p>,</span> <span class=mf>0.83508358</span><span class=p>,</span> <span class=mf>0.89198685</span><span class=p>,</span> <span class=mf>0.94597932</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mf>1.00000000</span><span class=p>,</span> <span class=mf>1.05771731</span><span class=p>,</span> <span class=mf>1.12709591</span><span class=p>,</span> <span class=mf>1.89371011</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mf>2.00000000</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This gives a reasonable QRDE plot:</p><div class=row><div class=mx-auto><a href=/posts/qrde-discrete/img/poisson-qrde4-light.png target=_blank class=imgldlink alt=poisson-qrde4><picture><source theme=dark srcset=/posts/qrde-discrete/img/poisson-qrde4-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qrde-discrete/img/poisson-qrde4-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qrde-discrete/img/poisson-qrde4-light.png></picture></a></div></div><br><br><br><div class=row><div class="justify-content-center share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fqrde-discrete%2f&title=Improving%20quantile-respectful%20density%20estimation%20for%20discrete%20distributions%20using%20jittering" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Improving%20quantile-respectful%20density%20estimation%20for%20discrete%20distributions%20using%20jittering&url=https%3a%2f%2faakinshin.net%2fposts%2fqrde-discrete%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x"></i></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fqrde-discrete%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fqrde-discrete%2f&title=Improving%20quantile-respectful%20density%20estimation%20for%20discrete%20distributions%20using%20jittering" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div></div></div><hr></div></div></main></div><footer class=blog-footer><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub></i></a>
<a href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter></i></a>
<a href=https://aakinshin.net/posts/index.xml><i class="fas fa-rss" title=RSS></i></a>
|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.c26550621ac13c2221d7f6f5e6fe862345d3919723c50d730893e3e4856ecf35.js></script>
<script src=/js/bootstrap.bundle.min.js></script>
<script src=/js/anchor.min.js></script>
<script src=https://aakinshin.net/js/custom.min.f6e5d13fe39f305056cc743ee4cb8d117c1aba26176e58c82c79a480d02fe4b7.js></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>