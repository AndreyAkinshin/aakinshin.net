<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.7"><meta name=author content='Andrey Akinshin'><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content='Mathematics,Statistics,Research,Research: Resistance to the low-density regions'><title>Resistance to the low-density regions: the mean and the median | Andrey Akinshin</title>
<meta name=description content="When we discuss resistant statistics, we typically assume resistance to extreme values. However, extreme values are not the only problem source that can violate usual assumptions about expected metric distribution. The low-density regions which often arise ..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.d6826f88345af20c0769a313557ec1355465a3091b1f9869b936f2504c4dfe26.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body class="flex flex-col min-h-screen"><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-2 xs:px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/search/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#magnifying-glass"/></svg></a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6 flex-grow"><div class=main-post><h1 class=blog-post-title id=post-title>Resistance to the low-density regions: the mean and the median</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2022-11-15>November 15, 2022</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/><svg class="rating-icon"><use xlink:href="/img/fa/all.svg#math"/></svg>
Mathematics
</a><a class=label-link href=https://aakinshin.net/tags/statistics/><svg class="rating-icon"><use xlink:href="/img/fa/all.svg#statistics"/></svg>
Statistics
</a><a class=label-link href=https://aakinshin.net/tags/research/>Research
</a><a class=label-link href=https://aakinshin.net/tags/research-rldr/>Research: Resistance to the low-density regions</a></div></div><br><div class=main-content><p>When we discuss resistant statistics, we typically assume resistance to extreme values.
However, extreme values are not the only problem source
that can violate usual assumptions about expected metric distribution.
The low-density regions which often arise in multimodal distributions
can also corrupt the results of the statistical analysis.
In this post, I discuss this problem and introduce a measure of resistance to low-density regions.</p><h3 id=median-sampling-distribution>Median sampling distribution</h3><p>In most cases, the median sampling distribution is asymptotically normal with mean $M$ and variance $1/(4nf^2(M))$,
where $n$ is the number of elements in samples,
$f$ is the probability density function of the original distribution,
and $M$ is the true median of the original distribution.
As I have already <a href=https://aakinshin.net/posts/non-normal-median-distribution/>discussed</a>,
this rule doesn&rsquo;t always work.
To be specific, the asymptotic variance $1/(4nf^2(M))$ is not defined when $f(M) = 0$.
For example, let us consider the median sampling distribution for a mixture of two unimodal distributions
$\mathcal{U}(0, 1)$ and $\mathcal{U}(2, 3)$:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/rldr-mean-median/img/bimodal1-light.png target=_blank alt=bimodal1><img src=/posts/rldr-mean-median/img/bimodal1-light.png width=800>
</a><a class="img-dark hidden" href=/posts/rldr-mean-median/img/bimodal1-dark.png target=_blank alt=bimodal1><img src=/posts/rldr-mean-median/img/bimodal1-dark.png width=800></a></div><p>And here is the corresponding median sampling distribution (10000 samples of size 100):</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/rldr-mean-median/img/bimodal2-light.png target=_blank alt=bimodal2><img src=/posts/rldr-mean-median/img/bimodal2-light.png width=800>
</a><a class="img-dark hidden" href=/posts/rldr-mean-median/img/bimodal2-dark.png target=_blank alt=bimodal2><img src=/posts/rldr-mean-median/img/bimodal2-dark.png width=800></a></div><h3 id=the-resistance-function>The resistance function</h3><p>In order to define a function that describes resistance to the low-density regions,
we consider an ultimate case that illustrates the problem: the Bernoulli distribution.
It is a discrete distribution that gives $0$ with probability $p$ and $1$ with probability $1-p$.
It can be considered as a condensed version of a bimodal distribution:
$0$ is the first mode, $1$ is the second mode; the $(0;1)$ interval is the low density region
(the density is zero within this interval).</p><p>If we are interested in a stable reproducible metric,
we should expect small changes in the metric values
when a single sample value or a few sample values &ldquo;jump&rdquo; from one mode to another.
More formally,
let $T$ be an estimator,
$n$ be a sample size,
$s$ be a number of sample values that jump from the first mode to the second one.
Let&rsquo;s build a function that shows the changes in the estimator value during such a jump.
We denote a sample that contains $k$ zeros and $n-k$ ones as $\mathbf{x}_k$:</p>$$
\mathbf{x}_k = \{ \underbrace{0, 0, \ldots, 0}_{k}, \underbrace{1, 1, \ldots, 1}_{n-k} \}
$$<p>If $s \leq k$ sample values jump from the first mode to the second one,
the estimation change is defined by the following function:</p>$$
R(T, n, s, k) = |T(\mathbf{x}_k) - T(\mathbf{x}_{k-s})|.
$$<p>If we don&rsquo;t know the exact value of $k$, but we want to evaluate the maximum possible change,
we can define another function:</p>$$
R(T, n, s) = \max_{s \leq k \leq n} R(T, n, s, k).
$$<p>Now let us explore this function for the mean and for the median.</p><h3 id=resistance-of-the-mean-and-the-median>Resistance of the mean and the median</h3><p>Now let&rsquo;s build the plot of $R(T, n, s)$ for the mean and the median.
In this experiment, we consider $n \leq 100$, $s \in \{1, 2, 3, 4, 5, 6\}$.
Here are the plots:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/rldr-mean-median/img/resistance-light.png target=_blank alt=resistance><img src=/posts/rldr-mean-median/img/resistance-light.png width=800>
</a><a class="img-dark hidden" href=/posts/rldr-mean-median/img/resistance-dark.png target=_blank alt=resistance><img src=/posts/rldr-mean-median/img/resistance-dark.png width=800></a></div><p>As we can see, the mean is quite resistant to the low-density regions,
while it&rsquo;s not robust (its breakdown point is zero).
Meanwhile, the median is not resistant to the low-density regions
(for $s\geq 2$, $R(\operatorname{median}, n, s) = 1$, which is the maximum value of $R(T, n, s)$),
while it&rsquo;s extremely robust (its breakdown point is 0.5).</p><p>In future posts, we will explore the resistance function for other measures of central tendency.</p></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>