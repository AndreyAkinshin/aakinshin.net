<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Research: Quantile absolute deviation"><title>Standard quantile absolute deviation | Andrey Akinshin</title><meta name=description content="The median absolute deviation (MAD) is a popular robust replacement of the standard deviation (StdDev). It&amp;rsquo;s truly robust: its breakdown point is \(5..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.852cec611cdd74c8e940745d8a06d6c32796c1f728bee243cbd8b0a4a9377c67.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Standard quantile absolute deviation</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2022-08-23>August 23, 2022</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/research-qad/>Research: Quantile absolute deviation</a></div></div><br><div class="main-content mb-3 px-2 py-1 rounded border text-alert-text-l border-alert-frame-l dark:text-alert-text-d dark:border-alert-frame-d">Update: this blog post is a part of research that aimed to build a new measure of statistical dispersion called quantile absolute deviation. A <a href=/posts/preprint-qad/>preprint with final results</a> is available on arXiv: <a href=https://arxiv.org/abs/2208.13459>arXiv:2208.13459 [stat.ME]</a>. Some information in this blog post can be obsolete: please, use the preprint as the primary reference.</div><div class=main-content><p>The median absolute deviation (MAD) is a popular robust replacement of the standard deviation (StdDev).
It&rsquo;s truly robust: its breakdown point is <span class="math inline">\(50\%\)</span>.
However, it&rsquo;s not so efficient when we use it as a consistent estimator for the standard deviation under normality:
the asymptotic relative efficiency against StdDev (we call it the <em>Gaussian efficiency</em>) is only about <span class="math inline">\(\approx 37\%\)</span>.</p><p>In practice, such robustness is not always essential, while we typically want to have the highest possible efficiency.
I already described the concept of the <a href=https://aakinshin.net/posts/qad/><em>quantile absolute deviation</em></a> which aims
to provide a customizable trade-off between robustness and efficiency.
In this post, I would like to suggest a new default option for this measure of dispersion
called the <em>standard quantile absolute deviation</em>.
Its Gaussian efficiency is <span class="math inline">\(\approx 54\%\)</span> while the breakdown point is <span class="math inline">\(\approx 32\%\)</span></p><h3 id=introduction>Introduction</h3><p>In the context of this post, we consider the quantile absolute deviation (<span class="math inline">\(\operatorname{QAD}\)</span>) around the median:</p><p><span class="math display">\[\newcommand{MAD}{\operatorname{MAD}}
\newcommand{QAD}{\operatorname{QAD}}
\newcommand{SQAD}{\operatorname{SQAD}}
\newcommand{Q}{\operatorname{Q}}
\newcommand{SD}{\operatorname{SD}}
\newcommand{QHF}{\operatorname{Q}_{\operatorname{HF7}}}
\newcommand{QHD}{\operatorname{Q}_{\operatorname{HD}}}
\newcommand{QTHD}{\operatorname{Q}_{\operatorname{THD-SQRT}}}
\newcommand{erf}{\operatorname{erf}}
\newcommand{erfinv}{\operatorname{erf}^{-1}}
\newcommand{E}{\mathbb{E}}
\newcommand{V}{\mathbb{V}}
\QAD(X, p) = \Q(|X - \Q(X, 0.5)|, p),
\]</span></p><p>where <span class="math inline">\(Q\)</span> is a quantile estimator, X is a sample of i.i.d. random variables <span class="math inline">\(X = \{ X_1, X_2, \ldots, X_n \}\)</span>.</p><p>Obviously, the median absolute deviation is a special case of <span class="math inline">\(\operatorname{QAD}\)</span>:</p><p><span class="math display">\[\MAD(X) = \Q(|X - \Q(X, 0.5)|, 0.5) = \QAD(X, 0.5).
\]</span></p><p>As for <span class="math inline">\(\Q\)</span>, we consider the traditional quantile estimator <span class="math inline">\(\QHF\)</span>
(Type 7 in the Hyndman-Fan taxonomy, see <a href=#Hyndman1996>[Hyndman1996]</a>).</p><h3 id=efficiency-vs-robustness>Efficiency vs. robustness</h3><p>The classic standard equation estimator provides great Gaussian efficiency for the standard deviation, but it is not robust
(the breakdown point is 0.0).
The median absolute deviation provides poor Gaussian efficiency, but it is highly robust (the breakdown point is 0.5).
When we choose an estimator, we always have to deal with a trade-off between efficiency and robustness.
Finding the right balance can be a challenging task.</p><p>It is said that <span class="math inline">\(\MAD\)</span> has the highest possible breakdown point for a scale estimator.
Though, we have a theoretical option to build a scale estimator with a higher breakdown point (e.g., <span class="math inline">\(\QAD(X, 0.25)\)</span>).
However, such an estimator would not make much sense.
Indeed, if more than 50% of the sample elements are corrupted by outliers,
these outliers become the major part of the distribution.
If these outliers are non-representative (obtained due to measurements error or other technical mistakes; gross errors),
we should completely ignore them or reconsider the way we collect the data.
Moreover, if the median itself is corrupted, estimating the deviation around the median is meaningless.
If these outliers are representative (actually describe the true nature of the underlying model),
we should treat them as a part of the distribution.</p><p>While 0.5 is the highest breakdown point for a scale estimator, it is not necessarily the optimal one.
Let us consider a situation when 49% of a sample is contaminated by outliers.
The <span class="math inline">\(\MAD\)</span> could handle such a situation and provide a non-corrupted estimation.
But do we really want to use <span class="math inline">\(\MAD\)</span> in such a situation?
If 49% of sample elements are outliers, do we really want to consider them as outliers?
At some moment, it makes sense to consider them as an essential part of a distribution.
Probably the distribution is multimodal, and it makes sense to consider each mode separately.
Anyway, a single <span class="math inline">\(\MAD\)</span> value can be quite misleading in such a situation.</p><p>Now let us say that we have learned to detect samples with a significant number of outliers to analyze them
using a dedicated approach.
In this case, we do not really need the 0.5 breakdown point.
This means that we can trade some robustness for statistical efficiency.
The next reasonable question is how to choose the optimal breakdown point.</p><h3 id=choosing-the-breakdown-point>Choosing the breakdown point</h3><p>Let us recall the density plot of the normal distribution:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/sqad/img/normal-light.png target=_blank alt=normal><img src=/posts/sqad/img/normal-light.png width=800></a>
<a class="img-dark hidden" href=/posts/sqad/img/normal-dark.png target=_blank alt=normal><img src=/posts/sqad/img/normal-dark.png width=800></a></div><p>The <span class="math inline">\(\MAD\)</span> and other measures of dispersion are often used as consistency estimators for the standard deviation.
The idea is simple: we estimate the <span class="math inline">\(\MAD\)</span>, multiply it by a scale constant and get the standard deviation.
It works well when the distribution is continuous, light-tailed, unimodal,
and with only slight deviations from normality.
In this case, we typically assume that the interval <span class="math inline">\([\mu-\sigma; \mu+\sigma]\)</span> is not so distorted
compared to the normal distribution.
This assumption is violated if some elements of <span class="math inline">\([\mu-\sigma; \mu+\sigma]\)</span> are corrupted.
Let us consider the &ldquo;protection&rdquo; of this interval as a reference condition for choosing the breakdown point.
For the normal distribution, <span class="math inline">\([\mu-\sigma; \mu+\sigma]\)</span> covers exactly
<span class="math inline">\(\Phi(1)-\Phi(-1) = 2\Phi(1) - 1 \approx 0.6827 = 68.27\%\)</span> of the distribution.
It gives us a breakdown point which is equal to <span class="math inline">\(1 - (\Phi(1)-\Phi(-1)) \approx 0.3173 = 31.73\%\)</span>.
It could be interpreted as follows: if less than one-third of the distribution is contaminated, we are in the safe zone:
the scale estimations are not corrupted.
If more than one-third of the distribution is contaminated, we should split the distribution into several modes
and analyze each mode independently.
The breakdown point of <span class="math inline">\(37.73\%\)</span> looks like an admissible value.</p><h3 id=the-standard-quantile-absolute-deviation>The standard quantile absolute deviation</h3><p>Since we have the desired asymptotic breakdown point, we can define the corresponding measure of scale using <span class="math inline">\(\QAD\)</span>.
Let us denote it by the <em>standard quantile absolute deviation</em> or <span class="math inline">\(\SQAD\)</span>.
Asymptotically, it can be defined as follows:</p><p><span class="math display">\[\SQAD(X) = \QAD(X, 2\Phi(1) - 1).
\]</span></p><p>There is no need to introduce a scale constant:
the asymptotic expected value of <span class="math inline">\(\SQAD\)</span> for the normal distribution is 1
(since the sample quantile are Fisher-consistent for the distribution quantiles when <span class="math inline">\(f(p)>0\)</span> (see Theorem 8.5.1 in <a href=#Arnold2008>[Arnold2008]</a>),
<span class="math inline">\(\SQAD\)</span> is Fisher-consistent for the standard deviation):</p><p><span class="math display">\[\E[\SQAD(X)] = \E[\QAD(X, 2\Phi(1) - 1)] = \E[Q(|X|, 2\Phi(1) - 1)] = 1.
\]</span></p><p>If we want to make <span class="math inline">\(\SQAD\)</span> an unbiased estimator for <span class="math inline">\(\SD\)</span> under normality,
we have to introduce the bias-correction factor <span class="math inline">\(C_n\)</span>:</p><p><span class="math display">\[\SQAD_n(X) = C_n \cdot \QAD(X, 2\Phi(1) - 1).
\]</span></p><p>The factor values can be easily obtained using Monte-Carlo simulations.
Here is the plot with these values for <span class="math inline">\(n \leq 100\)</span>:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/sqad/img/sqad_factors-light.png target=_blank alt=sqad_factors><img src=/posts/sqad/img/sqad_factors-light.png width=800></a>
<a class="img-dark hidden" href=/posts/sqad/img/sqad_factors-dark.png target=_blank alt=sqad_factors><img src=/posts/sqad/img/sqad_factors-dark.png width=800></a></div><p>And here are the raw factor values:</p><table><thead><tr><th align=right>n</th><th align=right>factor</th></tr></thead><tbody><tr><td align=right>3</td><td align=right>1.35070</td></tr><tr><td align=right>4</td><td align=right>1.37644</td></tr><tr><td align=right>5</td><td align=right>1.18794</td></tr><tr><td align=right>6</td><td align=right>1.17720</td></tr><tr><td align=right>7</td><td align=right>1.12869</td></tr><tr><td align=right>8</td><td align=right>1.12460</td></tr><tr><td align=right>9</td><td align=right>1.09191</td></tr><tr><td align=right>10</td><td align=right>1.09434</td></tr><tr><td align=right>11</td><td align=right>1.07640</td></tr><tr><td align=right>12</td><td align=right>1.07376</td></tr><tr><td align=right>13</td><td align=right>1.06312</td></tr><tr><td align=right>14</td><td align=right>1.06379</td></tr><tr><td align=right>15</td><td align=right>1.05354</td></tr><tr><td align=right>16</td><td align=right>1.05383</td></tr><tr><td align=right>17</td><td align=right>1.04811</td></tr><tr><td align=right>18</td><td align=right>1.04673</td></tr><tr><td align=right>19</td><td align=right>1.04203</td></tr><tr><td align=right>20</td><td align=right>1.04285</td></tr><tr><td align=right>21</td><td align=right>1.03765</td></tr><tr><td align=right>22</td><td align=right>1.03745</td></tr><tr><td align=right>23</td><td align=right>1.03516</td></tr><tr><td align=right>24</td><td align=right>1.03428</td></tr><tr><td align=right>25</td><td align=right>1.03139</td></tr><tr><td align=right>26</td><td align=right>1.03192</td></tr><tr><td align=right>27</td><td align=right>1.02910</td></tr><tr><td align=right>28</td><td align=right>1.02915</td></tr><tr><td align=right>29</td><td align=right>1.02715</td></tr><tr><td align=right>30</td><td align=right>1.02712</td></tr><tr><td align=right>31</td><td align=right>1.02504</td></tr><tr><td align=right>32</td><td align=right>1.02533</td></tr><tr><td align=right>33</td><td align=right>1.02376</td></tr><tr><td align=right>34</td><td align=right>1.02346</td></tr><tr><td align=right>35</td><td align=right>1.02234</td></tr><tr><td align=right>36</td><td align=right>1.02257</td></tr><tr><td align=right>37</td><td align=right>1.02110</td></tr><tr><td align=right>38</td><td align=right>1.02097</td></tr><tr><td align=right>39</td><td align=right>1.02011</td></tr><tr><td align=right>40</td><td align=right>1.01985</td></tr><tr><td align=right>41</td><td align=right>1.01890</td></tr><tr><td align=right>42</td><td align=right>1.01917</td></tr><tr><td align=right>43</td><td align=right>1.01806</td></tr><tr><td align=right>44</td><td align=right>1.01800</td></tr><tr><td align=right>45</td><td align=right>1.01735</td></tr><tr><td align=right>46</td><td align=right>1.01722</td></tr><tr><td align=right>47</td><td align=right>1.01654</td></tr><tr><td align=right>48</td><td align=right>1.01655</td></tr><tr><td align=right>49</td><td align=right>1.01577</td></tr><tr><td align=right>50</td><td align=right>1.01577</td></tr><tr><td align=right>51</td><td align=right>1.01518</td></tr><tr><td align=right>52</td><td align=right>1.01524</td></tr><tr><td align=right>53</td><td align=right>1.01466</td></tr><tr><td align=right>54</td><td align=right>1.01458</td></tr><tr><td align=right>55</td><td align=right>1.01413</td></tr><tr><td align=right>56</td><td align=right>1.01404</td></tr><tr><td align=right>57</td><td align=right>1.01347</td></tr><tr><td align=right>58</td><td align=right>1.01369</td></tr><tr><td align=right>59</td><td align=right>1.01299</td></tr><tr><td align=right>60</td><td align=right>1.01310</td></tr><tr><td align=right>61</td><td align=right>1.01286</td></tr><tr><td align=right>62</td><td align=right>1.01258</td></tr><tr><td align=right>63</td><td align=right>1.01230</td></tr><tr><td align=right>64</td><td align=right>1.01237</td></tr><tr><td align=right>65</td><td align=right>1.01183</td></tr><tr><td align=right>66</td><td align=right>1.01194</td></tr><tr><td align=right>67</td><td align=right>1.01151</td></tr><tr><td align=right>68</td><td align=right>1.01145</td></tr><tr><td align=right>69</td><td align=right>1.01109</td></tr><tr><td align=right>70</td><td align=right>1.01120</td></tr><tr><td align=right>71</td><td align=right>1.01082</td></tr><tr><td align=right>72</td><td align=right>1.01089</td></tr><tr><td align=right>73</td><td align=right>1.01065</td></tr><tr><td align=right>74</td><td align=right>1.01056</td></tr><tr><td align=right>75</td><td align=right>1.01019</td></tr><tr><td align=right>76</td><td align=right>1.01023</td></tr><tr><td align=right>77</td><td align=right>1.01006</td></tr><tr><td align=right>78</td><td align=right>1.00999</td></tr><tr><td align=right>79</td><td align=right>1.00973</td></tr><tr><td align=right>80</td><td align=right>1.00977</td></tr><tr><td align=right>81</td><td align=right>1.00945</td></tr><tr><td align=right>82</td><td align=right>1.00949</td></tr><tr><td align=right>83</td><td align=right>1.00926</td></tr><tr><td align=right>84</td><td align=right>1.00923</td></tr><tr><td align=right>85</td><td align=right>1.00905</td></tr><tr><td align=right>86</td><td align=right>1.00903</td></tr><tr><td align=right>87</td><td align=right>1.00888</td></tr><tr><td align=right>88</td><td align=right>1.00879</td></tr><tr><td align=right>89</td><td align=right>1.00862</td></tr><tr><td align=right>90</td><td align=right>1.00864</td></tr><tr><td align=right>91</td><td align=right>1.00845</td></tr><tr><td align=right>92</td><td align=right>1.00843</td></tr><tr><td align=right>93</td><td align=right>1.00819</td></tr><tr><td align=right>94</td><td align=right>1.00821</td></tr><tr><td align=right>95</td><td align=right>1.00813</td></tr><tr><td align=right>96</td><td align=right>1.00820</td></tr><tr><td align=right>97</td><td align=right>1.00780</td></tr><tr><td align=right>98</td><td align=right>1.00789</td></tr><tr><td align=right>99</td><td align=right>1.00776</td></tr><tr><td align=right>100</td><td align=right>1.00778</td></tr><tr><td align=right>109</td><td align=right>1.00700</td></tr><tr><td align=right>110</td><td align=right>1.00698</td></tr><tr><td align=right>119</td><td align=right>1.00643</td></tr><tr><td align=right>120</td><td align=right>1.00642</td></tr><tr><td align=right>129</td><td align=right>1.00585</td></tr><tr><td align=right>130</td><td align=right>1.00597</td></tr><tr><td align=right>139</td><td align=right>1.00550</td></tr><tr><td align=right>140</td><td align=right>1.00557</td></tr><tr><td align=right>149</td><td align=right>1.00516</td></tr><tr><td align=right>150</td><td align=right>1.00514</td></tr><tr><td align=right>159</td><td align=right>1.00484</td></tr><tr><td align=right>160</td><td align=right>1.00479</td></tr><tr><td align=right>169</td><td align=right>1.00452</td></tr><tr><td align=right>170</td><td align=right>1.00460</td></tr><tr><td align=right>179</td><td align=right>1.00429</td></tr><tr><td align=right>180</td><td align=right>1.00426</td></tr><tr><td align=right>189</td><td align=right>1.00401</td></tr><tr><td align=right>190</td><td align=right>1.00406</td></tr><tr><td align=right>199</td><td align=right>1.00378</td></tr><tr><td align=right>200</td><td align=right>1.00381</td></tr><tr><td align=right>249</td><td align=right>1.00307</td></tr><tr><td align=right>250</td><td align=right>1.00307</td></tr><tr><td align=right>299</td><td align=right>1.00258</td></tr><tr><td align=right>300</td><td align=right>1.00259</td></tr><tr><td align=right>349</td><td align=right>1.00219</td></tr><tr><td align=right>350</td><td align=right>1.00219</td></tr><tr><td align=right>399</td><td align=right>1.00192</td></tr><tr><td align=right>400</td><td align=right>1.00190</td></tr><tr><td align=right>449</td><td align=right>1.00173</td></tr><tr><td align=right>450</td><td align=right>1.00168</td></tr><tr><td align=right>499</td><td align=right>1.00151</td></tr><tr><td align=right>500</td><td align=right>1.00152</td></tr><tr><td align=right>600</td><td align=right>1.00126</td></tr><tr><td align=right>700</td><td align=right>1.00109</td></tr><tr><td align=right>800</td><td align=right>1.00094</td></tr><tr><td align=right>900</td><td align=right>1.00086</td></tr><tr><td align=right>1000</td><td align=right>1.00076</td></tr><tr><td align=right>1500</td><td align=right>1.00050</td></tr><tr><td align=right>2000</td><td align=right>1.00038</td></tr><tr><td align=right>3000</td><td align=right>1.00026</td></tr></tbody></table><p>For <span class="math inline">\(n>100\)</span>, we can use the following prediction equation (obtained using least squares):</p><p><span class="math display">\[C_n = 1 + 0.762 n +0.868 n^2.
\]</span></p><p>This equation perfectly matches the existing estimations:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/sqad/img/sqad_factors2-light.png target=_blank alt=sqad_factors2><img src=/posts/sqad/img/sqad_factors2-light.png width=800></a>
<a class="img-dark hidden" href=/posts/sqad/img/sqad_factors2-dark.png target=_blank alt=sqad_factors2><img src=/posts/sqad/img/sqad_factors2-dark.png width=800></a></div><h3 id=the-statistical-efficiency-of-sqad-and-mad>The statistical efficiency of SQAD and MAD</h3><p>We perform one more simulation study to evaluate the Gaussian efficiency of <span class="math inline">\(\SQAD\)</span> and <span class="math inline">\(\MAD\)</span>.
As for the baseline, we consider the unbiased standard deviation <span class="math inline">\(\SD_n\)</span>:</p><p><span class="math display">\[\SD_n(X) = \sqrt{\frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})^2} \bigg/ c_4(n), \quad
c_4(n) = \sqrt{\frac{2}{n-1}}\frac{\Gamma(\frac{n}{2})}{\Gamma(\frac{n-1}{2})}.
\]</span></p><p>The scheme of this simulation is straightforward: for each sample size <span class="math inline">\(n\)</span>,
we generate multiple random samples of the given size from the standard normal distribution.
For an unbiased scale estimator <span class="math inline">\(T_n\)</span>, we define the Gaussian efficiency as</p><p><span class="math display">\[e(T_n) = \frac{\V[\SD_n]}{\V[T_n]}.
\]</span></p><p>Here is the plot of the efficiency values for <span class="math inline">\(n \leq 100\)</span>:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/sqad/img/efficiency100-light.png target=_blank alt=efficiency100><img src=/posts/sqad/img/efficiency100-light.png width=800></a>
<a class="img-dark hidden" href=/posts/sqad/img/efficiency100-dark.png target=_blank alt=efficiency100><img src=/posts/sqad/img/efficiency100-dark.png width=800></a></div><p>And here is the raw efficiency values (including the obtained biases and the standardized variance values):</p><table><thead><tr><th align=right>n</th><th align=right>eff.mad</th><th align=right>eff.sqad</th></tr></thead><tbody><tr><td align=right>3</td><td align=right>0.40085</td><td align=right>0.92931</td></tr><tr><td align=right>4</td><td align=right>0.54596</td><td align=right>0.61559</td></tr><tr><td align=right>5</td><td align=right>0.38562</td><td align=right>0.64954</td></tr><tr><td align=right>6</td><td align=right>0.46252</td><td align=right>0.67588</td></tr><tr><td align=right>7</td><td align=right>0.37846</td><td align=right>0.58748</td></tr><tr><td align=right>8</td><td align=right>0.43354</td><td align=right>0.59877</td></tr><tr><td align=right>9</td><td align=right>0.37588</td><td align=right>0.62040</td></tr><tr><td align=right>10</td><td align=right>0.41818</td><td align=right>0.58368</td></tr><tr><td align=right>11</td><td align=right>0.37429</td><td align=right>0.57532</td></tr><tr><td align=right>12</td><td align=right>0.40784</td><td align=right>0.60043</td></tr><tr><td align=right>13</td><td align=right>0.37305</td><td align=right>0.57759</td></tr><tr><td align=right>14</td><td align=right>0.40263</td><td align=right>0.56445</td></tr><tr><td align=right>15</td><td align=right>0.37202</td><td align=right>0.58536</td></tr><tr><td align=right>16</td><td align=right>0.39787</td><td align=right>0.57645</td></tr><tr><td align=right>17</td><td align=right>0.37180</td><td align=right>0.55338</td></tr><tr><td align=right>18</td><td align=right>0.39328</td><td align=right>0.57663</td></tr><tr><td align=right>19</td><td align=right>0.37113</td><td align=right>0.57120</td></tr><tr><td align=right>20</td><td align=right>0.39053</td><td align=right>0.54768</td></tr><tr><td align=right>21</td><td align=right>0.37051</td><td align=right>0.56875</td></tr><tr><td align=right>22</td><td align=right>0.38851</td><td align=right>0.56950</td></tr><tr><td align=right>23</td><td align=right>0.37061</td><td align=right>0.54519</td></tr><tr><td align=right>24</td><td align=right>0.38686</td><td align=right>0.56315</td></tr><tr><td align=right>25</td><td align=right>0.36999</td><td align=right>0.56659</td></tr><tr><td align=right>26</td><td align=right>0.38448</td><td align=right>0.54974</td></tr><tr><td align=right>27</td><td align=right>0.37002</td><td align=right>0.55883</td></tr><tr><td align=right>28</td><td align=right>0.38386</td><td align=right>0.56476</td></tr><tr><td align=right>29</td><td align=right>0.36996</td><td align=right>0.55093</td></tr><tr><td align=right>30</td><td align=right>0.38231</td><td align=right>0.55479</td></tr><tr><td align=right>31</td><td align=right>0.36968</td><td align=right>0.56303</td></tr><tr><td align=right>32</td><td align=right>0.38174</td><td align=right>0.55344</td></tr><tr><td align=right>33</td><td align=right>0.36925</td><td align=right>0.55094</td></tr><tr><td align=right>34</td><td align=right>0.38118</td><td align=right>0.56029</td></tr><tr><td align=right>35</td><td align=right>0.36908</td><td align=right>0.55418</td></tr><tr><td align=right>36</td><td align=right>0.37986</td><td align=right>0.54853</td></tr><tr><td align=right>37</td><td align=right>0.36925</td><td align=right>0.55809</td></tr><tr><td align=right>38</td><td align=right>0.37960</td><td align=right>0.55573</td></tr><tr><td align=right>39</td><td align=right>0.36926</td><td align=right>0.54442</td></tr><tr><td align=right>40</td><td align=right>0.37839</td><td align=right>0.55552</td></tr><tr><td align=right>41</td><td align=right>0.36904</td><td align=right>0.55548</td></tr><tr><td align=right>42</td><td align=right>0.37812</td><td align=right>0.54209</td></tr><tr><td align=right>43</td><td align=right>0.36856</td><td align=right>0.55365</td></tr><tr><td align=right>44</td><td align=right>0.37729</td><td align=right>0.55472</td></tr><tr><td align=right>45</td><td align=right>0.36934</td><td align=right>0.54509</td></tr><tr><td align=right>46</td><td align=right>0.37655</td><td align=right>0.55243</td></tr><tr><td align=right>47</td><td align=right>0.37010</td><td align=right>0.55612</td></tr><tr><td align=right>48</td><td align=right>0.37746</td><td align=right>0.54628</td></tr><tr><td align=right>49</td><td align=right>0.36910</td><td align=right>0.55126</td></tr><tr><td align=right>50</td><td align=right>0.37615</td><td align=right>0.55376</td></tr><tr><td align=right>51</td><td align=right>0.36922</td><td align=right>0.54797</td></tr><tr><td align=right>52</td><td align=right>0.37519</td><td align=right>0.54783</td></tr><tr><td align=right>53</td><td align=right>0.36956</td><td align=right>0.55422</td></tr><tr><td align=right>54</td><td align=right>0.37582</td><td align=right>0.54860</td></tr><tr><td align=right>55</td><td align=right>0.36941</td><td align=right>0.54726</td></tr><tr><td align=right>56</td><td align=right>0.37536</td><td align=right>0.55278</td></tr><tr><td align=right>57</td><td align=right>0.36917</td><td align=right>0.54985</td></tr><tr><td align=right>58</td><td align=right>0.37500</td><td align=right>0.54461</td></tr><tr><td align=right>59</td><td align=right>0.36867</td><td align=right>0.55163</td></tr><tr><td align=right>60</td><td align=right>0.37506</td><td align=right>0.55015</td></tr><tr><td align=right>61</td><td align=right>0.36870</td><td align=right>0.54308</td></tr><tr><td align=right>62</td><td align=right>0.37489</td><td align=right>0.55133</td></tr><tr><td align=right>63</td><td align=right>0.36841</td><td align=right>0.54997</td></tr><tr><td align=right>64</td><td align=right>0.37435</td><td align=right>0.54182</td></tr><tr><td align=right>65</td><td align=right>0.36894</td><td align=right>0.55011</td></tr><tr><td align=right>66</td><td align=right>0.37401</td><td align=right>0.54976</td></tr><tr><td align=right>67</td><td align=right>0.36843</td><td align=right>0.54372</td></tr><tr><td align=right>68</td><td align=right>0.37368</td><td align=right>0.54816</td></tr><tr><td align=right>69</td><td align=right>0.36877</td><td align=right>0.54995</td></tr><tr><td align=right>70</td><td align=right>0.37373</td><td align=right>0.54550</td></tr><tr><td align=right>71</td><td align=right>0.36787</td><td align=right>0.54635</td></tr><tr><td align=right>72</td><td align=right>0.37420</td><td align=right>0.55036</td></tr><tr><td align=right>73</td><td align=right>0.36872</td><td align=right>0.54567</td></tr><tr><td align=right>74</td><td align=right>0.37385</td><td align=right>0.54617</td></tr><tr><td align=right>75</td><td align=right>0.36847</td><td align=right>0.54970</td></tr><tr><td align=right>76</td><td align=right>0.37425</td><td align=right>0.54679</td></tr><tr><td align=right>77</td><td align=right>0.36892</td><td align=right>0.54448</td></tr><tr><td align=right>78</td><td align=right>0.37262</td><td align=right>0.54791</td></tr><tr><td align=right>79</td><td align=right>0.36825</td><td align=right>0.54709</td></tr><tr><td align=right>80</td><td align=right>0.37277</td><td align=right>0.54329</td></tr><tr><td align=right>81</td><td align=right>0.36844</td><td align=right>0.54902</td></tr><tr><td align=right>82</td><td align=right>0.37253</td><td align=right>0.54649</td></tr><tr><td align=right>83</td><td align=right>0.36827</td><td align=right>0.54142</td></tr><tr><td align=right>84</td><td align=right>0.37260</td><td align=right>0.54621</td></tr><tr><td align=right>85</td><td align=right>0.36851</td><td align=right>0.54788</td></tr><tr><td align=right>86</td><td align=right>0.37232</td><td align=right>0.54154</td></tr><tr><td align=right>87</td><td align=right>0.36828</td><td align=right>0.54736</td></tr><tr><td align=right>88</td><td align=right>0.37260</td><td align=right>0.54789</td></tr><tr><td align=right>89</td><td align=right>0.36819</td><td align=right>0.54330</td></tr><tr><td align=right>90</td><td align=right>0.37219</td><td align=right>0.54570</td></tr><tr><td align=right>91</td><td align=right>0.36857</td><td align=right>0.54809</td></tr><tr><td align=right>92</td><td align=right>0.37199</td><td align=right>0.54407</td></tr><tr><td align=right>93</td><td align=right>0.36819</td><td align=right>0.54459</td></tr><tr><td align=right>94</td><td align=right>0.37212</td><td align=right>0.54758</td></tr><tr><td align=right>95</td><td align=right>0.36929</td><td align=right>0.54554</td></tr><tr><td align=right>96</td><td align=right>0.37203</td><td align=right>0.54423</td></tr><tr><td align=right>97</td><td align=right>0.36895</td><td align=right>0.54764</td></tr><tr><td align=right>98</td><td align=right>0.37204</td><td align=right>0.54546</td></tr><tr><td align=right>99</td><td align=right>0.36833</td><td align=right>0.54300</td></tr><tr><td align=right>100</td><td align=right>0.37240</td><td align=right>0.54883</td></tr><tr><td align=right>109</td><td align=right>0.36846</td><td align=right>0.54636</td></tr><tr><td align=right>110</td><td align=right>0.37218</td><td align=right>0.54689</td></tr><tr><td align=right>119</td><td align=right>0.36797</td><td align=right>0.54649</td></tr><tr><td align=right>120</td><td align=right>0.37157</td><td align=right>0.54510</td></tr><tr><td align=right>129</td><td align=right>0.36793</td><td align=right>0.54593</td></tr><tr><td align=right>130</td><td align=right>0.37119</td><td align=right>0.54175</td></tr><tr><td align=right>139</td><td align=right>0.36784</td><td align=right>0.54373</td></tr><tr><td align=right>140</td><td align=right>0.37056</td><td align=right>0.54266</td></tr><tr><td align=right>149</td><td align=right>0.36879</td><td align=right>0.54139</td></tr><tr><td align=right>150</td><td align=right>0.37090</td><td align=right>0.54441</td></tr><tr><td align=right>159</td><td align=right>0.36752</td><td align=right>0.54201</td></tr><tr><td align=right>160</td><td align=right>0.37026</td><td align=right>0.54493</td></tr><tr><td align=right>169</td><td align=right>0.36796</td><td align=right>0.54429</td></tr><tr><td align=right>170</td><td align=right>0.37005</td><td align=right>0.54434</td></tr><tr><td align=right>179</td><td align=right>0.36794</td><td align=right>0.54417</td></tr><tr><td align=right>180</td><td align=right>0.37034</td><td align=right>0.54388</td></tr><tr><td align=right>189</td><td align=right>0.36822</td><td align=right>0.54427</td></tr><tr><td align=right>190</td><td align=right>0.36989</td><td align=right>0.54206</td></tr><tr><td align=right>199</td><td align=right>0.36770</td><td align=right>0.54290</td></tr><tr><td align=right>200</td><td align=right>0.36926</td><td align=right>0.54206</td></tr><tr><td align=right>249</td><td align=right>0.36793</td><td align=right>0.54262</td></tr><tr><td align=right>250</td><td align=right>0.36917</td><td align=right>0.54152</td></tr><tr><td align=right>299</td><td align=right>0.36802</td><td align=right>0.54363</td></tr><tr><td align=right>300</td><td align=right>0.36926</td><td align=right>0.54122</td></tr><tr><td align=right>349</td><td align=right>0.36763</td><td align=right>0.54216</td></tr><tr><td align=right>350</td><td align=right>0.36865</td><td align=right>0.54212</td></tr><tr><td align=right>399</td><td align=right>0.36709</td><td align=right>0.54143</td></tr><tr><td align=right>400</td><td align=right>0.36864</td><td align=right>0.54230</td></tr><tr><td align=right>449</td><td align=right>0.36743</td><td align=right>0.54104</td></tr><tr><td align=right>450</td><td align=right>0.36892</td><td align=right>0.54312</td></tr><tr><td align=right>499</td><td align=right>0.36719</td><td align=right>0.53987</td></tr><tr><td align=right>500</td><td align=right>0.36840</td><td align=right>0.54189</td></tr><tr><td align=right>600</td><td align=right>0.36851</td><td align=right>0.54134</td></tr><tr><td align=right>700</td><td align=right>0.36897</td><td align=right>0.54134</td></tr><tr><td align=right>800</td><td align=right>0.36744</td><td align=right>0.54142</td></tr><tr><td align=right>900</td><td align=right>0.36934</td><td align=right>0.54187</td></tr><tr><td align=right>1000</td><td align=right>0.36741</td><td align=right>0.53976</td></tr><tr><td align=right>1500</td><td align=right>0.36821</td><td align=right>0.54124</td></tr><tr><td align=right>2000</td><td align=right>0.36836</td><td align=right>0.54144</td></tr><tr><td align=right>3000</td><td align=right>0.36810</td><td align=right>0.54149</td></tr><tr><td align=right>10000</td><td align=right>0.36782</td><td align=right>0.54066</td></tr><tr><td align=right>50000</td><td align=right>0.36810</td><td align=right>0.54080</td></tr></tbody></table><p>According to this simulation study, the Gaussian efficiency of <span class="math inline">\(\SQAD\)</span> is <span class="math inline">\(\approx 54\%\)</span>.</p><h3 id=asymptotic-efficiency-of-sqad>Asymptotic efficiency of SQAD</h3><p>We already <a href=https://aakinshin.net/posts/qad-are/>know</a> the equation for the Gaussian efficiency of <span class="math inline">\(\QAD\)</span>:</p><p><span class="math display">\[\lim_{n \to \infty} e(\QAD_n(X, p),\; \SD_n(X)) =
\Bigg( \pi p(1-p) \exp\Big(2\big(\erfinv(p) \big)^2 \Big) \Bigg)^{-1}.
\]</span></p><p>To adopt this equation for <span class="math inline">\(\SQAD\)</span>, we should put <span class="math inline">\(p = \Phi(1) - \Phi(-1)\)</span>.</p><p>Since <span class="math inline">\(\Phi(1) = (1 + \erf(1/\sqrt{2})) / 2\)</span>, we can write</p><p><span class="math display">\[\erf(1/\sqrt{2}) = 2\Phi(1) - 1 = \Phi(1) - \Phi(-1),
\]</span></p><p>which is the same as</p><p><span class="math display">\[2\Big(\erfinv(\Phi(1) - \Phi(-1)) \Big)^2 = 1.
\]</span></p><p>This gives us a simple expression for the Gaussian efficiency of <span class="math inline">\(\SQAD_n(X)\)</span>:</p><p><span class="math display">\[\lim_{n \to \infty} e(\SQAD_n(X),\; \SD_n(X)) =
\Big( \pi e \cdot (\Phi(1)-\Phi(-1)) \cdot (1-\Phi(1)+\Phi(-1)) \Big)^{-1}
\approx 0.540565.
\]</span></p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/sqad/img/efficiency-light.png target=_blank alt=efficiency><img src=/posts/sqad/img/efficiency-light.png width=800></a>
<a class="img-dark hidden" href=/posts/sqad/img/efficiency-dark.png target=_blank alt=efficiency><img src=/posts/sqad/img/efficiency-dark.png width=800></a></div><h3 id=summary>Summary</h3><p>In this post, we discussed a new measure of statistical dispersion
called the standard quantile absolute deviation (<span class="math inline">\(\SQAD\)</span>)
which is consistent with the standard deviation under normality.
Its breakdown point is <span class="math inline">\(\approx 31.73\%\)</span>.
When such robustness is enough, <span class="math inline">\(\SQAD\)</span> can be a decent replacement for the median absolute deviation
because it has higher statistical efficiency (<span class="math inline">\(\approx 54\%\)</span>).</p><h3 id=references>References</h3><ul><li><b id=Hyndman1996>[Hyndman1996]</b><br>Hyndman, R. J. and Fan, Y. 1996. Sample quantiles in statistical packages, <em>American Statistician</em> 50, 361–365.<br><a href=https://doi.org/10.2307/2684934>https://doi.org/10.2307/2684934</a></li><li><b id=Harrell1982>[Harrell1982]</b><br>Harrell, F.E. and Davis, C.E., 1982. A new distribution-free quantile estimator.
<em>Biometrika</em>, 69(3), pp.635-640.<br><a href=https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf>https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf</a></li><li><b id=Akinshin2022>[Akinshin2022]</b><br>Andrey Akinshin (2022)
Trimmed Harrell-Davis quantile estimator based on the highest density interval of the given width,
Communications in Statistics - Simulation and Computation.<br><a href=https://doi.org/10.1080/03610918.2022.2050396>https://doi.org/10.1080/03610918.2022.2050396</a></li><li><b id=Arnold2008>[Arnold2008]</b><br>Arnold, Barry C., N. Balakrishnan, and H. N. Nagaraja.
A First Course in Order Statistics. Classics in Applied Mathematics 54. Philadelphia, PA: SIAM, 2008.</li></ul></div><br><br><div class="flex flex-wrap justify-center items-center">The source code of this post and all the relevant files are&nbsp;<a href=https://github.com/AndreyAkinshin/aakinshin.net/tree/master/content/en/posts/2022/08/sqad/index.md>available on GitHub</a>.</div><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fsqad%2f&title=Standard%20quantile%20absolute%20deviation" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Standard%20quantile%20absolute%20deviation&url=https%3a%2f%2faakinshin.net%2fposts%2fsqad%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fsqad%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fsqad%2f&title=Standard%20quantile%20absolute%20deviation" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2023 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>