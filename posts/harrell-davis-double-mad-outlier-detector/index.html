<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.3"><meta name=author content='Andrey Akinshin'><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content='Mathematics,Research,Statistics,Outliers,Median Absolute Deviation,Harrell-Davis'><title>DoubleMAD outlier detector based on the Harrell-Davis quantile estimator | Andrey Akinshin</title>
<meta name=description content="Outlier detection is an important step in data processing. Unfortunately, if the distribution is not normal (e.g., right-skewed and heavy-tailed), it&amp;rsquo;s hard to choose a robust outlier detection algorithm that will not be affected by tricky distributio..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.a032e875598f97999dcca4aec47ea745e5896949ccc57dfcd01331a89561c222.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-2 xs:px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>DoubleMAD outlier detector based on the Harrell-Davis quantile estimator</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2020-06-22>June 22, 2020</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/outliers/>Outliers</a>
<a class=label-link href=https://aakinshin.net/tags/mad/>Median Absolute Deviation</a>
<a class=label-link href=https://aakinshin.net/tags/harrell-davis/>Harrell-Davis</a></div></div><br><div class=main-content><p>Outlier detection is an important step in data processing.
Unfortunately, if the distribution is not normal (e.g., right-skewed and heavy-tailed), it&rsquo;s hard to choose
a robust outlier detection algorithm that will not be affected by tricky distribution properties.
During the last several years, I tried many different approaches, but I was not satisfied with their results.
Finally, I found an algorithm to which I have (almost) no complaints.
It&rsquo;s based on the <em>double median absolute deviation</em> and the <em>Harrell-Davis quantile estimator</em>.
In this post, I will show how it works and why it&rsquo;s better than some other approaches.</p><h3 id=adopting-to-non-parametric-distributions-with-mad>Adopting to non-parametric distributions with MAD</h3><p>In the world of normal distributions, the typical approach for outlier detection is based on <em>the standard deviation</em>.
It uses the following thresholds for the outliers:</p>$$
\textrm{Lower} = \textrm{Mean} - k \cdot \textrm{StdDev}, \quad
\textrm{Upper} = \textrm{Mean} + k \cdot \textrm{StdDev}, \quad
k_{\textrm{default}} = 3.
$$<p>With these thresholds, we mark all the values outside the $ [ \textrm{Lower}; \textrm{Upper} ] $ range as outliers.
Unfortunately, this approach doesn&rsquo;t work well when the distribution is not normal.</p><p>In the world of non-parametric distributions, there is another popular approach called <em>Tukey&rsquo;s fences</em> (<a href=/posts/harrell-davis-double-mad-outlier-detector/#Tukey1997>[Tukey1997]</a>).
It defines outlier thresholds as follows:</p>$$
\textrm{Lower} = Q_1 - k \cdot \textrm{IQR}, \quad
\textrm{Upper} = Q_3 + k \cdot \textrm{IQR}, \quad
k_{\textrm{default}} = 1.5,
$$<p>where $ \textrm{IQR} = Q_3 - Q_1 $ is the interquartile range.
It works well, but it&rsquo;s not robust enough because it&rsquo;s defined only be quartile values $ Q_1 $ and $ Q_3 $.
These quartile values are calculated based on a few sample values and ignore the rest of the sample.</p><p>To resolve this problem, we can use a more robust measure of statistical dispersion called <em>the median absolute deviation (MAD)</em> (<a href=/posts/harrell-davis-double-mad-outlier-detector/#Leys2013>[Leys2013]</a>).
For the sample $ X = \{ X_1, X_2, \ldots, X_n \} $, it can be defined as follows:</p>$$
\textrm{MAD} = C \cdot \textrm{median}(|X_i - \textrm{median}(X)|).
$$<p>For the normally distributed values, there is a well-known relationship between the standard deviation and the median absolute deviation:</p>$$
\textrm{StdDev} \approx 1.4826 \cdot \textrm{median}(|X_i - \textrm{median}(X)|).
$$<p>Thus, we can use $ C = 1.4826 $ (which is also known as <em>the consistency constant</em>) to make $ \textrm{MAD} $ a consistent estimator for the standard deviation estimation.
With the MAD approach, we can define the outlier thresholds as follows:</p>$$
\textrm{Lower} = \textrm{Median} - k \cdot \textrm{MAD}, \quad
\textrm{Upper} = \textrm{Median} + k \cdot \textrm{MAD}, \quad
k_{\textrm{default}} = 3.
$$<p>In the case of the normal distribution, it works the same way as the standard deviation approach.
Meanwhile, it detects outliers in non-parametric distributions much better.
Also, it&rsquo;s more robust than Tukey&rsquo;s fences because it respects all values from the given sample.</p><p>According to <a href=/posts/harrell-davis-double-mad-outlier-detector/#Yang2019>[Yang2019]</a>, MAD is not inferior in popularity to the Tukey&rsquo;s fences in recent scientific publications.</p><h3 id=adopting-to-nonsymmetric-distributions-with-double-mad>Adopting to nonsymmetric distributions with Double MAD</h3><p>The classic MAD approach defines a symmetric interval around the median.
This does not work great for the left-skewed, right-skewed, and other kinds of nonsymmetric distributions.
Consider the following sample from a right-skewed distribution: (100, 101, 102, 103, 110, 111, 112, 120, 121, 122, 140, 160, 180, 200, 220, 240, 2000, 2001, 2002).
The obvious outliers are (2000, 2001, 2002).
If we apply the MAD approach, we will get the following numbers:</p>$$
\textrm{Median} = 122, \quad \textrm{MAD} = 31.1346, \quad \textrm{Lower} = 28.5962, \quad \textrm{Upper} = 215.4038.
$$<p>Thus, 220 and 240 will be marked as outliers because they exceed the upper threshold.</p><p>This problem can be resolved with the help of the Double MAD approach (<a href=/posts/harrell-davis-double-mad-outlier-detector/#Rosenmai2013>[Rosenmai2013]</a>).
The idea is simple: for the obtained median value, we should calculate two median absolution deviations.
One deviation should be calculated for the numbers below the median and one for the numbers above the median:</p>$$
M = \textrm{median}(X), \quad
X^{(l)} = \{ x | x \in X \wedge x \leq M \}, \quad
X^{(u)} = \{ x | x \in X \wedge x \geq M \},
$$
$$
\textrm{MAD}^{(l)} = C \cdot \textrm{median}(|X^{(l)}_i - M|), \quad
\textrm{MAD}^{(u)} = C \cdot \textrm{median}(|X^{(u)}_i - M|).
$$<p>Next, we can define outlier thresholds using $ \textrm{MAD}^{(l)} $ for $ \textrm{Lower} $ and $ \textrm{MAD}^{(u)} $ for $ \textrm{Upper} $:</p>$$
\textrm{Lower} = M - k \cdot \textrm{MAD}^{(l)}, \quad \textrm{Upper} = M + k \cdot \textrm{MAD}^{(u)}.
$$<p>For the above example, we have the following values:</p>$$
M = 122, \quad \textrm{MAD}^{(l)} = 17.0499, \quad \textrm{MAD}^{(u)} = 130.4688,
$$
$$
\textrm{Lower} = 70.8503, \quad \textrm{Upper} = 513.4064.
$$<p>Now we mark all values that exceed $ \textrm{Upper} $ as outliers.
In our cases, the outlier set is (2000, 2001, 2002).</p><h3 id=adopting-to-bimodal-distributions-with-the-harrell-davis-quantile-estimator>Adopting to bimodal distributions with the Harrell-Davis quantile estimator</h3><p>The MAD formula involves the median estimation.
Unfortunately, the most common <a href=https://en.wikipedia.org/wiki/Median#Finite_data_set_of_numbers>&ldquo;straightforward&rdquo;</a> approach
to calculate the median value is not always robust enough.
Consider the following sample: (4, 10, 15, 18, 19, 20, 501, 502, 503, 504, 3000).
The straightforward sample median value is 20.</p><p>However, it may not be the best estimation of the population median.
Here we have a bimodal distribution based on two sample subgroups: (4, 10, 15, 18, 19, 20) and (501, 502, 503, 504).
The last sample value 3000 is an outlier.
We got 20 as the median value &ldquo;by chance&rdquo; because the first group contains one number more than the second group with the outlier.
The true median of the population is most likely somewhere between 20 and 501.</p><p>This problem can be resolved with the help of the Harrell-Davis quantile estimator (<a href=/posts/harrell-davis-double-mad-outlier-detector/#Harrell1982>[Harrell1982]</a>).
It defines estimation for th $ p^{\textrm{th}} $ quantile as follows:</p>$$
Q_p = \Sigma_{i=1}^{n} W_{n,i} X_i,
$$
$$
W_{n,i} = I_{i/n} \{p(n+1)), (1-p)(n+1) \} - I_{(i-1)/n} \{ p(n+1), (1-p)(n+1) \},
$$<p>where $ I_x \{ a, b \} $ denotes the <a href=https://en.wikipedia.org/wiki/Beta_function#Incomplete_beta_function>regularized incomplete beta function</a>.
This formula may look scary, but it provides a more robust median estimation than the straightforward approach.
In the above example, the Harrell-Davis estimation is 202.0452.</p><p>Using the MAD approach, we have the following numbers:</p>$$
\textrm{Median} = 20, \quad \textrm{MAD} = 23.7216,
$$
$$
\textrm{Lower} = -51.1648, \quad \textrm{Upper} = 91.1648,
$$
$$
\textrm{Outliers} = \{ 501, 502, 503, 504, 3000 \}.
$$<p>The whole right mode was marked as a set of outliers.
It&rsquo;s not the result that we actually want.</p><p>Using the Double MAD approach, we have:</p>$$
\textrm{Median} = 20, \quad \textrm{MAD}^{(l)} = 5.1891, \quad \textrm{MAD}^{(u)} = 715.3545,
$$
$$
\textrm{Lower} = 4.4327, \quad \textrm{Upper} = 2166.0635,
$$
$$
\textrm{Outliers} = \{ 4, 3000 \}.
$$<p>It looks better: the right mode is not considered as a set of outliers anymore.
However, we have another problem: 4 is marked as an outlier because it&rsquo;s less than the lower threshold.</p><p>Now let&rsquo;s try the Harrell-Davis-powered Double MAD approach:</p>$$
\textrm{Median} = 202.0452, \quad \textrm{MAD}^{(l)} = 276.4030, \quad \textrm{MAD}^{(u)} = 660.4467,
$$
$$
\textrm{Lower} = -627.1638, \quad \textrm{Upper} = 2183.3854,
$$
$$
\textrm{Outliers} = \{ 3000 \}.
$$<p>Hooray, we finally got the correct set of outliers!</p><h3 id=another-example>Another example</h3><p>Let&rsquo;s consider another example that compares different combinations of the discussed approaches.
We take <code>BaseSample</code> from the beta-distribution $ \textrm{Beta}(1, 10) $ multilied by 10000.
Next, we add different combinations of lower or upper outliers and check how the following outlier detector work:</p><ul><li><code>TukeySimple</code>: Tukey&rsquo;s fences with the straightforward quantile estimation</li><li><code>TukeyHd</code>: Tukey&rsquo;s fences with the Harrell-Davis quantile estimation</li><li><code>MadSimple</code>: MAD with the straightforward quantile estimation</li><li><code>MadHd</code>: MAD with the Harrell-Davis quantile estimation</li><li><code>DoubleMadSimple</code>: Double MAD with the straightforward quantile estimation</li><li><code>DoubleMadHd</code>: Double MAD with the Harrell-Davis quantile estimation</li></ul><p>Here are the results:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-md data-lang=md><span class=line><span class=cl>BaseSample = {
</span></span><span class=line><span class=cl>  9, 47, 50, 71, 78, 79, 97, 98, 117, 123,
</span></span><span class=line><span class=cl>  136, 138, 143, 145, 167, 185, 202, 216, 217, 229,
</span></span><span class=line><span class=cl>  235, 242, 257, 297, 300, 315, 344, 347, 347, 360,
</span></span><span class=line><span class=cl>  362, 368, 387, 400, 428, 455, 468, 484, 493, 523,
</span></span><span class=line><span class=cl>  557, 574, 586, 605, 617, 618, 634, 641, 646, 649,
</span></span><span class=line><span class=cl>  674, 678, 689, 699, 703, 709, 714, 740, 795, 798,
</span></span><span class=line><span class=cl>  839, 880, 938, 941, 983, 1014, 1021, 1022, 1165, 1183,
</span></span><span class=line><span class=cl>  1195, 1250, 1254, 1288, 1292, 1326, 1362, 1363, 1421, 1549,
</span></span><span class=line><span class=cl>  1585, 1605, 1629, 1694, 1695, 1719, 1799, 1827, 1828, 1862,
</span></span><span class=line><span class=cl>  1991, 2140, 2186, 2255, 2266, 2295, 2321, 2419, 2919, 3612}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Lower1 = {-2000, BaseSample}
</span></span><span class=line><span class=cl>Lower2 = {-2001, -2000, BaseSample}
</span></span><span class=line><span class=cl>Lower3 = {-2002, -2001, -2000, BaseSample}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                Lower1          Lower2                Lower3
</span></span><span class=line><span class=cl>TukeySimple     -2000,2919,3612 -2001,-2000,2919,3612 -2002,-2001,-2000,2919,3612
</span></span><span class=line><span class=cl>TukeyHd         -2000,2919,3612 -2001,-2000,2919,3612 -2002,-2001,-2000,2919,3612
</span></span><span class=line><span class=cl>MadSimple       -2000,2919,3612 -2001,-2000,2919,3612 -2002,-2001,-2000,2919,3612
</span></span><span class=line><span class=cl>MadHd           -2000,2919,3612 -2001,-2000,2919,3612 -2002,-2001,-2000,2919,3612
</span></span><span class=line><span class=cl>DoubleMadSimple -2000,3612      -2001,-2000,3612      -2002,-2001,-2000,3612
</span></span><span class=line><span class=cl>DoubleMadHd     -2000           -2001,-2000           -2002,-2001,-2000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Upper1 = {BaseSample, 6000}
</span></span><span class=line><span class=cl>Upper2 = {BaseSample, 6000, 6001}
</span></span><span class=line><span class=cl>Upper3 = {BaseSample, 6000, 6001, 6002}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                Upper1         Upper2              Upper3
</span></span><span class=line><span class=cl>TukeySimple     2919,3612,6000 2919,3612,6000,6001 2919,3612,6000,6001,6002
</span></span><span class=line><span class=cl>TukeyHd         3612,6000      3612,6000,6001      3612,6000,6001,6002
</span></span><span class=line><span class=cl>MadSimple       2919,3612,6000 2919,3612,6000,6001 2919,3612,6000,6001,6002
</span></span><span class=line><span class=cl>MadHd           2919,3612,6000 2919,3612,6000,6001 2919,3612,6000,6001,6002
</span></span><span class=line><span class=cl>DoubleMadSimple 3612,6000      6000,6001           6000,6001,6002
</span></span><span class=line><span class=cl>DoubleMadHd     6000           6000,6001           6000,6001,6002
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Both1 = {-2000, BaseSample, 6000}
</span></span><span class=line><span class=cl>Both2 = {-2001, -2000, BaseSample, 6000, 6001}
</span></span><span class=line><span class=cl>Both3 = {-2002, -2001, -2000, BaseSample, 6000, 6001, 6002}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                Both1                Both2                           Both3
</span></span><span class=line><span class=cl>TukeySimple     -2000,2919,3612,6000 -2001,-2000,2919,3612,6000,6001 -2002,-2001,-2000,3612,6000,6001,6002
</span></span><span class=line><span class=cl>TukeyHd         -2000,3612,6000      -2001,-2000,3612,6000,6001      -2002,-2001,-2000,3612,6000,6001,6002
</span></span><span class=line><span class=cl>MadSimple       -2000,2919,3612,6000 -2001,-2000,2919,3612,6000,6001 -2002,-2001,-2000,2919,3612,6000,6001,6002
</span></span><span class=line><span class=cl>MadHd           -2000,2919,3612,6000 -2001,-2000,2919,3612,6000,6001 -2002,-2001,-2000,2919,3612,6000,6001,6002
</span></span><span class=line><span class=cl>DoubleMadSimple -2000,6000           -2001,-2000,6000,6001           -2002,-2001,-2000,6000,6001,6002
</span></span><span class=line><span class=cl>DoubleMadHd     -2000,6000           -2001,-2000,6000,6001           -2002,-2001,-2000,6000,6001,6002
</span></span></code></pre></div><p>As we can see, only <code>DoubleMadHd</code> produces the expected outliers in all the cases.</p><h3 id=reference-implementations>Reference implementations</h3><p>If you use R, here is the function that you can use in your scripts:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>Hmisc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>removeOutliers</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>hdmedian</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>u</span><span class=p>)</span> <span class=nf>as.numeric</span><span class=p>(</span><span class=nf>hdquantile</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=m>0.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>&lt;-</span> <span class=n>x[</span><span class=o>!</span><span class=nf>is.na</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=n>]</span>
</span></span><span class=line><span class=cl>  <span class=n>m</span> <span class=o>&lt;-</span> <span class=nf>hdmedian</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>deviations</span> <span class=o>&lt;-</span> <span class=nf>abs</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>lowerMAD</span> <span class=o>&lt;-</span> <span class=m>1.4826</span> <span class=o>*</span> <span class=nf>hdmedian</span><span class=p>(</span><span class=n>deviations[x</span> <span class=o>&lt;=</span> <span class=n>m]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>upperMAD</span> <span class=o>&lt;-</span> <span class=m>1.4826</span> <span class=o>*</span> <span class=nf>hdmedian</span><span class=p>(</span><span class=n>deviations[x</span> <span class=o>&gt;=</span> <span class=n>m]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>return</span><span class=p>(</span><span class=n>x[x</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>-</span> <span class=m>3</span> <span class=o>*</span> <span class=n>lowerMAD</span> <span class=o>&amp;</span> <span class=n>x</span> <span class=o>&lt;=</span> <span class=n>m</span> <span class=o>+</span> <span class=m>3</span> <span class=o>*</span> <span class=n>upperMAD]</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>If you use C#, you can take an implementation from
the latest nightly version (0.3.0-nightly.30+) of <a href=https://github.com/AndreyAkinshin/perfolizer>Perfolizer</a>
(you need <code>DoubleMadOutlierDetector</code>).</p><h3 id=conclusion>Conclusion</h3><p>In this post, we built a robust outlier detector based on Double MAD and the Harrell-Davis quantile estimator.
It works well with different kinds of non-parametric distributions, including nonsymmetric and bimodal data sets.</p><p>Of course, it&rsquo;s not a universal approach that handles all the possible cases.
Since we don&rsquo;t have a strict outlier definition, it&rsquo;s always possible to find examples of results that are &ldquo;incorrect&rdquo;
from the researcher&rsquo;s point of view for any outlier detection algorithm.</p><p>I tested the suggested approach on a huge number of data sets based on software performance measurements.
The corresponding distributions are often right-skewed and heavily-tailed, so it&rsquo;s pretty hard to find the correct set of outliers.
However, I (almost) have never been disappointed with the results.</p><p>Sometimes, the algorithm may skip some outliers around the thresholds.
This happens because it &ldquo;tries&rdquo; to detect only the most &ldquo;obvious&rdquo; outlier values.
If it&rsquo;s not OK for your case, the outlier sensitivity can be tuned by the scale factor $ k $.
However, in my experiments, $ k = 3 $ works fine for most cases.</p><p>I hope that the Harrell-Davis-powered Double MAD approach may help you as well in your next outlier hunting journey.</p><h3 id=references>References</h3><ul><li><b id=Tukey1997>[Tukey1997]</b><br>Tukey, John W. Exploratory data analysis. Vol. 2. 1977.</li><li><b id=Leys2013>[Leys2013]</b><br>Leys, Christophe, Christophe Ley, Olivier Klein, Philippe Bernard, and Laurent Licata.
&ldquo;Detecting outliers: Do not use standard deviation around the mean, use absolute deviation around the median.&rdquo;
<em>Journal of Experimental Social Psychology</em> 49, no. 4 (2013): 764-766.</li><li><b id=Yang2019>[Yang2019]</b><br>Yang, Jiawei, Susanto Rahardja, and Pasi Fränti.
&ldquo;Outlier detection: how to threshold outlier scores?.&rdquo;
<em>In Proceedings of the International Conference on Artificial Intelligence, Information Processing and Cloud Computing</em>, pp. 1-6. 2019.<br><a href=https://www.researchgate.net/publication/337883760_Outlier_detection_how_to_threshold_outlier_scores>https://www.researchgate.net/publication/337883760_Outlier_detection_how_to_threshold_outlier_scores</a></li><li><b id=Rosenmai2013>[Rosenmai2013]</b><br>Rosenmai, Peter.
&ldquo;Using the Median Absolute Deviation to Find Outliers.&rdquo;
<em>Eureka Statistics.</em>
November 25, 2013.
Accessed June 22, 2020.<br><a href=https://eurekastatistics.com/using-the-median-absolute-deviation-to-find-outliers/>https://eurekastatistics.com/using-the-median-absolute-deviation-to-find-outliers/</a></li><li><b id=Harrell1982>[Harrell1982]</b><br>Harrell, F.E. and Davis, C.E., 1982. A new distribution-free quantile estimator.
<em>Biometrika</em>, 69(3), pp.635-640.<br><a href=https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf>https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf</a></li></ul></div><br><br></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>