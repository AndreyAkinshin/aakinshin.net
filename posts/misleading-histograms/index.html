<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Multimodality,Histograms"><title>Misleading histograms | Andrey Akinshin</title><meta name=description content="Below you see two histograms. What could you say about them?
Most likely, you say that the first histogram is based on a uniform distribution, and the seco..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script src=https://cdn.tailwindcss.com/3.2.4></script>
<script>tailwind.config={darkMode:"class"}</script><style type=text/tailwindcss>
    @layer base {
       
       
      body {
        @apply bg-white dark:bg-zinc-800;
        @apply text-black dark:text-gray-400;
      }
      nav {
        @apply bg-sky-800 dark:bg-zinc-900;
      }
      a {
        @apply text-sky-600 dark:text-white;
        @apply no-underline;
      }
      .main-content a:not(.label-link) {
        @apply hover:underline;
      }
      hr {
        @apply h-px my-3 border-0 bg-gray-300 dark:bg-gray-600;
      }
      h1, h2, h3, h4, h5, h6 {
        @apply leading-tight;
      }
      h1, h2, h3 {
        @apply text-4xl py-4;
      }
      h4 {
        @apply text-3xl py-3;
      }
      h5, h6 {
        @apply text-2xl py-2;
      }
      table {
        @apply border self-center mx-auto;
      }
      th, td {
        @apply border p-2
      }
      blockquote {
        @apply border-l-8 border-gray-300 bg-gray-100 dark:border-zinc-600 dark:bg-zinc-700;
        @apply ml-4 my-4 pl-4 py-2;
      }

       
      .main ul {
        @apply list-disc ml-10 my-2;
      }
      .main ol {
        @apply list-decimal ml-10 my-2;
      }
      .main p {
        @apply mb-3;
      }

       
      .label {
        @apply mx-1 px-1 py-0.5;
        @apply rounded border border-gray-400 dark:border-gray-500;
      }
      .label-link {
        @apply mx-1 px-1 py-0.5;
        @apply rounded border border-sky-600 dark:border-slate-400;
        @apply hover:bg-sky-200 dark:hover:bg-gray-500;
      }
      .nav-item {
        @apply text-white hover:bg-sky-700 dark:hover:bg-gray-700;
      }

       
      .paginator {
        @apply flex flex-wrap justify-center mb-4;
      }
      .paginator .page-item {
        @apply inline-flex border rounded px-3 py-1;
      }
      .paginator .page-item:not(.active):not(.disabled) {
        @apply border-gray-400 dark:border-gray-400;
      }
      .paginator .page-item.active {
        @apply border-sky-600 dark:border-white;
      }
      .paginator .page-item.disabled {
        @apply bg-gray-50 dark:bg-gray-500 dark:border-gray-400;
      }
      .paginator .page-item.disabled a {
        @apply text-gray-400 dark:text-gray-400;
      }

       
      .anchorjs-link {
        transition: all .25s linear;
      }
      *:hover > .anchorjs-link {
        margin-left: -1.125em !important;
      }

       
      .block-example {
        margin-top: 10px;
        margin-bottom: 10px;
      
        margin-left: 10px;
        padding-left: 10px;
      
        border-left: 5px solid;
        border-color: grey;
      }
      .block-example-title::before {  
        counter-increment: example;
        content: "Example " counter(example);
      }
      body {
        counter-reset: example;
      }

       
      #about-profiles svg {
        margin-right: 0.7rem;
      }
      #about p, #about ul {
        margin-top: 0rem;
        margin-bottom: 0rem;
      }
      #about ol {
        @apply ml-10;
      }
      #about img {
        height: 18px;
        @apply inline-flex;
      }
      .about-compact p {
        text-indent: 20px !important;
        margin: 0 !important;
      }

       
      .d-none { display:none; }

       
      code.has-jax {
        -webkit-font-smoothing: antialiased;
        background: inherit !important;
        border: none !important;
        font-size: 100%;
      }

       
      .fai {
        @apply inline-flex;
        height: 1.2em;
        width: 1.2em;
        padding-right: 0.4em;
        fill: currentColor;
      }
      .fai-link {
        @apply hover:text-sky-400 dark:hover:text-blue-400;
      }
      .label-link .fai {
        @apply pl-1 pb-1;
        height: 1.5em;
        width: 1.5em;
      }

       
      .chroma {
        @apply my-5 overflow-y-scroll;
        border-radius: 3px;
        border: 1px solid #C3CCD0;
        padding: 0.5em;
      }
        .chroma { background-color: #ffffff }
        .chroma .x {  }
        .chroma .err { color: #a61717; background-color: #e3d2d2 }
        .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
        .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
        .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
        .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .chroma .k { color: #000000; font-weight: bold }
        .chroma .kc { color: #000000; font-weight: bold }
        .chroma .kd { color: #000000; font-weight: bold }
        .chroma .kn { color: #000000; font-weight: bold }
        .chroma .kp { color: #000000; font-weight: bold }
        .chroma .kr { color: #000000; font-weight: bold }
        .chroma .kt { color: #445588; font-weight: bold }
        .chroma .n {  }
        .chroma .na { color: #008080 }
        .chroma .nb { color: #0086b3 }
        .chroma .bp { color: #999999 }
        .chroma .nc { color: #445588; font-weight: bold }
        .chroma .no { color: #008080 }
        .chroma .nd { color: #3c5d5d; font-weight: bold }
        .chroma .ni { color: #800080 }
        .chroma .ne { color: #990000; font-weight: bold }
        .chroma .nf { color: #990000; font-weight: bold }
        .chroma .fm {  }
        .chroma .nl { color: #990000; font-weight: bold }
        .chroma .nn { color: #555555 }
        .chroma .nx {  }
        .chroma .py {  }
        .chroma .nt { color: #000080 }
        .chroma .nv { color: #008080 }
        .chroma .vc { color: #008080 }
        .chroma .vg { color: #008080 }
        .chroma .vi { color: #008080 }
        .chroma .vm {  }
        .chroma .l {  }
        .chroma .ld {  }
        .chroma .s { color: #dd1144 }
        .chroma .sa { color: #dd1144 }
        .chroma .sb { color: #dd1144 }
        .chroma .sc { color: #dd1144 }
        .chroma .dl { color: #dd1144 }
        .chroma .sd { color: #dd1144 }
        .chroma .s2 { color: #dd1144 }
        .chroma .se { color: #dd1144 }
        .chroma .sh { color: #dd1144 }
        .chroma .si { color: #dd1144 }
        .chroma .sx { color: #dd1144 }
        .chroma .sr { color: #009926 }
        .chroma .s1 { color: #dd1144 }
        .chroma .ss { color: #990073 }
        .chroma .m { color: #009999 }
        .chroma .mb { color: #009999 }
        .chroma .mf { color: #009999 }
        .chroma .mh { color: #009999 }
        .chroma .mi { color: #009999 }
        .chroma .il { color: #009999 }
        .chroma .mo { color: #009999 }
        .chroma .o { color: #000000; font-weight: bold }
        .chroma .ow { color: #000000; font-weight: bold }
        .chroma .p {  }
        .chroma .c { color: #999988; font-style: italic }
        .chroma .ch { color: #999988; font-style: italic }
        .chroma .cm { color: #999988; font-style: italic }
        .chroma .c1 { color: #999988; font-style: italic }
        .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
        .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
        .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
        .chroma .g {  }
        .chroma .gd { color: #000000; background-color: #ffdddd }
        .chroma .ge { color: #000000; font-style: italic }
        .chroma .gr { color: #aa0000 }
        .chroma .gh { color: #999999 }
        .chroma .gi { color: #000000; background-color: #ddffdd }
        .chroma .go { color: #888888 }
        .chroma .gp { color: #555555 }
        .chroma .gs { font-weight: bold }
        .chroma .gu { color: #aaaaaa }
        .chroma .gt { color: #aa0000 }
        .chroma .gl { text-decoration: underline }
        .chroma .w { color: #bbbbbb }
        .dark.chroma { color: #f8f8f2; background-color: #272822 }
        .dark .chroma { color: #f8f8f2; background-color: #272822 }
        .dark .chroma .x {  }
        .dark .chroma .err { color: #960050; background-color: #1e0010 }
        .dark .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
        .dark .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
        .dark .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
        .dark .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .dark .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .dark .chroma .k { color: #66d9ef }
        .dark .chroma .kc { color: #66d9ef }
        .dark .chroma .kd { color: #66d9ef }
        .dark .chroma .kn { color: #f92672 }
        .dark .chroma .kp { color: #66d9ef }
        .dark .chroma .kr { color: #66d9ef }
        .dark .chroma .kt { color: #66d9ef }
        .dark .chroma .n {  }
        .dark .chroma .na { color: #a6e22e }
        .dark .chroma .nb {  }
        .dark .chroma .bp {  }
        .dark .chroma .nc { color: #a6e22e }
        .dark .chroma .no { color: #66d9ef }
        .dark .chroma .nd { color: #a6e22e }
        .dark .chroma .ni {  }
        .dark .chroma .ne { color: #a6e22e }
        .dark .chroma .nf { color: #a6e22e }
        .dark .chroma .fm {  }
        .dark .chroma .nl {  }
        .dark .chroma .nn {  }
        .dark .chroma .nx { color: #a6e22e }
        .dark .chroma .py {  }
        .dark .chroma .nt { color: #f92672 }
        .dark .chroma .nv {  }
        .dark .chroma .vc {  }
        .dark .chroma .vg {  }
        .dark .chroma .vi {  }
        .dark .chroma .vm {  }
        .dark .chroma .l { color: #ae81ff }
        .dark .chroma .ld { color: #e6db74 }
        .dark .chroma .s { color: #e6db74 }
        .dark .chroma .sa { color: #e6db74 }
        .dark .chroma .sb { color: #e6db74 }
        .dark .chroma .sc { color: #e6db74 }
        .dark .chroma .dl { color: #e6db74 }
        .dark .chroma .sd { color: #e6db74 }
        .dark .chroma .s2 { color: #e6db74 }
        .dark .chroma .se { color: #ae81ff }
        .dark .chroma .sh { color: #e6db74 }
        .dark .chroma .si { color: #e6db74 }
        .dark .chroma .sx { color: #e6db74 }
        .dark .chroma .sr { color: #e6db74 }
        .dark .chroma .s1 { color: #e6db74 }
        .dark .chroma .ss { color: #e6db74 }
        .dark .chroma .m { color: #ae81ff }
        .dark .chroma .mb { color: #ae81ff }
        .dark .chroma .mf { color: #ae81ff }
        .dark .chroma .mh { color: #ae81ff }
        .dark .chroma .mi { color: #ae81ff }
        .dark .chroma .il { color: #ae81ff }
        .dark .chroma .mo { color: #ae81ff }
        .dark .chroma .o { color: #f92672 }
        .dark .chroma .ow { color: #f92672 }
        .dark .chroma .p {  }
        .dark .chroma .c { color: #75715e }
        .dark .chroma .ch { color: #75715e }
        .dark .chroma .cm { color: #75715e }
        .dark .chroma .c1 { color: #75715e }
        .dark .chroma .cs { color: #75715e }
        .dark .chroma .cp { color: #75715e }
        .dark .chroma .cpf { color: #75715e }
        .dark .chroma .g {  }
        .dark .chroma .gd { color: #f92672 }
        .dark .chroma .ge { font-style: italic }
        .dark .chroma .gr {  }
        .dark .chroma .gh {  }
        .dark .chroma .gi { color: #a6e22e }
        .dark .chroma .go {  }
        .dark .chroma .gp {  }
        .dark .chroma .gs { font-weight: bold }
        .dark .chroma .gu { color: #75715e }
        .dark .chroma .gt {  }
        .dark .chroma .gl {  }
        .dark .chroma .w {  }
    }
  </style><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-6 h-6"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Misleading histograms</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai"><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2020-10-20>October 20, 2020</time><svg class="fai ml-3"><use xlink:href="/img/fa/all.svg#tag"/></svg>
<a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/multimodality/>Multimodality</a>
<a class=label-link href=https://aakinshin.net/tags/histograms/>Histograms</a></div><br><div class=main-content><p>Below you see two histograms.
What could you say about them?</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-riddle-light.svg target=_blank alt=hist-riddle><img src=/posts/misleading-histograms/img/hist-riddle-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-riddle-dark.svg target=_blank alt=hist-riddle><img src=/posts/misleading-histograms/img/hist-riddle-dark.svg width=800></a></div><p>Most likely, you say that the first histogram is based on a uniform distribution,
and the second one is based on a multimodal distribution with four modes.
Although this is not obvious from the plots,
both histograms are based on the same sample:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cs data-lang=cs><span class=line><span class=cl><span class=m>20.13</span><span class=p>,</span> <span class=m>19.94</span><span class=p>,</span> <span class=m>20.03</span><span class=p>,</span> <span class=m>20.06</span><span class=p>,</span> <span class=m>20.04</span><span class=p>,</span> <span class=m>19.98</span><span class=p>,</span> <span class=m>20.15</span><span class=p>,</span> <span class=m>19.99</span><span class=p>,</span> <span class=m>20.20</span><span class=p>,</span> <span class=m>19.99</span><span class=p>,</span> <span class=m>20.13</span><span class=p>,</span> <span class=m>20.22</span><span class=p>,</span> <span class=m>19.86</span><span class=p>,</span> <span class=m>19.97</span><span class=p>,</span> <span class=m>19.98</span><span class=p>,</span> <span class=m>20.06</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=m>29.97</span><span class=p>,</span> <span class=m>29.73</span><span class=p>,</span> <span class=m>29.75</span><span class=p>,</span> <span class=m>30.13</span><span class=p>,</span> <span class=m>29.96</span><span class=p>,</span> <span class=m>29.82</span><span class=p>,</span> <span class=m>29.98</span><span class=p>,</span> <span class=m>30.12</span><span class=p>,</span> <span class=m>30.18</span><span class=p>,</span> <span class=m>29.95</span><span class=p>,</span> <span class=m>29.97</span><span class=p>,</span> <span class=m>29.82</span><span class=p>,</span> <span class=m>30.04</span><span class=p>,</span> <span class=m>29.93</span><span class=p>,</span> <span class=m>30.04</span><span class=p>,</span> <span class=m>30.07</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=m>40.10</span><span class=p>,</span> <span class=m>39.93</span><span class=p>,</span> <span class=m>40.05</span><span class=p>,</span> <span class=m>39.82</span><span class=p>,</span> <span class=m>39.92</span><span class=p>,</span> <span class=m>39.91</span><span class=p>,</span> <span class=m>39.75</span><span class=p>,</span> <span class=m>40.00</span><span class=p>,</span> <span class=m>40.02</span><span class=p>,</span> <span class=m>39.96</span><span class=p>,</span> <span class=m>40.07</span><span class=p>,</span> <span class=m>39.92</span><span class=p>,</span> <span class=m>39.86</span><span class=p>,</span> <span class=m>40.04</span><span class=p>,</span> <span class=m>39.91</span><span class=p>,</span> <span class=m>40.14</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=m>49.95</span><span class=p>,</span> <span class=m>50.06</span><span class=p>,</span> <span class=m>50.03</span><span class=p>,</span> <span class=m>49.92</span><span class=p>,</span> <span class=m>50.15</span><span class=p>,</span> <span class=m>50.06</span><span class=p>,</span> <span class=m>50.00</span><span class=p>,</span> <span class=m>50.02</span><span class=p>,</span> <span class=m>50.06</span><span class=p>,</span> <span class=m>50.00</span><span class=p>,</span> <span class=m>49.70</span><span class=p>,</span> <span class=m>50.02</span><span class=p>,</span> <span class=m>49.96</span><span class=p>,</span> <span class=m>50.01</span><span class=p>,</span> <span class=m>50.05</span><span class=p>,</span> <span class=m>50.13</span>
</span></span></code></pre></div><p>Thus, the only difference between histograms is the offset!</p><p>Visualization is a simple way to understand the shape of your data.
Unfortunately, this way may easily become a slippery slope.
In the <a href=https://aakinshin.net/posts/kde-bw/>previous post</a>, I have shown how density plots may deceive you when the bandwidth is poorly chosen.
Today, we talk about histograms and why you can&rsquo;t trust them in the general case.</p><h2 id=histograms>Histograms</h2><p>A histogram is one of the simplest ways to present the shape of your data.
Let&rsquo;s say we have a sample <span class="math inline">\(\{ 1.1, 2.1, 2.2, 2.3, 3.1, 3.2 \}\)</span>.
It can be presented using the following histogram:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-simple-light.svg target=_blank alt=hist-simple><img src=/posts/misleading-histograms/img/hist-simple-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-simple-dark.svg target=_blank alt=hist-simple><img src=/posts/misleading-histograms/img/hist-simple-dark.svg width=800></a></div><p>It consists of three bins: <span class="math inline">\([0.5; 1.5]\)</span>, <span class="math inline">\([1.5; 2.5]\)</span>, <span class="math inline">\([2.5; 3.5]\)</span>.
The height of each bin is the number of elements in the corresponding interval.
Small strokes under the histogram is an optional adornment that shows values of the elements
(it&rsquo;s called <a href=https://en.wikipedia.org/wiki/Rug_plot>rug plot</a>).</p><p>Here we have no tricky equations with integrals, no complex algorithms, no 200 pages user manual.
This is one of the most straightforward approaches in mathematical statistics.
It&rsquo;s easy to build and interpret such plots.
What could go wrong?</p><h2 id=histogram-offset>Histogram offset</h2><p>Despite the simplicity, this approach is not entirely straightforward.
We have to define two parameters to build a histogram.
The first one is the <em>offset</em> which is the location of the first bin.
Let&rsquo;s consider another sample: <span class="math inline">\(\{ 18, 19, 21, 22, 38, 39, 41, 42 \}\)</span>.
First, we build a histogram with <span class="math inline">\(\textrm{offset} = 15\)</span>:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-offset1-light.svg target=_blank alt=hist-offset1><img src=/posts/misleading-histograms/img/hist-offset1-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-offset1-dark.svg target=_blank alt=hist-offset1><img src=/posts/misleading-histograms/img/hist-offset1-dark.svg width=800></a></div><p>Here we have three bins: <span class="math inline">\([15; 25]\)</span>, <span class="math inline">\([25; 35]\)</span>, <span class="math inline">\([35; 45]\)</span>.
The first one and the last one contains four elements each; the middle one is empty.</p><p>Next, we build another histogram with <span class="math inline">\(\textrm{offset} = 10\)</span> based on the same sample:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-offset2-light.svg target=_blank alt=hist-offset2><img src=/posts/misleading-histograms/img/hist-offset2-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-offset2-dark.svg target=_blank alt=hist-offset2><img src=/posts/misleading-histograms/img/hist-offset2-dark.svg width=800></a></div><p>Here we have four bins: <span class="math inline">\([10; 20]\)</span>, <span class="math inline">\([20; 30]\)</span>, <span class="math inline">\([30; 40]\)</span>, <span class="math inline">\([40; 50]\)</span>.
Each of them contains exactly two elements.</p><p>We have the same sample in both cases, but the histogram shapes are different because of different offsets.
It may lead us to the idea that we need a smart algorithm to choose the perfect offset.
Unfortunately, it&rsquo;s not always possible.
Let&rsquo;s consider another sample: <span class="math inline">\(\{ 18, 19, 21, 22, 38, 39, 41, 42, 53, 54, 56, 57 \}\)</span>.
It looks like a trimodal distribution:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cs data-lang=cs><span class=line><span class=cl><span class=m>18</span><span class=p>,</span> <span class=m>19</span><span class=p>,</span> <span class=m>21</span><span class=p>,</span> <span class=m>22</span><span class=p>,</span> <span class=c1>// First mode</span>
</span></span><span class=line><span class=cl><span class=m>38</span><span class=p>,</span> <span class=m>39</span><span class=p>,</span> <span class=m>41</span><span class=p>,</span> <span class=m>42</span><span class=p>,</span> <span class=c1>// Second mode</span>
</span></span><span class=line><span class=cl><span class=m>53</span><span class=p>,</span> <span class=m>54</span><span class=p>,</span> <span class=m>56</span><span class=p>,</span> <span class=m>57</span>  <span class=c1>// Third mode</span>
</span></span></code></pre></div><p>And here is a few attempt to build a histogram (with <span class="math inline">\(\textrm{offset} = 10\)</span>, <span class="math inline">\(\textrm{offset} = 15\)</span>):</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-offset3-light.svg target=_blank alt=hist-offset3><img src=/posts/misleading-histograms/img/hist-offset3-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-offset3-dark.svg target=_blank alt=hist-offset3><img src=/posts/misleading-histograms/img/hist-offset3-dark.svg width=800></a></div><p>The problem arises when we have at least three modes with different distances between them.
For this particular example, you can find an offset that highlights all three modes.
But it will not be a perfect trimodal shape because gaps will not be empty.
In more complicated cases, it&rsquo;s almost impossible to get a histogram that presents the actual shape of the data.</p><p>You may think that statistical packages that you use should help you to automatically choose a good value.
It&rsquo;s not true.
Usually, they use the most simple heuristics to choose the offset.
Most of them don&rsquo;t allow controlling the offset at all.</p><p>OK, if we can&rsquo;t find a good offset, maybe we can get a better histogram shape by reducing the <em>bandwidth</em> (the width of the bins)?</p><h2 id=histogram-bandwidth>Histogram bandwidth</h2><p>Let&rsquo;s consider below histograms for another bimodal sample with different bandwidth values:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-bandwidth1-light.svg target=_blank alt=hist-bandwidth1><img src=/posts/misleading-histograms/img/hist-bandwidth1-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-bandwidth1-dark.svg target=_blank alt=hist-bandwidth1><img src=/posts/misleading-histograms/img/hist-bandwidth1-dark.svg width=800></a></div><p>By <a href=https://aakinshin.net/posts/kde-bw/#how-bandwidth-selection-affects-plot-smoothness>analogy with kernel density estimation</a>,
we have two unwanted effects of poorly chosen bandwidths:</p><ul><li><strong>Oversmoothing</strong><br>The bandwidth is too big, the true shape of the data is hidden.</li><li><strong>Undersmoothing</strong><br>The bandwidth is too small, the histogram looks like a combination of separated spikes.</li></ul><p>Thus, we want to get a perfect bandwidth value.
Let&rsquo;s go back to the first 64-element sample from the beginning of the post and try some most popular formulas that define the number of bins <span class="math inline">\(k\)</span>:</p><ul><li><strong>Square-root choice</strong>: <span class="math inline">\(k = \lceil \sqrt{n} \rceil = \lceil \sqrt{64} \rceil = 8\)</span></li><li><strong>Sturges&rsquo; formula</strong>: <span class="math inline">\(k = \lceil \log_2 n \rceil = \lceil \log_2 64 \rceil = 6\)</span></li><li><strong>Rice Rule</strong>: <span class="math inline">\(k = \lceil 2 \sqrt[3]{n} \rceil = \lceil 2 \sqrt[3]{64} \rceil = 8\)</span></li><li><strong>Doane&rsquo;s formula</strong>: <span class="math inline">\(k = \lceil 2 \sqrt[3]{n} \rceil = \lceil 2 \sqrt[3]{64} \rceil = 8\)</span></li><li><strong>Scott&rsquo;s normal reference rule</strong>: <span class="math inline">\(k = \lceil (\max(x) - \min(x)) / (3.49 \hat{\sigma}/\sqrt[3]{n})\rceil = 4\)</span></li><li><strong>Freedman–Diaconis&rsquo; choice</strong>: <span class="math inline">\(k = \lceil (\max(x) - \min(x)) / ( 2 \cdot \textrm{IQR}(x)/\sqrt[3]{n} )\rceil = 4\)</span></li></ul><p>It&rsquo;s not a perfect competition because most of these equations assume normally distributed data.
However, even non-parametric rules give us pretty small values (usually, in the range <span class="math inline">\(4..8\)</span>).
As we can see in the first image, 8 bins are not enough to resolve the offset problem.</p><p>In most cases, people rely on the default bandwidth selection algorithm, which is not optimal in multimodal cases.
Of course, it&rsquo;s always possible to manually set a proper bandwidth, but this challenging task is often neglected.</p><p>Thus, you should always be a little be distrustful of classic histograms with fixed bandwidth
that are drawn by your favorite statistical package.</p><h2 id=improving-histograms>Improving histograms</h2><p>There are two popular ways to improve your histograms and reduce the risk of incorrect presentation:
add the <em>rug plot</em> and add the <em>kernel density estimation</em>.
Let&rsquo;s look at how they can help us with the first 64-element sample from the beginning of the post.</p><ul><li><p><strong>Rug plot</strong><br><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-riddle-rug-light.svg target=_blank alt=hist-riddle-rug><img src=/posts/misleading-histograms/img/hist-riddle-rug-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-riddle-rug-dark.svg target=_blank alt=hist-riddle-rug><img src=/posts/misleading-histograms/img/hist-riddle-rug-dark.svg width=800></a></div>Here we added a rug plot below the histogram.
We see that most of the strokes are close to the bin borders.
In such situations, we can understand that something is wrong with the histograms and try to adjust offset/bandwidth values.</p></li><li><p><strong>Kernel density estimation</strong><br><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/misleading-histograms/img/hist-riddle-kde-light.svg target=_blank alt=hist-riddle-kde><img src=/posts/misleading-histograms/img/hist-riddle-kde-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/misleading-histograms/img/hist-riddle-kde-dark.svg target=_blank alt=hist-riddle-kde><img src=/posts/misleading-histograms/img/hist-riddle-kde-dark.svg width=800></a></div>Here we added a kernel density estimation (KDE) as an overlay using the Sheather & Jones method.
We see that the density is not consistent with the histogram.
This is also a sign to adjust offset/bandwidth values.
Remember, that KDE may also <a href=https://aakinshin.net/posts/kde-bw/>easily deceive you</a>.
It&rsquo;s not affected by the offset problem, but it&rsquo;s still hard to choose the proper kernel and bandwidth.
Also, note that here we have a mix of two different kinds of visualization.
Histograms try to present the shape of <em>your actual data</em>,
while KDE tries to present the shape of the <em>estimated underlying distribution</em>.
These two concepts may sound similar, but they can have very different representations.
Thus, you <em>can improve</em> your histogram using KDE, but you <em>can&rsquo;t replace</em> it with KDE.</p></li></ul><h2 id=alternative-approaches>Alternative approaches</h2><p>So, if classic histograms and kernel density plots may easily deceive us, what should we use to get an idea of the data shape?
As usual, there is no universal magic answer that fits all the situations.
But I can suggest two interesting directions:</p><ul><li><strong>Histograms with variable bandwidth</strong><br>The idea is simple: instead of fixed width for all bins, we can define its own width for each bin.
The implementation is not so simple.
I didn&rsquo;t find any good-looking papers/implementations of this approach, so I come up with my own.
The detailed description can be found in the fourth chapter of <a href=https://aakinshin.net/prodotnetbenchmarking/>Pro .NET Benchmarking</a>.
It&rsquo;s implemented in <a href=https://github.com/AndreyAkinshin/perfolizer>perfolizer</a> (look for <code>AdaptiveHistogramBuilder</code>) and it has been used by default in <a href=https://github.com/dotnet/BenchmarkDotNet>BenchmarkDotNet</a> for several years.
So far, it works well, but I&rsquo;m still not completely satisfied: I know some corner cases in which the output is far from perfect.</li><li><strong>Empirical probability density plots</strong><br>Such plots are similar to kernel density estimations plots,
but they are based on the sample instead of the distribution estimate.
Thus, they accurately describe the actual data and don&rsquo;t have the offset/bandwidth problems which are hard to solve using histograms.
In future posts, I will show how to build and use such plots.</li></ul><h2 id=conclusion>Conclusion</h2><p>Despite its simplicity, classic histograms with fixed bandwidth may deceive you and present data in the wrong way.</p><p>If you want to build a good histogram, it&rsquo;s crucial to choose proper offset and bandwidth.
Most statistical packages use a naive approach to set these values.
Usually, it&rsquo;s OK for unimodal distributions: poorly chosen parameters don&rsquo;t produce a noticeable impact in most cases.
A series of properly constructed histograms may create a false sense of security.
However, one day you may try to build a histogram for a multimodal distribution, get a distorted picture, and even don&rsquo;t notice it.</p><p>You can reduce the chances of such situations by adding the <em>rug plot</em> or the <em>kernel density estimation</em> to your histogram.
Alternatively, you can look for more reliable ways to present the shape of your data like <em>histograms with variable bandwidth</em> or the <em>empirical probability density plots</em>.</p></div><br><br><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-histograms%2f&title=Misleading%20histograms" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Misleading%20histograms&url=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-histograms%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-histograms%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-histograms%2f&title=Misleading%20histograms" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2022 Andrey Akinshin</span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>anchors.options={placement:"left",icon:"§"},anchors.add("h1"),anchors.add("h2"),anchors.add("h3")</script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>