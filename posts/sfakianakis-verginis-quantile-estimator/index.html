<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.3"><meta name=author content='Andrey Akinshin'><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content='Mathematics,Statistics,Research,Quantile'><title>Sfakianakis-Verginis quantile estimator | Andrey Akinshin</title>
<meta name=description content="A brief description of the Sfakianakis-Verginis quantile estimator"><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.d5a0830628a332736b49276c6d88c4bc429b98950014058537288a38d360b7e2.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-2 xs:px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Sfakianakis-Verginis quantile estimator</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2021-03-09>March 9, 2021</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/quantile/>Quantile</a></div></div><br><div class=main-content><p>There are dozens of different ways to estimate quantiles.
One of these ways is to use the Sfakianakis-Verginis quantile estimator.
To be more specific, it&rsquo;s a family of three estimators.
If we want to estimate the $p^\textrm{th}$ quantile of sample $X$,
we can use one of the following equations:</p>$$
\begin{split}
\operatorname{SV1}_p =&
\frac{B_0}{2} \big( X_{(1)}+X_{(2)}-X_{(3)} \big) +
\sum_{i=1}^{n} \frac{B_i+B_{i-1}}{2} X_{(i)} +
\frac{B_n}{2} \big(- X_{(n-2)}+X_{(n-1)}-X_{(n)} \big),\\
\operatorname{SV2}_p =& \sum_{i=1}^{n} B_{i-1} X_{(i)} + B_n \cdot \big(2X_{(n)} - X_{(n-1)}\big),\\
\operatorname{SV3}_p =& \sum_{i=1}^n B_i X_{(i)} + B_0 \cdot \big(2X_{(1)}-X_{(2)}\big).
\end{split}
$$<p>where $B_i = B(i; n, p)$ is probability mass function of the binomial distribution $B(n, p)$,
$X_{(i)}$ are order statistics of sample $X$.</p><p>In this post, I derive these equations following the paper
<a href=https://doi.org/10.1080/03610910701790491>&ldquo;A new family of nonparametric quantile estimators&rdquo;</a> (2008)
by Michael E. Sfakianakis and Dimitris G. Verginis.
Also, I add some additional explanations,
reconstruct missing steps,
simplify the final equations,
and provide reference implementations in C# and R.</p><h3 id=preparation>Preparation</h3><p>Consider sample $X = \{ X_1, X_2, \ldots, X_n \}$ ($n \geq 3$).
Let $X_{(1)}, X_{(2)}, \ldots, X_{(n)}$ be the order statistics of this sample
($X_{(k)}$ is the $k^\textrm{th}$ smallest element).
Now let&rsquo;s build the following intervals:</p>$$
S_0 = \big(L, X_{(1)} \big),\;
S_1 = \big[X_{(1)}, X_{(2)} \big),
\ldots,
S_{n-1} = \big[X_{(n-1)},X_{n} \big),\;
S_{(n)} = \big[X_{(n)}, U \big)
$$<p>where $L$ and $U$ are lower and upper bounds for $X$ values ($L$ and $U$ could be equal to $-\infty$ and $\infty$).</p><div class=row><div class=mx-auto><a href=/posts/sfakianakis-verginis-quantile-estimator/img/segments.png target=_blank alt=segments><img class="mx-auto d-block img-fluid" width=800 src=/posts/sfakianakis-verginis-quantile-estimator/img/segments.png></a></div></div><br><p>We want to estimate $p^\textrm{th}$ quantile $Q_p$.
Obviously, $Q_p$ should belong to one of the $S_i$ intervals (because they cover all possible $Q_p$ values).
With the help of $Q_p$, we can introduce variables $\delta_i$:</p>$$
\delta_i =
\begin{cases}
1 & \textrm{if}\; X_i \leq Q_p,\\
0 & \textrm{if}\; X_i > Q_p.
\end{cases}
$$<p>Since $Q_p$ is the $p^\textrm{th}$ quantile,
the probability of $(X_i \leq Q_p)$ is $p$ and
the probability of $(X_i > Q_p)$ is $1-p$.
Thus, $\delta_i$ belongs to the <a href=https://en.wikipedia.org/wiki/Bernoulli_distribution>bernoulli distribution</a>:
$\delta_i \sim \textrm{Bernoulli}(p)$.</p><p>Next, consider the sum of $\delta_i$ values:</p>$$
N = \delta_1 + \delta_2 + \ldots + \delta_{n-1} + \delta_n.
$$<p>Since $\delta_i$ are independent variables from the Bernoulli distribution,
their sum belongs to the <a href=https://en.wikipedia.org/wiki/Binomial_distribution>binomial distribution</a>:
$N \sim \textrm{Binomial(n, p)}$.
Now we can get the probability of $Q_p \in S_i$:</p>$$
P(Q_p \in S_i) = P(N = i) = B(i; n, p) = {n \choose k} p^k (1-p)^{(n-k)}.
$$<p>Let $Q'_{p,i}$ be a point estimator of $Q_p$ conditioned on the event $Q_p \in S_i$.
With the help of $Q'_{p,i}$, we could introduce the Sfakianakis-Verginis quantile estimator:</p>$$
\operatorname{SV}_p = \operatorname{E}(Q'_p) = \sum_{i=0}^n P(Q_p \in S_i) \cdot Q'_{p,i}.
$$<p>There are three variations of the Sfakianakis-Verginis quantile estimator depending on the definition of $Q'_{p,i}$.</p><h3 id=sv1>SV1</h3><p>The first approach assumes that the $p^\textrm{th}$ quantile is in the middle of the $i^\textrm{th}$ segment:</p>$$
Q'_{p,i} = \frac{X_{(i)}+X_{(i+1)}}{2}\quad \textrm{for}\;\; i=1..n-1.
$$<p>If we don&rsquo;t know values of $L$ and $U$, we need a way to define $Q'_{p,i}$ for $i=0$ and $i=n$.
The author suggests using these assumptions:</p>$$
Q'_{p,0}-Q'_{p,1} = Q'_{p,1} - Q'_{p,2}; \quad Q'_{p,n} - Q'_{p,n-1} = Q'_{p,n-1}-Q'_{p,n-2}.
$$<p>Thus, we have:</p>$$
\begin{split}
Q'_{p,0} = & 2Q'_{p,1} - Q'_{p,2}
&= 2 \frac{X_{(1)}+X_{(2)}}{2} - \frac{X_{(2)}+X_{(3)}}{2}
&= \frac{2X_{(1)}+X_{(2)}-X_{(3)}}{2},\\
Q'_{p,n} = & 2Q'_{p,n-1} - Q'_{p,n-2}
&= 2 \frac{X_{(n-1)}+X_{(n)}}{2} - \frac{X_{(n-2)}+X_{(n-1)}}{2}
&= \frac{2X_{(n)}+X_{(n-1)}-X_{(n-2)}}{2}.
\end{split}
$$<p>Now we can start deriving $\operatorname{SV1}_p$:</p>$$
\begin{split}
\operatorname{SV1}_p
& = \operatorname{E}(Q'_{p,i}) = \sum_{i=0}^n P(Q_p \in S_i) \cdot Q'_{p,i} = \\
& = \sum_{i=0}^n B(i;n,p) Q'_{p,i} = \\
& = B(0;n,p) Q'_{p,0} + \sum_{i=1}^{n-1} B(i;n,p) Q'_{p,i} + B(n;n,p) Q'_{p,n} \\
\end{split}
$$<p>It gives us the following expression:</p>$$
\begin{split}
\operatorname{SV1}_p =
B(0;n,p) \frac{2X_{(1)}+X_{(2)}-X_{(3)}}{2} +
B(1;n,p) \frac{X_{(1)}+X_{(2)}}{2} +
B(2;n,p) \frac{X_{(2)}+X_{(3)}}{2} + \ldots + \\+
B(n-2;n,p) \frac{X_{(n-2)}+X_{(n-1)}}{2} +
B(n-1;n,p) \frac{X_{(n-1)}+X_{(n)}}{2} +
B(n;n,p) \frac{2X_{(n)}+X_{(n-1)}-X_{(n-2)}}{2}.
\end{split}
$$<p>By regrouping the equation members, we get the final result from the paper:</p>$$
\begin{split}
\operatorname{SV1}_p =
& \frac{2B(0;n,p)+B(1;n,p)}{2} X_{(1)} + \frac{B(0;n,p)}{2}X_{(2)} - \frac{B(0;n,p)}{2}X_{(3)}\\
& +\sum_{i=2}^{n-1} \frac{B(i;n,p)+B(i-1;n,p)}{2} X_{(i)} \\
& -\frac{B(n;n,p)}{2} X_{(n-2)} + \frac{B(n;n,p)}{2} X_{(n-1)} + \frac{2B(n;n,p)+B(n-1;n,p)}{2}X_{(n)}
\end{split}
$$<h3 id=sv2>SV2</h3><p>The second approach assumes that the $p^\textrm{th}$ quantile is in the right endpoint of the $i^\textrm{th}$ segment:</p>$$
Q'_{p,i} = X_{(i+1)}\quad \textrm{for}\;\; i=0..n-1.
$$<p>To get the value of $Q'_{p,n}$, we use an assumption from the $\operatorname{SV1}_p$ section:</p>$$
Q'_{p,n} - Q'_{p,n-1} = Q'_{p,n-1}-Q'_{p,n-2}
$$<p>which can be transformed to</p>$$
Q'_{p,n} = 2Q'_{p,n-1} - Q'_{p,n-2} = 2X_{(n)} - X_{(n-1)}.
$$<p>Using $\operatorname{SV2}_p = \sum_{i=0}^n B(i;n,p) Q'_{p,i}$, we get:</p>$$
\operatorname{SV2}_p = \sum_{i=0}^{n-1} B(i;n,p) X_{(i+1)} + (2X_{(n)} - X_{(n-1)}) B(n;n,p)
$$<h3 id=sv3>SV3</h3><p>The third approach assumes that the $p^\textrm{th}$ quantile is in the left endpoint of the $i^\textrm{th}$ segment:</p>$$
Q'_{p,i} = X_{(i)}\quad \textrm{for}\;\; i=1..n.
$$<p>To get the value of $Q'_{p,0}$, we use an assumption from the $\operatorname{SV1}_p$ section:</p>$$
Q'_{p,0}-Q'_{p,1} = Q'_{p,1} - Q'_{p,2}
$$<p>which can be transformed to</p>$$
Q'_{p,0} = 2Q'_{p,1} - Q'_{p,2} = 2X_{(1)}-X_{(2)}.
$$<p>Using $\operatorname{SV3}_p = \sum_{i=0}^n B(i;n,p) Q'_{p,i}$, we get:</p>$$
\operatorname{SV3}_p = \sum_{i=1}^n B(i;n,p) X_{(i)} + (2X_{(1)}-X_{(2)}) B(0;n,p)
$$<h3 id=simplification>Simplification</h3><p>In my opinion, the above equations (that match the original paper) are too bulky.
Let&rsquo;s simplify them!
We can notice that we work with the same Binomial distribution $B(n, p)$.
What the point of writing the arguments $n$ and $p$ each time?
This just makes it difficult to read the equation!
(If you read the original paper, you may notice that the authors are also confused with this notation;
sometimes they write $B(i;p,n)$ or $B(i;p)$ instead of $B(i;n,p)$.)
Let&rsquo;s denote $B(i;p,n)$ as $B_i$:</p>$$
B_i = B(i;p,n).
$$<p>Now we could rewrite the first equation in a shorter form:</p>$$
\begin{split}
SV1_p = & \frac{2B_0+B_1}{2}X_{(1)} + \frac{B_0}{2} X_{(2)} - \frac{B_0}{2} X_{(3)}\\
& + \sum_{i=2}^{n-1} \frac{B_i+B_{i-1}}{2} X_{(i)}\\
& -\frac{B_n}{2} X_{(n-2)} + \frac{B_n}{2} X _{(n-1)} + \frac{2B_n + B_{n-1}}{2} X_{(n)}
\end{split}
$$<p>Currently, the sum part $\sum_{i=2}^{n-1} \frac{B_i+B_{i-1}}{2} X_{(i)}$ enumerates $i$ from $2$ to $n-1$.
The part could &ldquo;absorb&rdquo; the $\frac{B_i+B_{i-1}}{2} X_{(i)}$ expression for $i=1$ and for $i=n$ from other members of the equation:</p>$$
\operatorname{SV1}_p =
\frac{B_0}{2} \big( X_{(1)}+X_{(2)}-X_{(3)} \big) +
\sum_{i=1}^{n} \frac{B_i+B_{i-1}}{2} X_{(i)} +
\frac{B_n}{2} \big(- X_{(n-2)}+X_{(n-1)}-X_{(n)} \big)
$$<p>In the second equation, we could adjust indexes and enumerate $i$ in range $1..n$ instead of $0..(n-1)$
(to make it consistent with the first and the third equations):</p>$$
\operatorname{SV2}_p = \sum_{i=1}^{n} B_{i-1} X_{(i)} + B_n \cdot \big(2X_{(n)} - X_{(n-1)}\big)
$$<p>In the third equation, we should just replace $B(i;p,n)$ by $B_i$:</p>$$
\operatorname{SV3}_p = \sum_{i=1}^n B_i X_{(i)} + B_0 \cdot \big(2X_{(1)}-X_{(2)}\big)
$$<h3 id=reference-implementation>Reference implementation</h3><p>If you use R, here is the function that you can use in your scripts:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>sv1quantile</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>probs</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>n</span> <span class=o>&lt;-</span> <span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>&lt;=</span> <span class=m>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span><span class=p>(</span><span class=nf>quantile</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>probs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>sort</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nf>sapply</span><span class=p>(</span><span class=n>probs</span><span class=p>,</span> <span class=kr>function</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>B</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=nf>dbinom</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>B</span><span class=p>(</span><span class=m>0</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>x[1]</span> <span class=o>+</span> <span class=n>x[2]</span> <span class=o>-</span> <span class=n>x[3]</span><span class=p>)</span> <span class=o>/</span> <span class=m>2</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=nf>sum</span><span class=p>(</span><span class=nf>sapply</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=n>n</span><span class=p>,</span> <span class=kr>function</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=p>(</span><span class=nf>B</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>+</span> <span class=nf>B</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=m>1</span><span class=p>))</span> <span class=o>*</span> <span class=n>x[i]</span> <span class=o>/</span> <span class=m>2</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=nf>B</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=o>-</span><span class=n>x[n</span><span class=m>-2</span><span class=n>]</span> <span class=o>+</span> <span class=n>x[n</span><span class=m>-1</span><span class=n>]</span> <span class=o>+</span> <span class=n>x[n]</span><span class=p>)</span> <span class=o>/</span> <span class=m>2</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>sv2quantile</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>probs</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>n</span> <span class=o>&lt;-</span> <span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>&lt;=</span> <span class=m>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span><span class=p>(</span><span class=nf>quantile</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>probs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>sort</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nf>sapply</span><span class=p>(</span><span class=n>probs</span><span class=p>,</span> <span class=kr>function</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>B</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=nf>dbinom</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>sum</span><span class=p>(</span><span class=nf>sapply</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=n>n</span><span class=p>,</span> <span class=kr>function</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=nf>B</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=m>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>x[i]</span><span class=p>))</span> <span class=o>+</span> <span class=nf>B</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>x[n]</span> <span class=o>-</span> <span class=n>x[n</span> <span class=o>-</span> <span class=m>1</span><span class=n>]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>sv3quantile</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>probs</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>n</span> <span class=o>&lt;-</span> <span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>&lt;=</span> <span class=m>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span><span class=p>(</span><span class=nf>quantile</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>probs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>sort</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nf>sapply</span><span class=p>(</span><span class=n>probs</span><span class=p>,</span> <span class=kr>function</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>B</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=nf>dbinom</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>sum</span><span class=p>(</span><span class=nf>sapply</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=n>n</span><span class=p>,</span> <span class=kr>function</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=nf>B</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>*</span> <span class=n>x[i]</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=nf>B</span><span class=p>(</span><span class=m>0</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>x[1]</span> <span class=o>-</span> <span class=n>x[2]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>If you use C#, you can take an implementation from
the latest nightly version (0.3.0-nightly.90+) of <a href=https://github.com/AndreyAkinshin/perfolizer>Perfolizer</a>
(you need <code>SfakianakisVerginis1QuantileEstimator</code>, <code>SfakianakisVerginis2QuantileEstimator</code>, <code>SfakianakisVerginis3QuantileEstimator</code>).</p><h3 id=conclusion>Conclusion</h3><p>The Sfakianakis-Verginis quantile estimator is an interesting way to estimate quantiles.
In this post, we briefly described the idea and looked at the estimator equations.
In future posts, we compare the efficiency of the suggested approach with other quantile estimators.</p><h3 id=references>References</h3><ul><li><b id=Sfakianakis2008>[Sfakianakis2008]</b><br>Sfakianakis, Michael E., and Dimitris G. Verginis. &ldquo;A new family of nonparametric quantile estimators.&rdquo; Communications in Statistics—Simulation and Computation® 37, no. 2 (2008): 337-345.<br><a href=https://doi.org/10.1080/03610910701790491>https://doi.org/10.1080/03610910701790491</a></li></ul></div><br><br></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>