<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Research: Unbiased median absolute deviation"><title>Unbiased median absolute deviation based on the trimmed Harrell-Davis quantile estimator | Andrey Akinshin</title><meta name=description content="The median absolute deviation (\(\operatorname{MAD}\)) is a robust measure of scale. For a sample \(x = \{ x_1, x_2, \ldots, x_n \}\), it&amp;rsquo;s defined a..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><meta name=og:image content="https://aakinshin.net/posts/unbiased-mad-thd/img/factors-light.png"><link href=https://aakinshin.net/sass/bootstrap-light.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=https://aakinshin.net/sass/bootstrap-dark.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.d7f6578e23ad3f0c33c589f9bcb34f995b45121f1f3ce888869c86b26826c845.js></script>
<script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.9e68d431432744c07a43381a8a833ffe0921cc0e006d84ad97f0b0d43c5cd82d.mjs></script>
<link href=https://aakinshin.net/css/main.min.4521fdf961aba8dee11ce56edc3cfa07845a0629c82e528856f1558c230aea2f.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body class="d-flex flex-column min-vh-100"><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><svg class="fai"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></li><li class=nav-item><a class=nav-link id=nav-link-posts href=https://aakinshin.net/posts/>Posts</a></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Unbiased median absolute deviation based on the trimmed Harrell-Davis quantile estimator</h1><span class=blog-post-meta><svg class="fai"><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2022-02-08>February 8, 2022</time>
&nbsp;&nbsp;<svg class="fai"><use xlink:href="/img/fa/all.svg#tag"/></svg>
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/research/ class="badge badge-info">Research</a>
<a href=https://aakinshin.net/tags/research-unbiased-mad/ class="badge badge-info">Research: Unbiased median absolute deviation</a></span><br><br><strong>Update: this blog post is a part of research that aimed to build an unbiased median absolute deviation estimator based on various quantile estimators. A <a href=/posts/preprint-mad-factors/>preprint with final results</a> is available on arXiv: <a href=https://arxiv.org/abs/2207.12005>arXiv:2207.12005 [stat.ME]</a>. Some information in this blog post can be obsolete: please, use the preprint as the primary reference.</strong><br><br><p>The <a href=https://en.wikipedia.org/wiki/Median_absolute_deviation>median absolute deviation</a> (<span class="math inline">\(\operatorname{MAD}\)</span>)
is a robust measure of scale.
For a sample <span class="math inline">\(x = \{ x_1, x_2, \ldots, x_n \}\)</span>, it&rsquo;s defined as follows:</p><p><span class="math display">\[\operatorname{MAD}_n = C_n \cdot \operatorname{median}(|x - \operatorname{median}(x)|)
\]</span></p><p>where <span class="math inline">\(\operatorname{median}\)</span> is a median estimator, <span class="math inline">\(C_n\)</span> is a scale factor.
Using the right scale factor, we can use <span class="math inline">\(\operatorname{MAD}\)</span> as a consistent estimator
for the estimation of the standard deviation under the normal distribution.
For huge samples, we can use the asymptotic value of <span class="math inline">\(C_n\)</span> which is</p><p><span class="math display">\[C_\infty = \dfrac{1}{\Phi^{-1}(3/4)} \approx 1.4826022185056.
\]</span></p><p>For small samples, we should use adjusted values <span class="math inline">\(C_n\)</span> which depend on the sample size.
However, <span class="math inline">\(C_n\)</span> depends not only on the sample size but also on the median estimator.
I have already covered how to obtain this values for
<a href=https://aakinshin.net/posts/unbiased-mad/>the traditional median estimator</a> and
<a href=https://aakinshin.net/posts/unbiased-mad-hd/>the Harrell-Davis median estimator</a>.
It&rsquo;s time to get the <span class="math inline">\(C_n\)</span> values for
<a href=https://aakinshin.net/posts/preprint-thdqe/>the trimmed Harrell-Davis median estimator</a>.</p><h3 id=simulation>Simulation</h3><p>In order to obtain the values of <span class="math inline">\(C_n\)</span>, we perform the following simulation:</p><ul><li>Enumerate <span class="math inline">\(n\)</span> from <span class="math inline">\(2\)</span> to <span class="math inline">\(100\)</span> and some other values up to <span class="math inline">\(2000\)</span>.</li><li>For each <span class="math inline">\(n\)</span>, generate <span class="math inline">\(2\cdot 10^8\)</span> samples from the normal distribution of size <span class="math inline">\(n\)</span>
(the <a href=https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform>Boxâ€“Muller transform</a> is used, see <a href=#Box1958>[Box1958]</a>)</li><li>For each sample, estimate <span class="math inline">\(\textrm{MAD}_n\)</span> using <span class="math inline">\(C_n = 1\)</span> and
the <a href=https://aakinshin.net/posts/preprint-thdqe/>trimmed Harrell-Davis quantile estimator</a> based on
the highest density interval of the width <span class="math inline">\(1/sqrt(n)\)</span> (aka <code>THD-SQRT</code>).</li><li>Calculate the arithmetic average of all <span class="math inline">\(\textrm{MAD}_n\)</span> values for the same <span class="math inline">\(n\)</span>: the result is the value of <span class="math inline">\(\hat{a}_n\)</span></li><li>The reverse value is the estimation of <span class="math inline">\(C_n = 1/\hat{a}_n\)</span>.</li></ul><p><em>Warning:</em> on my PC, the simulation takes several days to finish.</p><h3 id=results-for-small-n>Results for small n</h3><p>Here are the results for <span class="math inline">\(n \leq 100\)</span>:</p><table><thead><tr><th align=left>n</th><th align=left><span class="math inline">\(C_n\)</span></th></tr></thead><tbody><tr><td align=left>2</td><td align=left>1.7724370908056342</td></tr><tr><td align=left>3</td><td align=left>1.6455078173901185</td></tr><tr><td align=left>4</td><td align=left>2.017065193495793</td></tr><tr><td align=left>5</td><td align=left>1.6774358847728241</td></tr><tr><td align=left>6</td><td align=left>1.6886228884833927</td></tr><tr><td align=left>7</td><td align=left>1.681012890164465</td></tr><tr><td align=left>8</td><td align=left>1.6363164157283878</td></tr><tr><td align=left>9</td><td align=left>1.6430595153542609</td></tr><tr><td align=left>10</td><td align=left>1.6137117695811252</td></tr><tr><td align=left>11</td><td align=left>1.6036656575624237</td></tr><tr><td align=left>12</td><td align=left>1.5938702075534783</td></tr><tr><td align=left>13</td><td align=left>1.5826054249267754</td></tr><tr><td align=left>14</td><td align=left>1.5770618699717638</td></tr><tr><td align=left>15</td><td align=left>1.568314144069548</td></tr><tr><td align=left>16</td><td align=left>1.5639360738331398</td></tr><tr><td align=left>17</td><td align=left>1.5574345825637932</td></tr><tr><td align=left>18</td><td align=left>1.5530068367429388</td></tr><tr><td align=left>19</td><td align=left>1.548786644010622</td></tr><tr><td align=left>20</td><td align=left>1.5449266898438678</td></tr><tr><td align=left>21</td><td align=left>1.5417268298909585</td></tr><tr><td align=left>22</td><td align=left>1.5385447997218455</td></tr><tr><td align=left>23</td><td align=left>1.5360433134061504</td></tr><tr><td align=left>24</td><td align=left>1.5333044878734197</td></tr><tr><td align=left>25</td><td align=left>1.5313026814346553</td></tr><tr><td align=left>26</td><td align=left>1.5289087814370173</td></tr><tr><td align=left>27</td><td align=left>1.5271766811326293</td></tr><tr><td align=left>28</td><td align=left>1.525372045244657</td></tr><tr><td align=left>29</td><td align=left>1.523823710130717</td></tr><tr><td align=left>30</td><td align=left>1.5223707036738177</td></tr><tr><td align=left>31</td><td align=left>1.5210003444944378</td></tr><tr><td align=left>32</td><td align=left>1.5198014780734148</td></tr><tr><td align=left>33</td><td align=left>1.5185318176366789</td></tr><tr><td align=left>34</td><td align=left>1.5174778699831464</td></tr><tr><td align=left>35</td><td align=left>1.5163204121308342</td></tr><tr><td align=left>36</td><td align=left>1.515455864530263</td></tr><tr><td align=left>37</td><td align=left>1.514367919034956</td></tr><tr><td align=left>38</td><td align=left>1.5135668482892533</td></tr><tr><td align=left>39</td><td align=left>1.512646068257695</td></tr><tr><td align=left>40</td><td align=left>1.5119358224536255</td></tr><tr><td align=left>41</td><td align=left>1.5111386979568142</td></tr><tr><td align=left>42</td><td align=left>1.5104143980692895</td></tr><tr><td align=left>43</td><td align=left>1.5097598792706493</td></tr><tr><td align=left>44</td><td align=left>1.5090605208097354</td></tr><tr><td align=left>45</td><td align=left>1.5085030887342528</td></tr><tr><td align=left>46</td><td align=left>1.5078365336949058</td></tr><tr><td align=left>47</td><td align=left>1.5073406253974977</td></tr><tr><td align=left>48</td><td align=left>1.506750314567103</td></tr><tr><td align=left>49</td><td align=left>1.5063216542860618</td></tr><tr><td align=left>50</td><td align=left>1.5056976215756004</td></tr><tr><td align=left>51</td><td align=left>1.5052645904785493</td></tr><tr><td align=left>52</td><td align=left>1.5047506790429501</td></tr><tr><td align=left>53</td><td align=left>1.504377980905483</td></tr><tr><td align=left>54</td><td align=left>1.5039313123542895</td></tr><tr><td align=left>55</td><td align=left>1.5035247994299705</td></tr><tr><td align=left>56</td><td align=left>1.5031546583298019</td></tr><tr><td align=left>57</td><td align=left>1.5027213700422273</td></tr><tr><td align=left>58</td><td align=left>1.5023816126090916</td></tr><tr><td align=left>59</td><td align=left>1.501979658633948</td></tr><tr><td align=left>60</td><td align=left>1.5016812388186662</td></tr><tr><td align=left>61</td><td align=left>1.5013235911210157</td></tr><tr><td align=left>62</td><td align=left>1.5010571020037526</td></tr><tr><td align=left>63</td><td align=left>1.5006852968235684</td></tr><tr><td align=left>64</td><td align=left>1.5004714716576355</td></tr><tr><td align=left>65</td><td align=left>1.5001142465452528</td></tr><tr><td align=left>66</td><td align=left>1.4998450017251428</td></tr><tr><td align=left>67</td><td align=left>1.4995612278126766</td></tr><tr><td align=left>68</td><td align=left>1.4993166731144414</td></tr><tr><td align=left>69</td><td align=left>1.499031830812627</td></tr><tr><td align=left>70</td><td align=left>1.498806802914833</td></tr><tr><td align=left>71</td><td align=left>1.4985656090426709</td></tr><tr><td align=left>72</td><td align=left>1.498311085994739</td></tr><tr><td align=left>73</td><td align=left>1.4980998089801867</td></tr><tr><td align=left>74</td><td align=left>1.4978614270801778</td></tr><tr><td align=left>75</td><td align=left>1.4976461613303127</td></tr><tr><td align=left>76</td><td align=left>1.497450811659424</td></tr><tr><td align=left>77</td><td align=left>1.4972614163628544</td></tr><tr><td align=left>78</td><td align=left>1.497019612065497</td></tr><tr><td align=left>79</td><td align=left>1.496874216833877</td></tr><tr><td align=left>80</td><td align=left>1.4966283982987492</td></tr><tr><td align=left>81</td><td align=left>1.4964878123374772</td></tr><tr><td align=left>82</td><td align=left>1.4962757052242632</td></tr><tr><td align=left>83</td><td align=left>1.496149471166867</td></tr><tr><td align=left>84</td><td align=left>1.4959392546341381</td></tr><tr><td align=left>85</td><td align=left>1.4957683906834602</td></tr><tr><td align=left>86</td><td align=left>1.4956060922384664</td></tr><tr><td align=left>87</td><td align=left>1.4954645049047413</td></tr><tr><td align=left>88</td><td align=left>1.495307563560535</td></tr><tr><td align=left>89</td><td align=left>1.4951503339020875</td></tr><tr><td align=left>90</td><td align=left>1.49500530886384</td></tr><tr><td align=left>91</td><td align=left>1.4948486175521838</td></tr><tr><td align=left>92</td><td align=left>1.494716574686503</td></tr><tr><td align=left>93</td><td align=left>1.4946021151410946</td></tr><tr><td align=left>94</td><td align=left>1.4944505753829063</td></tr><tr><td align=left>95</td><td align=left>1.4942998891427248</td></tr><tr><td align=left>96</td><td align=left>1.494198277219056</td></tr><tr><td align=left>97</td><td align=left>1.4940563287162394</td></tr><tr><td align=left>98</td><td align=left>1.4939476227923159</td></tr><tr><td align=left>99</td><td align=left>1.493783721728854</td></tr><tr><td align=left>100</td><td align=left>1.4937221140129977</td></tr></tbody></table><h3 id=results-for-huge-n>Results for huge n</h3><p>I have also calculated <span class="math inline">\(C_n\)</span> for some bigger sample sizes:</p><table><thead><tr><th align=left>n</th><th align=left><span class="math inline">\(C_n\)</span></th></tr></thead><tbody><tr><td align=left>100</td><td align=left>1.4937221140129977</td></tr><tr><td align=left>110</td><td align=left>1.492629467879562</td></tr><tr><td align=left>120</td><td align=left>1.491756950186543</td></tr><tr><td align=left>130</td><td align=left>1.4910176116133274</td></tr><tr><td align=left>140</td><td align=left>1.4903922085488397</td></tr><tr><td align=left>150</td><td align=left>1.4898464598871315</td></tr><tr><td align=left>200</td><td align=left>1.487963070934298</td></tr><tr><td align=left>250</td><td align=left>1.4868507636216115</td></tr><tr><td align=left>300</td><td align=left>1.4861201577554497</td></tr><tr><td align=left>350</td><td align=left>1.4855909210465295</td></tr><tr><td align=left>400</td><td align=left>1.4852251546501989</td></tr><tr><td align=left>450</td><td align=left>1.4849172381877342</td></tr><tr><td align=left>500</td><td align=left>1.4846796356493557</td></tr><tr><td align=left>1000</td><td align=left>1.4836281802634783</td></tr><tr><td align=left>1500</td><td align=left>1.4832857748830472</td></tr><tr><td align=left>2000</td><td align=left>1.4831139879531638</td></tr><tr><td align=left>2500</td><td align=left>1.4830091511037906</td></tr><tr><td align=left>3000</td><td align=left>1.4829398344041957</td></tr><tr><td align=left>3500</td><td align=left>1.4828931807149206</td></tr><tr><td align=left>4000</td><td align=left>1.4828555508375267</td></tr><tr><td align=left>4500</td><td align=left>1.4828287173605137</td></tr></tbody></table><p>Following the approach from <a href=#Park2020>[Park2020]</a>, we express <span class="math inline">\(C_n\)</span> using the following equation:</p><p><span class="math display">\[C_n = \frac{1}{\Phi^{-1}(3/4) \cdot (1 - \alpha / n - \beta / n^2)}
\]</span></p><p>With the help of linear regression, we get the following values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(beta\)</span>:</p><p><span class="math display">\[\alpha \approx 0.69, \quad \beta = 5.14.
\]</span></p><p>Here is a plot with both actual and predicted values of <span class="math inline">\(C_n\)</span> for different sample sizes:</p><div class=row><div class=mx-auto><a href=/posts/unbiased-mad-thd/img/factors-light.png target=_blank class=imgldlink alt=factors><picture><source theme=dark srcset=/posts/unbiased-mad-thd/img/factors-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/unbiased-mad-thd/img/factors-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/unbiased-mad-thd/img/factors-light.png></picture></a></div></div><br><h3 id=references>References</h3><ul><li><b id=Box1958>[Box1958]</b><br>Box, George EP. &ldquo;A note on the generation of random normal deviates.&rdquo; Ann. Math. Statist. 29 (1958): 610-611.<br><a href=https://doi.org/10.1214/aoms/1177706645>https://doi.org/10.1214/aoms/1177706645</a></li><li><b id=Park2020>[Park2020]</b><br>Park, Chanseok, Haewon Kim, and Min Wang. &ldquo;Investigation of finite-sample properties of robust location and scale estimators.&rdquo; Communications in Statistics-Simulation and Computation (2020): 1-27.<br><a href=https://doi.org/10.1080/03610918.2019.1699114>https://doi.org/10.1080/03610918.2019.1699114</a></li></ul><br><br><div class=row><div class="justify-content-center share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2funbiased-mad-thd%2f&title=Unbiased%20median%20absolute%20deviation%20based%20on%20the%20trimmed%20Harrell-Davis%20quantile%20estimator" target=_blank title="Share on Reddit"><svg class="fai"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Unbiased%20median%20absolute%20deviation%20based%20on%20the%20trimmed%20Harrell-Davis%20quantile%20estimator&url=https%3a%2f%2faakinshin.net%2fposts%2funbiased-mad-thd%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2funbiased-mad-thd%2f" target=_blank title="Share on HackerNews"><svg class="fai"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2funbiased-mad-thd%2f&title=Unbiased%20median%20absolute%20deviation%20based%20on%20the%20trimmed%20Harrell-Davis%20quantile%20estimator" target=_blank title="Add to Pocket"><svg class="fai"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><hr></div></div></main></div><footer class="blog-footer mt-auto"><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><svg class="fai"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a><a href=https://twitter.com/andrey_akinshin><svg class="fai"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a><a href=https://aakinshin.net/posts/index.xml><svg class="fai"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a>|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://aakinshin.net/js/theme-after.min.29520a8e1176193da7ea4e6cb56cf9b3e634b867c9979234d8dafb5ab61dd494.js></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>