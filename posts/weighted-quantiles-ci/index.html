<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Research: Weighted quantile estimators,Quantile,Confidence Interval"><title>Quantile confidence intervals for weighted samples | Andrey Akinshin</title><meta name=description content="How to modify the Maritz-Jarrett method to estimate confidence intervals around given quantiles on weighted samples"><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.e75ae85f116f2518a5f5161199a56c6e1ec12c760cdaf78f0d207d929fce8839.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Quantile confidence intervals for weighted samples</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2020-12-08>December 8, 2020</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/research-wqe/>Research: Weighted quantile estimators</a>
<a class=label-link href=https://aakinshin.net/tags/quantile/>Quantile</a>
<a class=label-link href=https://aakinshin.net/tags/confidence-interval/>Confidence Interval</a></div></div><br><div class="main-content mb-3 px-2 py-1 rounded border text-alert-text-l border-alert-frame-l dark:text-alert-text-d dark:border-alert-frame-d">Update: this blog post is a part of research that aimed to build weighed versions of various quantile estimators. A <a href=/posts/preprint-wqe/>preprint with final results</a> is available on arXiv: <a href=https://arxiv.org/abs/2304.07265>arXiv:2304.07265 [stat.ME]</a>. Some information in this blog post can be obsolete: please, use the preprint as the primary reference.</div><div class=main-content><p><strong>Update 2021-07-06:
the approach was updated using the <a href=https://aakinshin.net/posts/kish-ess-weighted-quantiles/>Kish&rsquo;s effective sample size</a>.</strong></p><p>When you work with non-parametric distributions,
quantile estimations are essential to get the main distribution properties.
Once you get the estimation values, you may be interested in measuring the accuracy of these estimations.
Without it, it&rsquo;s hard to understand how trustable the obtained values are.
One of the most popular ways to evaluate accuracy is confidence interval estimation.</p><p>Now imagine that you collect some measurements every day.
Each day you get a small sample of values that is not enough to get the accurate daily quantile estimations.
However, the full time-series over the last several weeks has a decent size.
You suspect that past measurements should be similar to today measurements,
but you are not 100% sure about it.
You feel a temptation to extend the up-to-date sample by the previously collected values,
but it may spoil the estimation (e.g., in the case of recent change points or positive/negative trends).</p><p>One of the possible approaches in this situation is to use <em>weighted samples</em>.
This assumes that we add past measurements to the &ldquo;today sample,&rdquo;
but these values should have smaller weight.
The older measurement we take, the smaller weight it gets.
If you have consistent values across the last several days,
this approach works like a charm.
If you have any recent changes, you can detect such situations by huge confidence intervals
due to the sample inconsistency.</p><p>So, how do we estimate confidence intervals around quantiles for the weighted samples?
In one of the previous posts, I have already shown how to <a href=https://aakinshin.net/posts/weighted-quantiles/>estimate quantiles on weighted samples</a>.
In this post, I will show how to estimate quantile confidence intervals for weighted samples.</p><h3 id=quantile-confidence-interval-estimators>Quantile confidence interval estimators</h3><p>There are many different ways to estimate quantiles.
Here are some of the popular approaches:</p><ul><li><strong>Density estimation</strong><br>The exact equation for the standard error of the <span class="math inline">\(p^\textrm{th}\)</span> quantile is well-known,
it equals <span class="math inline">\(\sqrt{p(1-p)}/(\sqrt{n} f(q_p))\)</span> where <span class="math inline">\(f\)</span> is the <a href=https://en.wikipedia.org/wiki/Probability_density_function>probability density function</a>.
Unfortunately, this equation <a href=https://xkcd.com/688/>requires the knowledge</a>
of the density function, which we are actually trying to estimate using quantile.
Although we can still try to estimate it in different ways.
For example, we can use Rosenblatt&rsquo;s shifted histogram (see <a href=#Wilcox2017>[Wilcox2017]</a>).
However, these approaches don&rsquo;t provide good confidence interval estimation on non-normal distribution.</li><li><strong>Bootstrap</strong><br>I&rsquo;m not a fan of the <a href=https://en.wikipedia.org/wiki/Bootstrapping_(statistics)>bootstrap</a> method.
Firstly, it uses randomization, so its results are not repeatable by default.
Secondly, it&rsquo;s often inefficient: you should spend some time to get reasonable estimations.
Finally, it works poorly on small samples.
While bootstrapping is a good option when you don&rsquo;t have any alternatives,
but we will try to find a better approach.</li><li><strong>Jackknife</strong><br>In comparison with bootstrap, the <a href=https://en.wikipedia.org/wiki/Jackknife_resampling>jackknife</a>
doesn&rsquo;t have the repeatability problem and can be used to estimate different distribution parameters.
However, it works poorly in the case of quantile estimation (e.g., see <a href=#Martin1990>[Martin1990]</a>)</li></ul><p>I tried different variations of the above approaches,
but I wasn&rsquo;t satisfied with the results.
Based on my experience, the most optimal approach in terms of accuracy and performance
is <strong>the Maritz-Jarrett method</strong> (<a href=#Maritz1979>[Maritz1979]</a>).
Also, it works as a natural extension of the Harrell-Davis quantile estimator (<a href=#Harrell1982>[Harrell1982]</a>)
which is my favorite way to estimate quantiles.
Let&rsquo;s discuss how we can adopt the Maritz-Jarrett method to the weighted samples.</p><h3 id=the-maritz-jarrett-method>The Maritz-Jarrett method</h3><p>First of all, let&rsquo;s introduce the following notation:</p><ul><li><span class="math inline">\(x = \{ x_1, x_2, \ldots x_n \}\)</span>: original sample. Assuming that it&rsquo;s always contain sorted real numbers.</li><li><span class="math inline">\(w = \{ w_1, w_2, \ldots w_n \}\)</span>: a vector of weights. It has the same length as <span class="math inline">\(x\)</span>. Assuming <span class="math inline">\(w_i \geq 0\)</span>, <span class="math inline">\(\sum_{i=1}^n w > 0\)</span>.</li><li><span class="math inline">\(s_i(w)\)</span>: partial sum of weights, <span class="math inline">\(s_i(w) = \sum_{j=1}^{i} w_j\)</span>. Assuming <span class="math inline">\(s_0(w) = 0\)</span>.</li><li><span class="math inline">\(q_p\)</span>: estimation of the <span class="math inline">\(p^\textrm{th}\)</span> quantile based on <span class="math inline">\(x\)</span>.</li></ul><p>Next, let&rsquo;s recall the basic equations of the Harrell-Davis quantile estimator:</p><p><span class="math display">\[q_p = \sum_{i=1}^{n} W_{n,i} \cdot x_i,\quad
W_{n,i} = I_{r_i}(a, b) - I_{l_i}(a, b),
\]</span></p><p>where</p><ul><li><span class="math inline">\(I_t(a, b)\)</span> is the <a href=https://en.wikipedia.org/wiki/Beta_function#Incomplete_beta_function>regularized incomplete beta function</a>,</li><li><span class="math inline">\(a = p \cdot (n + 1), \;\; b = (1-p) \cdot (n + 1)\)</span>,</li><li><span class="math inline">\(l_i = (i - 1) / n, \;\; r_i = i / n\)</span>.</li></ul><p>Now we introduce notation for the <span class="math inline">\(k^\textrm{th}\)</span> <a href=https://en.wikipedia.org/wiki/Moment_(mathematics)>moment</a> of the <span class="math inline">\(p^\textrm{th}\)</span> quantile:</p><p><span class="math display">\[C_k = \sum_{i=1}^n W_{n,i} \cdot x_i^k
\]</span></p><p>Thus, <span class="math inline">\(p^\textrm{th}\)</span> quantile estimation <span class="math inline">\(q_p\)</span> is just the first moment <span class="math inline">\(C_1\)</span>.</p><p>Using the first and the second moments, we can express the standard error as:</p><p><span class="math display">\[s_{q_p} = \sqrt{C_2 - C_1^2}
\]</span></p><p>Here we apply the same idea that we use to express the variance of <span class="math inline">\(X\)</span> as the difference between
the mean of the square of <span class="math inline">\(X\)</span> and the square of the mean of <span class="math inline">\(X\)</span>:</p><p><span class="math display">\[\begin{align}
\operatorname{Var}(X) &= \operatorname{E}\left[(X - \operatorname{E}[X])^2\right] \\
&= \operatorname{E}\left[X^2 - 2X\operatorname{E}[X] + \operatorname{E}[X]^2\right] \\
&= \operatorname{E}\left[X^2\right] - 2\operatorname{E}[X]\operatorname{E}[X] + \operatorname{E}[X]^2 \\
&= \operatorname{E}\left[X^2 \right] - \operatorname{E}[X]^2
\end{align}
\]</span></p><h3 id=the-weighted-version-of-the-maritz-jarrett-method>The weighted version of the Maritz-Jarrett method</h3><p>To adopt the Maritz-Jarrett method to the weighted samples,
we can use <a href=https://aakinshin.net/posts/weighted-quantiles/>the same trick</a> we used for the Harrell-Davis quantile estimator (see <a href=#Harrell1982>[Harrell1982]</a>).
First, we should replace the sample size by the weighted sample size using the <a href=https://aakinshin.net/posts/kish-ess-weighted-quantiles/>Kish&rsquo;s effective sample size</a>:</p><p><span class="math display">\[n^* = \frac{\Big( \sum_{i=1}^n w_i \Big)^2}{\sum_{i=1}^n w_i^2 }.
\]</span></p><p>Next, we should redefine <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> as follows:</p><p><span class="math display">\[\left\{
\begin{array}{rccl}
a^* = & p     & \cdot & (n^* + 1),\\
b^* = & (1-p) & \cdot & (n^* + 1).
\end{array}
\right.
\]</span></p><p>The segment borders of <span class="math inline">\(I_t(a, b)\)</span> should be updated as well:</p><p><span class="math display">\[\left\{
\begin{array}{rcc}
l^*_i & = & \dfrac{s_{i-1}(w)}{s_n(w)},\\
r^*_i & = & \dfrac{s_i(w)}{s_n(w)}.
\end{array}
\right.
\]</span></p><p>With all the replacements, we get a version of Harrell-Davis quantile estimator adopted for the weighted case:</p><p><span class="math display">\[q^*_p = \sum_{i=1}^{n} W^*_{n,i} \cdot x_i,\quad
W^*_{n,i} = I_{r^*_i}(a^*, b^*) - I_{l^*_i}(a^*, b^*).
\]</span></p><p>At this point, we can introduce a generalized version of the quantile moments:</p><p><span class="math display">\[C^*_k = \sum_{i=1}^n W^*_{n,i} \cdot x_i^k
\]</span></p><p>Finally, we get the formula for the standard error in the weighted case:</p><p><span class="math display">\[s^*_{q_p} = \sqrt{C^*_2 - (C^*_1)^2}
\]</span></p><h3 id=building-the-confidence-interval>Building the confidence interval</h3><p>Based on the given sample, we can get only an estimation of the quantile standard error
instead of the true standard error.
It means that it would be better to use the Student&rsquo;s t-distribution to estimate
the confidence interval instead of the normal distribution.</p><p>Since we have a weighted sample, we should also use the weighted sample size <span class="math inline">\(n^*\)</span>
instead of the original sample size <span class="math inline">\(n\)</span> to determine the degree of freedom:</p><p><span class="math display">\[\nu^* = n^* - 1.
\]</span></p><p>Thus, the confidence interval with confidence level <span class="math inline">\(\alpha\)</span> may be estimated as follows:</p><p><span class="math display">\[q^*_p \pm t_{\alpha, \nu^*} s^*_{q_p}
\]</span></p><h3 id=reference-implementation>Reference implementation</h3><p>If you use R, here are functions that you can use in your scripts:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>mj</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>weights</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>alpha</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nf>if </span><span class=p>(</span><span class=nf>any</span><span class=p>(</span><span class=nf>is.na</span><span class=p>(</span><span class=n>weights</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>weights</span> <span class=o>&lt;-</span> <span class=nf>rep</span><span class=p>(</span><span class=m>1</span> <span class=o>/</span> <span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>indexes</span> <span class=o>&lt;-</span> <span class=nf>order</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>&lt;-</span> <span class=n>x[indexes]</span>
</span></span><span class=line><span class=cl>  <span class=n>weights</span> <span class=o>&lt;-</span> <span class=n>weights[indexes]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>nw</span> <span class=o>&lt;-</span> <span class=nf>sum</span><span class=p>(</span><span class=n>weights</span><span class=p>)</span><span class=n>^2</span> <span class=o>/</span> <span class=nf>sum</span><span class=p>(</span><span class=n>weights^2</span><span class=p>)</span> <span class=c1># Kish&#39;s effective sample size</span>
</span></span><span class=line><span class=cl>  <span class=n>a</span> <span class=o>&lt;-</span> <span class=n>p</span> <span class=o>*</span> <span class=p>(</span><span class=n>nw</span> <span class=o>+</span> <span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>b</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=m>1</span> <span class=o>-</span> <span class=n>p</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>nw</span> <span class=o>+</span> <span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>cdfs.probs</span> <span class=o>&lt;-</span> <span class=nf>cumsum</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>weights</span> <span class=o>/</span> <span class=nf>sum</span><span class=p>(</span><span class=n>weights</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=n>cdfs</span> <span class=o>&lt;-</span> <span class=nf>pbeta</span><span class=p>(</span><span class=n>cdfs.probs</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>W</span> <span class=o>&lt;-</span> <span class=nf>tail</span><span class=p>(</span><span class=n>cdfs</span><span class=p>,</span> <span class=m>-1</span><span class=p>)</span> <span class=o>-</span> <span class=nf>head</span><span class=p>(</span><span class=n>cdfs</span><span class=p>,</span> <span class=m>-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>c1</span> <span class=o>&lt;-</span> <span class=nf>sum</span><span class=p>(</span><span class=n>W</span> <span class=o>*</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>c2</span> <span class=o>&lt;-</span> <span class=nf>sum</span><span class=p>(</span><span class=n>W</span> <span class=o>*</span> <span class=n>x^2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>se</span> <span class=o>&lt;-</span> <span class=nf>sqrt</span><span class=p>(</span><span class=n>c2</span> <span class=o>-</span> <span class=n>c1^2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>estimation</span> <span class=o>&lt;-</span> <span class=n>c1</span>
</span></span><span class=line><span class=cl>  <span class=n>margin</span> <span class=o>&lt;-</span> <span class=n>se</span> <span class=o>*</span> <span class=nf>qt</span><span class=p>(</span><span class=m>1</span> <span class=o>-</span> <span class=p>(</span><span class=m>1</span> <span class=o>-</span> <span class=n>alpha</span><span class=p>)</span> <span class=o>/</span> <span class=m>2</span><span class=p>,</span> <span class=n>df</span> <span class=o>=</span> <span class=n>nw</span> <span class=o>-</span> <span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nf>c</span><span class=p>(</span><span class=n>estimation</span> <span class=o>-</span> <span class=n>margin</span><span class=p>,</span> <span class=n>estimation</span> <span class=o>+</span> <span class=n>margin</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>If you use C#, you can take an implementation from
the latest nightly version (0.3.0-nightly.72+) of <a href=https://github.com/AndreyAkinshin/perfolizer>Perfolizer</a>
(you need <code>HarrellDavisQuantileEstimator</code>).</p><h3 id=references>References</h3><ul><li><b id=Harrell1982>[Harrell1982]</b><br>Harrell, F.E. and Davis, C.E., 1982. A new distribution-free quantile estimator.
<em>Biometrika</em>, 69(3), pp.635-640.<br><a href=https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf>https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf</a></li><li><b id=Maritz1979>[Maritz1979]</b><br>Maritz, J. S., and R. G. Jarrett. 1978.
“A Note on Estimating the Variance of the Sample Median.”
Journal of the American Statistical Association 73 (361): 194–196.<br><a href=https://doi.org/10.1080/01621459.1978.10480027>https://doi.org/10.1080/01621459.1978.10480027</a></li><li><b id=Wilcox2017>[Wilcox2017]</b><br>Wilcox, Rand R. 2017. Introduction to Robust Estimation and Hypothesis Testing. 4th edition. Waltham, MA: Elsevier. ISBN 978-0-12-804733-0</li><li><b id=Martin1990>[Martin1990]</b><br>Martin, Michael A. &ldquo;On using the jackknife to estimate quantile variance.&rdquo; Canadian Journal of Statistics 18, no. 2 (1990): 149-153.</li></ul></div><br><br><div class="flex flex-wrap justify-center items-center">The source code of this post and all the relevant files are&nbsp;<a href=https://github.com/AndreyAkinshin/aakinshin.net/tree/master/content/en/posts/2020/12/weighted-quantiles-ci/index.md>available on GitHub</a>.</div><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fweighted-quantiles-ci%2f&title=Quantile%20confidence%20intervals%20for%20weighted%20samples" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Quantile%20confidence%20intervals%20for%20weighted%20samples&url=https%3a%2f%2faakinshin.net%2fposts%2fweighted-quantiles-ci%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fweighted-quantiles-ci%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fweighted-quantiles-ci%2f&title=Quantile%20confidence%20intervals%20for%20weighted%20samples" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2023 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>