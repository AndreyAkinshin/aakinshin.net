<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Quantiles,MAD,Research: Quantile absolute deviation,Dispersion,Harrell-Davis quantile estimator"><title>Quantile absolute deviation: estimating statistical dispersion around quantiles | Andrey Akinshin</title><meta name=description content="Quantile absolute deviation allows estimating statistical dispersion around the given quantile"><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><meta name=og:image content="https://aakinshin.net/posts/qad/img/modal5-light.png"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.00b1604219597584f1a9abe4b2d4de199357afca35ce8637e05eff220ee75867.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Quantile absolute deviation: estimating statistical dispersion around quantiles</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2020-12-01>December 1, 2020</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/quantiles/>Quantiles</a>
<a class=label-link href=https://aakinshin.net/tags/mad/>MAD</a>
<a class=label-link href=https://aakinshin.net/tags/research-qad/>Research: Quantile absolute deviation</a>
<a class=label-link href=https://aakinshin.net/tags/dispersion/>Dispersion</a>
<a class=label-link href=https://aakinshin.net/tags/harrell-davis-quantile-estimator/>Harrell-Davis quantile estimator</a></div></div><br><div class="main-content mb-3 px-2 py-1 rounded border text-alert-text-l border-alert-frame-l dark:text-alert-text-d dark:border-alert-frame-d">Update: this blog post is a part of research that aimed to build a new measure of statistical dispersion called quantile absolute deviation. A <a href=/posts/preprint-qad/>preprint with final results</a> is available on arXiv: <a href=https://arxiv.org/abs/2208.13459>arXiv:2208.13459 [stat.ME]</a>. Some information in this blog post can be obsolete: please, use the preprint as the primary reference.</div><div class=main-content><p>There are many different metrics for <a href=https://en.wikipedia.org/wiki/Statistical_dispersion>statistical dispersion</a>.
The most famous one is the <a href=https://en.wikipedia.org/wiki/Standard_deviation>standard deviation</a>.
The standard deviation is the most popular way to describe the spread around the mean when
you work with normally distributed data.
However, if you work with non-normal distributions, this metric may be misleading.</p><p>In the world of non-parametric distributions,
the most common measure of <a href=https://en.wikipedia.org/wiki/Central_tendency>central tendency</a> is the median.
For the median, you can describe dispersion using the
<a href=https://en.wikipedia.org/wiki/Median_absolute_deviation>median absolute deviation around the median</a> (MAD).
It works great if the median is the only <a href=https://en.wikipedia.org/wiki/Summary_statistics>summary statistic</a> that you care about.
However, if you work with multimodal distributions
(they can be detected using the <a href=https://aakinshin.net/posts/lowland-multimodality-detection/>lowland multimodality detector</a>),
you may be interested in other quantiles as well.
So, it makes sense to learn how to describe dispersion around the given quantile.
Which metric should we choose?</p><p>Recently, I came up with a great solution to this problem.
We can generalize the median absolute deviation into the quantile absolute deviation (QAD) around the given quantile based on the Harrell-Davis quantile estimator.
I will show how to calculate it, how to interpret it, and how to get insights about distribution properties
from images like this one:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal5-light.png target=_blank alt=modal5><img src=/posts/qad/img/modal5-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal5-dark.png target=_blank alt=modal5><img src=/posts/qad/img/modal5-dark.png width=800></a></div><h3 id=median-absolute-deviation-around-the-median>Median absolute deviation around the median</h3><p>Let&rsquo;s start with the classic definition for the median absolute deviation around the median:</p><p><span class="math display">\[\mathcal{MAD}(x) = C \cdot \textrm{median}(|x_i - \textrm{median}(x)|).
\]</span></p><p>Here <span class="math inline">\(C\)</span> is a scale factor.
Typically, <span class="math inline">\(C \approx 1.4826\)</span> to use <span class="math inline">\(\mathcal{MAD}\)</span> a consistent estimator for the estimation of the standard deviation in the case of the normal distribution.
In the scope of this post, there is no need to be consistent with other dispersion metrics,
so you can assume that <span class="math inline">\(C = 1\)</span>.</p><p>When people use the <span class="math inline">\(\mathcal{MAD}\)</span>, they usually forget to pay attention to the quantile estimator that
is used to calculate the median.
Meanwhile, the quantile estimator heavily affects the <a href=https://en.wikipedia.org/wiki/Efficiency_(statistics)>efficiency</a> of the final version.
For further discussion, let&rsquo;s use the Harrell-Davis quantile estimator (<a href=#Harrell1982>[Harrell1982]</a>)
because it&rsquo;s one of the most smooth and efficient options.</p><p>One of the most important properties of the <span class="math inline">\(\mathcal{MAD}\)</span> you should know:
the range <span class="math inline">\([\textrm{median}(x) - \mathcal{MAD}(x); \textrm{median}(x) + \mathcal{MAD}(x)]\)</span>
contains 50% of the distribution:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/gumbel-mad-light.png target=_blank alt=gumbel-mad><img src=/posts/qad/img/gumbel-mad-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/gumbel-mad-dark.png target=_blank alt=gumbel-mad><img src=/posts/qad/img/gumbel-mad-dark.png width=800></a></div><p>For better understanding,
you can check out <a href=(https://aakinshin.net/posts/gumbel-mad/)>an example</a> of
how to calculate the exact value of the <span class="math inline">\(\mathcal{MAD}\)</span> for the Gumbel distribution.</p><h3 id=median-absolute-deviation-around-quantiles>Median absolute deviation around quantiles</h3><p>The above formula looks great for the median, but what if we want to describe dispersion for a quantile?
By analogy, we can build the median absolute deviation around the <span class="math inline">\(p^{\textrm{th}}\)</span> quantile:</p><p><span class="math display">\[\mathcal{MAD}(x, p) = C \cdot \textrm{median}(|x_i - Q(x, p)|),
\]</span></p><p>where <span class="math inline">\(Q(x; p)\)</span> is the <span class="math inline">\(p^{\textrm{th}}\)</span> quantile of <span class="math inline">\(x\)</span>.</p><p>It works similar way as the classic <span class="math inline">\(\mathcal{MAD}\)</span> around the median:
the interval <span class="math inline">\([Q(x, p) - \mathcal{MAD}(x, p); Q(x, p) + \mathcal{MAD}(x, p)]\)</span>
contains exactly 50% of the distribution.</p><p>That&rsquo;s how it looks for the unimodal case (the density plot is shown using the <a href=https://aakinshin.net/posts/qrde-hd/>quantile-respectful density estimation based on the Harrell-Davis quantile estimator</a> (QRDE-HD)):</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/mad-unimodal-light.svg target=_blank alt=mad-unimodal><img src=/posts/qad/img/mad-unimodal-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/mad-unimodal-dark.svg target=_blank alt=mad-unimodal><img src=/posts/qad/img/mad-unimodal-dark.svg width=800></a></div><p>You may notice that the deviation for the lower and upper quantiles are much larger than
the deviation for the median.
It&rsquo;s a nice feature of this metric because it correlates with the estimator errors.
Indeed, it&rsquo;s hard to estimate extreme quantiles with high accuracy,
and the errors are usually pretty large.</p><p>Now let&rsquo;s add a few outliers and check out the updated <span class="math inline">\(\mathcal{MAD}(x, p)\)</span> plot:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/mad-unimodal-outliers-light.svg target=_blank alt=mad-unimodal-outliers><img src=/posts/qad/img/mad-unimodal-outliers-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/mad-unimodal-outliers-dark.svg target=_blank alt=mad-unimodal-outliers><img src=/posts/qad/img/mad-unimodal-outliers-dark.svg width=800></a></div><p>We can see that the deviation for the extreme upper quantiles is much larger than the other <span class="math inline">\(\mathcal{MAD}(x, p)\)</span> values.
It&rsquo;s also an expected effect: when we have a few upper outliers,
it&rsquo;s tough to estimate the upper quantiles.</p><p>We have a similar situation for skewed distributions:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/mad-skewed-light.svg target=_blank alt=mad-skewed><img src=/posts/qad/img/mad-skewed-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/mad-skewed-dark.svg target=_blank alt=mad-skewed><img src=/posts/qad/img/mad-skewed-dark.svg width=800></a></div><h3 id=quantile-absolute-deviation-around-quantiles>Quantile absolute deviation around quantiles</h3><p>Now it&rsquo;s time to make the final step toward generalizations.
In the previous section, we took the median of <span class="math inline">\(|x_i - Q(x, p)|\)</span> to describe
the dispersion around the given quantile.
Can we estimate another quantile of <span class="math inline">\(|x_i - Q(x, p)|\)</span> instead of the median?
Of course, we can!
Let&rsquo;s introduce the <em>quantile absolute deviation around the given quantile</em>:</p><p><span class="math display">\[\mathcal{QAD}(x, p, q) = C \cdot Q(|x_i - Q(x, p)|, q).
\]</span></p><p>In the equation, we take <span class="math inline">\(q^{\textrm{th}}\)</span> quantile of <span class="math inline">\(|x_i - Q(x, p)|\)</span>.
This value also describes the dispersion around the <span class="math inline">\(p^{\textrm{th}}\)</span> quantile of <span class="math inline">\(x\)</span> similar to <span class="math inline">\(\mathcal{MAD}(x, p)\)</span>,
but it captures another interval of the distribution.
To be more specific, <span class="math inline">\([Q(x, p) - \mathcal{QAD}(x, p, q); Q(x, p) + \mathcal{QAD}(x, p, q)]\)</span>
contains <span class="math inline">\((q*100)\%\)</span> of the whole distribution.</p><p>The <span class="math inline">\(\mathcal{QAD}\)</span> is especially useful when we work with multimodal distribution.
Let&rsquo;s look at <span class="math inline">\(\mathcal{QAD}(x, p, q)\)</span> for <span class="math inline">\(q \in {0.25, 0.5, 0.75}\)</span> in the bimodal case:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/qad-modal2-light.svg target=_blank alt=qad-modal2><img src=/posts/qad/img/qad-modal2-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/qad-modal2-dark.svg target=_blank alt=qad-modal2><img src=/posts/qad/img/qad-modal2-dark.svg width=800></a></div><p>Here we can see that the median absolute deviation around the median
(<span class="math inline">\(\mathcal{MAD}(x, 0.5) = \mathcal{QAD}(x, 0.5, 0.5)\)</span>)
is much lower than the median absolute deviation around lower and upper quantiles
(corner points of the <span class="math inline">\(\mathcal{QAD}(x, p, 0.5)\)</span> plot).
It&rsquo;s doesn&rsquo;t actually meet our expectations.
Indeed, the perfectly bimodal distribution is the worst case for the median estimation.
Classic quantile estimators based on linear interpolation are incapable of estimating the median correctly because there are no sample elements around the true median value.
The Harrell-Davis quantile estimator solves this problem much better,
but the accuracy level is still low.
Thus, we may expect that the deviation around the median (and the estimation errors) should be high.
These expectation may be satisfied using <span class="math inline">\(\mathcal{QAD}(x, 0.5, 0.25)\)</span>
which has the global maximum that matches the median.</p><p>On the other hand, <span class="math inline">\(\mathcal{QAD}(x, p, 0.75)\)</span> is also may be useful.
It captures 75% of the distribution, so it has a higher value at the mode values.
We can see that <span class="math inline">\(\mathcal{QAD}(x, 0.25, 0.75)\)</span> is much larger than <span class="math inline">\(\mathcal{QAD}(x, 0.5, 0.75)\)</span>.
Thus, <span class="math inline">\(\mathcal{QAD}(x, p, 0.75)\)</span> is trying to say that the distance from the first mode to another one
is larger than the distance from the median to the nearest mode.
Using the <span class="math inline">\(\mathcal{QAD}(x, p, q)\)</span> plots for different <span class="math inline">\(q\)</span> values, we can get different insights about
the distribution properties.
Try to do it yourself with the trimodal distribution:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/qad-modal3-light.svg target=_blank alt=qad-modal3><img src=/posts/qad/img/qad-modal3-light.svg width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/qad-modal3-dark.svg target=_blank alt=qad-modal3><img src=/posts/qad/img/qad-modal3-dark.svg width=800></a></div><p>Of course, it&rsquo;s not very convenient to manually enumerate different values of <span class="math inline">\(q\)</span> and look at dozens of plots.
We need one more way to visualize the quantile absolute deviation to discover its true power.</p><h3 id=heatmap-for-quantile-absolute-deviation-around-quantiles>Heatmap for Quantile absolute deviation around quantiles</h3><p>For the given <span class="math inline">\(x\)</span>, <span class="math inline">\(\mathcal{QAD}(x, p, q)\)</span> is a function parameterized by two variables <span class="math inline">\(p, q \in [0; 1]\)</span>.
One of the most popular ways to visualize such functions is the <a href=https://en.wikipedia.org/wiki/Heat_map>heatmap</a>.
It&rsquo;s also convenient to introduce several levels on this heatmap to highlight regions with the same value.
I did a lot of experiments and came to the conclusion that
I get the most insightful pictures using 20 levels.
To split the whole range of <span class="math inline">\(\mathcal{QAD}\)</span> values to sub-intervals, we can use
<a href=https://en.wiktionary.org/wiki/ventile>ventiles</a> (20-quantiles).
To get the ventile values, we use the Harrell-Davis quantile estimator one more time to get
a smoother picture.</p><p>Consider a bimodal distribution:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal2-den-light.png target=_blank alt=modal2-den><img src=/posts/qad/img/modal2-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal2-den-dark.png target=_blank alt=modal2-den><img src=/posts/qad/img/modal2-den-dark.png width=800></a></div><p>For this distribution, we get the following <span class="math inline">\(\mathcal{QAD}\)</span> heatmap:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal2-light.png target=_blank alt=modal2><img src=/posts/qad/img/modal2-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal2-dark.png target=_blank alt=modal2><img src=/posts/qad/img/modal2-dark.png width=800></a></div><p>I made a lot of attempts trying to explain in the text form how to interpret such pictures.
Unfortunately, I failed.
I just don&rsquo;t know how to express its internal beauty and the insightfulness of all the small details.</p><p>If you want to learn how to get benefits from such a visualization,
just try to look at the different <span class="math inline">\(\mathcal{QAD}\)</span> heatmaps for a while
and match them with the corresponding density plots.
It should train the neural network inside your brain to work with these pictures.
Below you find a gallery of such heatmaps for different distributions.</p><h3 id=heatmap-gallery>Heatmap gallery</h3><p><strong>A distribution with 1 mode:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal1-den-light.png target=_blank alt=modal1-den><img src=/posts/qad/img/modal1-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal1-den-dark.png target=_blank alt=modal1-den><img src=/posts/qad/img/modal1-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal1-light.png target=_blank alt=modal1><img src=/posts/qad/img/modal1-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal1-dark.png target=_blank alt=modal1><img src=/posts/qad/img/modal1-dark.png width=800></a></div></p><p><strong>A distribution with 2 modes:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal2-den-light.png target=_blank alt=modal2-den><img src=/posts/qad/img/modal2-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal2-den-dark.png target=_blank alt=modal2-den><img src=/posts/qad/img/modal2-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal2-light.png target=_blank alt=modal2><img src=/posts/qad/img/modal2-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal2-dark.png target=_blank alt=modal2><img src=/posts/qad/img/modal2-dark.png width=800></a></div></p><p><strong>A distribution with 3 modes:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal3-den-light.png target=_blank alt=modal3-den><img src=/posts/qad/img/modal3-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal3-den-dark.png target=_blank alt=modal3-den><img src=/posts/qad/img/modal3-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal3-light.png target=_blank alt=modal3><img src=/posts/qad/img/modal3-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal3-dark.png target=_blank alt=modal3><img src=/posts/qad/img/modal3-dark.png width=800></a></div></p><p><strong>A distribution with 4 modes:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal4-den-light.png target=_blank alt=modal4-den><img src=/posts/qad/img/modal4-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal4-den-dark.png target=_blank alt=modal4-den><img src=/posts/qad/img/modal4-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal4-light.png target=_blank alt=modal4><img src=/posts/qad/img/modal4-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal4-dark.png target=_blank alt=modal4><img src=/posts/qad/img/modal4-dark.png width=800></a></div></p><p><strong>A distribution with 5 modes:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal5-den-light.png target=_blank alt=modal5-den><img src=/posts/qad/img/modal5-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal5-den-dark.png target=_blank alt=modal5-den><img src=/posts/qad/img/modal5-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal5-light.png target=_blank alt=modal5><img src=/posts/qad/img/modal5-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal5-dark.png target=_blank alt=modal5><img src=/posts/qad/img/modal5-dark.png width=800></a></div></p><p><strong>A distribution with 10 modes:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal10-den-light.png target=_blank alt=modal10-den><img src=/posts/qad/img/modal10-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal10-den-dark.png target=_blank alt=modal10-den><img src=/posts/qad/img/modal10-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/modal10-light.png target=_blank alt=modal10><img src=/posts/qad/img/modal10-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/modal10-dark.png target=_blank alt=modal10><img src=/posts/qad/img/modal10-dark.png width=800></a></div></p><p><strong>A distribution with lower outliers:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/outliers-lower-den-light.png target=_blank alt=outliers-lower-den><img src=/posts/qad/img/outliers-lower-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/outliers-lower-den-dark.png target=_blank alt=outliers-lower-den><img src=/posts/qad/img/outliers-lower-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/outliers-lower-light.png target=_blank alt=outliers-lower><img src=/posts/qad/img/outliers-lower-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/outliers-lower-dark.png target=_blank alt=outliers-lower><img src=/posts/qad/img/outliers-lower-dark.png width=800></a></div></p><p><strong>A distribution with upper outliers:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/outliers-upper-den-light.png target=_blank alt=outliers-upper-den><img src=/posts/qad/img/outliers-upper-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/outliers-upper-den-dark.png target=_blank alt=outliers-upper-den><img src=/posts/qad/img/outliers-upper-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/outliers-upper-light.png target=_blank alt=outliers-upper><img src=/posts/qad/img/outliers-upper-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/outliers-upper-dark.png target=_blank alt=outliers-upper><img src=/posts/qad/img/outliers-upper-dark.png width=800></a></div></p><p><strong>A distribution with lower and upper outliers:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/outliers-both-den-light.png target=_blank alt=outliers-both-den><img src=/posts/qad/img/outliers-both-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/outliers-both-den-dark.png target=_blank alt=outliers-both-den><img src=/posts/qad/img/outliers-both-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/outliers-both-light.png target=_blank alt=outliers-both><img src=/posts/qad/img/outliers-both-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/outliers-both-dark.png target=_blank alt=outliers-both><img src=/posts/qad/img/outliers-both-dark.png width=800></a></div></p><p><strong>A right-skewed distribution:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/skewed-right-den-light.png target=_blank alt=skewed-right-den><img src=/posts/qad/img/skewed-right-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/skewed-right-den-dark.png target=_blank alt=skewed-right-den><img src=/posts/qad/img/skewed-right-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/skewed-right-light.png target=_blank alt=skewed-right><img src=/posts/qad/img/skewed-right-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/skewed-right-dark.png target=_blank alt=skewed-right><img src=/posts/qad/img/skewed-right-dark.png width=800></a></div></p><p><strong>A left-skewed distribution:</strong></p><p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/skewed-left-den-light.png target=_blank alt=skewed-left-den><img src=/posts/qad/img/skewed-left-den-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/skewed-left-den-dark.png target=_blank alt=skewed-left-den><img src=/posts/qad/img/skewed-left-den-dark.png width=800></a></div><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qad/img/skewed-left-light.png target=_blank alt=skewed-left><img src=/posts/qad/img/skewed-left-light.png width=800></a>
<a class="img-dark hidden" href=/posts/qad/img/skewed-left-dark.png target=_blank alt=skewed-left><img src=/posts/qad/img/skewed-left-dark.png width=800></a></div></p><h3 id=conclusion>Conclusion</h3><p>In this post, I showed how to generalize
the <em>median absolute deviation (<span class="math inline">\(\mathcal{MAD}\)</span>) around the median</em> to
the <em>quantile absolute deviation (<span class="math inline">\(\mathcal{QAD}\)</span>) around the given quantile</em>.
We discussed a few kinds of insightful visualization that may help you understand
the nature of this metric.</p><p>I believe that the <span class="math inline">\(\mathcal{QAD}\)</span> is a powerful way to describe the statistical dispersion around the given quantile.
In future blog posts, I will show how to use it to describe the overall distribution properties
and how to use it to determine the quantile estimation errors.</p><h3 id=references>References</h3><ul><li><b id=Harrell1982>[Harrell1982]</b><br>Harrell, F.E. and Davis, C.E., 1982. A new distribution-free quantile estimator.
<em>Biometrika</em>, 69(3), pp.635-640.<br><a href=https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf>https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf</a></li></ul></div><br><br><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f&title=Quantile%20absolute%20deviation%3a%20estimating%20statistical%20dispersion%20around%20quantiles" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Quantile%20absolute%20deviation%3a%20estimating%20statistical%20dispersion%20around%20quantiles&url=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f&title=Quantile%20absolute%20deviation%3a%20estimating%20statistical%20dispersion%20around%20quantiles" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2022 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>