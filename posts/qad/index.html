<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.74.3"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Quantiles,MAD,Research: Quantile absolute deviation,Dispersion,Harrell-Davis quantile estimator"><title>Quantile absolute deviation: estimating statistical dispersion around quantiles | Andrey Akinshin</title><meta name=description content="Quantile absolute deviation allows estimating statistical dispersion around the given quantile"><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><meta name=og:image content="https://aakinshin.net/posts/qad/img/modal5-light.png"><link href=/css/lumen-bootstrap.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/slate-bootstrap.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><link href=/css/syntax-light.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/syntax-dark.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.26d61b7027fe55e642f0001cef94cb75b567d721086492aab6b4e32d9ee7811d.js></script><script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.882998740b9c4c24677576b997bde5a487246e2e3bd72128a0e922eaa59db029.mjs></script><link href=https://aakinshin.net/css/fontawesome-all.min.50da8736f05b35aac9691de67fe993cbe01b7d88fcf0cb682c3a8f39933fe4a3.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.2a76db7cc14055b3bafacc363f453917ab54a818a7db2a0a9b2409c0f6bf07c5.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.b7c11be17efd31d4852ff062694551596a7625c992103c0605c98f85d6569f11.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVB6MXSX32"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-ZVB6MXSX32');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-41419012-5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-41419012-5');</script><script type=text/javascript>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");ym(28700916,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src=https://mc.yandex.ru/watch/28700916 style=position:absolute;left:-9999px alt></div></noscript><script src=/js/jquery-3.3.1.slim.min.js></script></head><body><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" data-toggle=dropdown href=# role=button aria-haspopup=true aria-expanded=false>Posts</a><div class=dropdown-menu><a class=dropdown-item href=https://aakinshin.net/posts/>All Posts</a>
<a class=dropdown-item href=https://aakinshin.net/tags/statistics/>Posts about Statistics</a>
<a class=dropdown-item href=https://aakinshin.net/tags/>All Tags</a></div></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ml-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Quantile absolute deviation: estimating statistical dispersion around quantiles</h1><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2020-12-01>December 1, 2020</time>
&nbsp;&nbsp;
<i class="fas fa-tag"></i>&nbsp;
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/research/ class="badge badge-info">Research</a>
<a href=https://aakinshin.net/tags/quantiles/ class="badge badge-info">Quantiles</a>
<a href=https://aakinshin.net/tags/mad/ class="badge badge-info">MAD</a>
<a href=https://aakinshin.net/tags/research-qad/ class="badge badge-info">Research: Quantile absolute deviation</a>
<a href=https://aakinshin.net/tags/dispersion/ class="badge badge-info">Dispersion</a>
<a href=https://aakinshin.net/tags/harrell-davis-quantile-estimator/ class="badge badge-info">Harrell-Davis quantile estimator</a></span><br><br><strong>Update: this blog post is a part of research that aimed to build a new measure of statistical dispersion called quantile absolute deviation. A <a href=/posts/preprint-qad/>preprint with final results</a> is available on arXiv: <a href=https://arxiv.org/abs/2208.13459>arXiv:2208.13459 [stat.ME]</a>. Some information in this blog post can be obsolete: please, use the preprint as the primary reference.</strong><br><br><p>There are many different metrics for <a href=https://en.wikipedia.org/wiki/Statistical_dispersion>statistical dispersion</a>.
The most famous one is the <a href=https://en.wikipedia.org/wiki/Standard_deviation>standard deviation</a>.
The standard deviation is the most popular way to describe the spread around the mean when
you work with normally distributed data.
However, if you work with non-normal distributions, this metric may be misleading.</p><p>In the world of non-parametric distributions,
the most common measure of <a href=https://en.wikipedia.org/wiki/Central_tendency>central tendency</a> is the median.
For the median, you can describe dispersion using the
<a href=https://en.wikipedia.org/wiki/Median_absolute_deviation>median absolute deviation around the median</a> (MAD).
It works great if the median is the only <a href=https://en.wikipedia.org/wiki/Summary_statistics>summary statistic</a> that you care about.
However, if you work with multimodal distributions
(they can be detected using the <a href=https://aakinshin.net/posts/lowland-multimodality-detection/>lowland multimodality detector</a>),
you may be interested in other quantiles as well.
So, it makes sense to learn how to describe dispersion around the given quantile.
Which metric should we choose?</p><p>Recently, I came up with a great solution to this problem.
We can generalize the median absolute deviation into the quantile absolute deviation (QAD) around the given quantile based on the Harrell-Davis quantile estimator.
I will show how to calculate it, how to interpret it, and how to get insights about distribution properties
from images like this one:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal5-light.png target=_blank class=imgldlink alt=modal5><picture>
<source theme=dark srcset=/posts/qad/img/modal5-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal5-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal5-light.png></picture></a></div></div><br><h3 id=median-absolute-deviation-around-the-median>Median absolute deviation around the median</h3><p>Let&rsquo;s start with the classic definition for the median absolute deviation around the median:</p><p><span class="math display">\[\mathcal{MAD}(x) = C \cdot \textrm{median}(|x_i - \textrm{median}(x)|).
\]</span></p><p>Here <span class="math inline">\(C\)</span> is a scale factor.
Typically, <span class="math inline">\(C \approx 1.4826\)</span> to use <span class="math inline">\(\mathcal{MAD}\)</span> a consistent estimator for the estimation of the standard deviation in the case of the normal distribution.
In the scope of this post, there is no need to be consistent with other dispersion metrics,
so you can assume that <span class="math inline">\(C = 1\)</span>.</p><p>When people use the <span class="math inline">\(\mathcal{MAD}\)</span>, they usually forget to pay attention to the quantile estimator that
is used to calculate the median.
Meanwhile, the quantile estimator heavily affects the <a href=https://en.wikipedia.org/wiki/Efficiency_(statistics)>efficiency</a> of the final version.
For further discussion, let&rsquo;s use the Harrell-Davis quantile estimator (<a href=#Harrell1982>[Harrell1982]</a>)
because it&rsquo;s one of the most smooth and efficient options.</p><p>One of the most important properties of the <span class="math inline">\(\mathcal{MAD}\)</span> you should know:
the range <span class="math inline">\([\textrm{median}(x) - \mathcal{MAD}(x); \textrm{median}(x) + \mathcal{MAD}(x)]\)</span>
contains 50% of the distribution:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/gumbel-mad-light.png target=_blank class=imgldlink alt=gumbel-mad><picture>
<source theme=dark srcset=/posts/qad/img/gumbel-mad-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/gumbel-mad-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/gumbel-mad-light.png></picture></a></div></div><br><p>For better understanding,
you can check out <a href=(https://aakinshin.net/posts/gumbel-mad/)>an example</a> of
how to calculate the exact value of the <span class="math inline">\(\mathcal{MAD}\)</span> for the Gumbel distribution.</p><h3 id=median-absolute-deviation-around-quantiles>Median absolute deviation around quantiles</h3><p>The above formula looks great for the median, but what if we want to describe dispersion for a quantile?
By analogy, we can build the median absolute deviation around the <span class="math inline">\(p^{\textrm{th}}\)</span> quantile:</p><p><span class="math display">\[\mathcal{MAD}(x, p) = C \cdot \textrm{median}(|x_i - Q(x, p)|),
\]</span></p><p>where <span class="math inline">\(Q(x; p)\)</span> is the <span class="math inline">\(p^{\textrm{th}}\)</span> quantile of <span class="math inline">\(x\)</span>.</p><p>It works similar way as the classic <span class="math inline">\(\mathcal{MAD}\)</span> around the median:
the interval <span class="math inline">\([Q(x, p) - \mathcal{MAD}(x, p); Q(x, p) + \mathcal{MAD}(x, p)]\)</span>
contains exactly 50% of the distribution.</p><p>That&rsquo;s how it looks for the unimodal case (the density plot is shown using the <a href=https://aakinshin.net/posts/qrde-hd/>quantile-respectful density estimation based on the Harrell-Davis quantile estimator</a> (QRDE-HD)):</p><div class=row><div class=mx-auto><a href=/posts/qad/img/mad-unimodal-light.svg target=_blank class=imgldlink alt=mad-unimodal><picture>
<source theme=dark srcset=/posts/qad/img/mad-unimodal-dark.svg media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/mad-unimodal-light.svg media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/mad-unimodal-light.svg></picture></a></div></div><br><p>You may notice that the deviation for the lower and upper quantiles are much larger than
the deviation for the median.
It&rsquo;s a nice feature of this metric because it correlates with the estimator errors.
Indeed, it&rsquo;s hard to estimate extreme quantiles with high accuracy,
and the errors are usually pretty large.</p><p>Now let&rsquo;s add a few outliers and check out the updated <span class="math inline">\(\mathcal{MAD}(x, p)\)</span> plot:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/mad-unimodal-outliers-light.svg target=_blank class=imgldlink alt=mad-unimodal-outliers><picture>
<source theme=dark srcset=/posts/qad/img/mad-unimodal-outliers-dark.svg media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/mad-unimodal-outliers-light.svg media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/mad-unimodal-outliers-light.svg></picture></a></div></div><br><p>We can see that the deviation for the extreme upper quantiles is much larger than the other <span class="math inline">\(\mathcal{MAD}(x, p)\)</span> values.
It&rsquo;s also an expected effect: when we have a few upper outliers,
it&rsquo;s tough to estimate the upper quantiles.</p><p>We have a similar situation for skewed distributions:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/mad-skewed-light.svg target=_blank class=imgldlink alt=mad-skewed><picture>
<source theme=dark srcset=/posts/qad/img/mad-skewed-dark.svg media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/mad-skewed-light.svg media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/mad-skewed-light.svg></picture></a></div></div><br><h3 id=quantile-absolute-deviation-around-quantiles>Quantile absolute deviation around quantiles</h3><p>Now it&rsquo;s time to make the final step toward generalizations.
In the previous section, we took the median of <span class="math inline">\(|x_i - Q(x, p)|\)</span> to describe
the dispersion around the given quantile.
Can we estimate another quantile of <span class="math inline">\(|x_i - Q(x, p)|\)</span> instead of the median?
Of course, we can!
Let&rsquo;s introduce the <em>quantile absolute deviation around the given quantile</em>:</p><p><span class="math display">\[\mathcal{QAD}(x, p, q) = C \cdot Q(|x_i - Q(x, p)|, q).
\]</span></p><p>In the equation, we take <span class="math inline">\(q^{\textrm{th}}\)</span> quantile of <span class="math inline">\(|x_i - Q(x, p)|\)</span>.
This value also describes the dispersion around the <span class="math inline">\(p^{\textrm{th}}\)</span> quantile of <span class="math inline">\(x\)</span> similar to <span class="math inline">\(\mathcal{MAD}(x, p)\)</span>,
but it captures another interval of the distribution.
To be more specific, <span class="math inline">\([Q(x, p) - \mathcal{QAD}(x, p, q); Q(x, p) + \mathcal{QAD}(x, p, q)]\)</span>
contains <span class="math inline">\((q*100)\%\)</span> of the whole distribution.</p><p>The <span class="math inline">\(\mathcal{QAD}\)</span> is especially useful when we work with multimodal distribution.
Let&rsquo;s look at <span class="math inline">\(\mathcal{QAD}(x, p, q)\)</span> for <span class="math inline">\(q \in {0.25, 0.5, 0.75}\)</span> in the bimodal case:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/qad-modal2-light.svg target=_blank class=imgldlink alt=qad-modal2><picture>
<source theme=dark srcset=/posts/qad/img/qad-modal2-dark.svg media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/qad-modal2-light.svg media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/qad-modal2-light.svg></picture></a></div></div><br><p>Here we can see that the median absolute deviation around the median
(<span class="math inline">\(\mathcal{MAD}(x, 0.5) = \mathcal{QAD}(x, 0.5, 0.5)\)</span>)
is much lower than the median absolute deviation around lower and upper quantiles
(corner points of the <span class="math inline">\(\mathcal{QAD}(x, p, 0.5)\)</span> plot).
It&rsquo;s doesn&rsquo;t actually meet our expectations.
Indeed, the perfectly bimodal distribution is the worst case for the median estimation.
Classic quantile estimators based on linear interpolation are incapable of estimating the median correctly because there are no sample elements around the true median value.
The Harrell-Davis quantile estimator solves this problem much better,
but the accuracy level is still low.
Thus, we may expect that the deviation around the median (and the estimation errors) should be high.
These expectation may be satisfied using <span class="math inline">\(\mathcal{QAD}(x, 0.5, 0.25)\)</span>
which has the global maximum that matches the median.</p><p>On the other hand, <span class="math inline">\(\mathcal{QAD}(x, p, 0.75)\)</span> is also may be useful.
It captures 75% of the distribution, so it has a higher value at the mode values.
We can see that <span class="math inline">\(\mathcal{QAD}(x, 0.25, 0.75)\)</span> is much larger than <span class="math inline">\(\mathcal{QAD}(x, 0.5, 0.75)\)</span>.
Thus, <span class="math inline">\(\mathcal{QAD}(x, p, 0.75)\)</span> is trying to say that the distance from the first mode to another one
is larger than the distance from the median to the nearest mode.
Using the <span class="math inline">\(\mathcal{QAD}(x, p, q)\)</span> plots for different <span class="math inline">\(q\)</span> values, we can get different insights about
the distribution properties.
Try to do it yourself with the trimodal distribution:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/qad-modal3-light.svg target=_blank class=imgldlink alt=qad-modal3><picture>
<source theme=dark srcset=/posts/qad/img/qad-modal3-dark.svg media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/qad-modal3-light.svg media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/qad-modal3-light.svg></picture></a></div></div><br><p>Of course, it&rsquo;s not very convenient to manually enumerate different values of <span class="math inline">\(q\)</span> and look at dozens of plots.
We need one more way to visualize the quantile absolute deviation to discover its true power.</p><h3 id=heatmap-for-quantile-absolute-deviation-around-quantiles>Heatmap for Quantile absolute deviation around quantiles</h3><p>For the given <span class="math inline">\(x\)</span>, <span class="math inline">\(\mathcal{QAD}(x, p, q)\)</span> is a function parameterized by two variables <span class="math inline">\(p, q \in [0; 1]\)</span>.
One of the most popular ways to visualize such functions is the <a href=https://en.wikipedia.org/wiki/Heat_map>heatmap</a>.
It&rsquo;s also convenient to introduce several levels on this heatmap to highlight regions with the same value.
I did a lot of experiments and came to the conclusion that
I get the most insightful pictures using 20 levels.
To split the whole range of <span class="math inline">\(\mathcal{QAD}\)</span> values to sub-intervals, we can use
<a href=https://en.wiktionary.org/wiki/ventile>ventiles</a> (20-quantiles).
To get the ventile values, we use the Harrell-Davis quantile estimator one more time to get
a smoother picture.</p><p>Consider a bimodal distribution:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal2-den-light.png target=_blank class=imgldlink alt=modal2-den><picture>
<source theme=dark srcset=/posts/qad/img/modal2-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal2-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal2-den-light.png></picture></a></div></div><br><p>For this distribution, we get the following <span class="math inline">\(\mathcal{QAD}\)</span> heatmap:</p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal2-light.png target=_blank class=imgldlink alt=modal2><picture>
<source theme=dark srcset=/posts/qad/img/modal2-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal2-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal2-light.png></picture></a></div></div><br><p>I made a lot of attempts trying to explain in the text form how to interpret such pictures.
Unfortunately, I failed.
I just don&rsquo;t know how to express its internal beauty and the insightfulness of all the small details.</p><p>If you want to learn how to get benefits from such a visualization,
just try to look at the different <span class="math inline">\(\mathcal{QAD}\)</span> heatmaps for a while
and match them with the corresponding density plots.
It should train the neural network inside your brain to work with these pictures.
Below you find a gallery of such heatmaps for different distributions.</p><h3 id=heatmap-gallery>Heatmap gallery</h3><p><strong>A distribution with 1 mode:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal1-den-light.png target=_blank class=imgldlink alt=modal1-den><picture>
<source theme=dark srcset=/posts/qad/img/modal1-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal1-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal1-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/modal1-light.png target=_blank class=imgldlink alt=modal1><picture>
<source theme=dark srcset=/posts/qad/img/modal1-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal1-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal1-light.png></picture></a></div></div><br></p><p><strong>A distribution with 2 modes:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal2-den-light.png target=_blank class=imgldlink alt=modal2-den><picture>
<source theme=dark srcset=/posts/qad/img/modal2-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal2-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal2-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/modal2-light.png target=_blank class=imgldlink alt=modal2><picture>
<source theme=dark srcset=/posts/qad/img/modal2-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal2-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal2-light.png></picture></a></div></div><br></p><p><strong>A distribution with 3 modes:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal3-den-light.png target=_blank class=imgldlink alt=modal3-den><picture>
<source theme=dark srcset=/posts/qad/img/modal3-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal3-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal3-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/modal3-light.png target=_blank class=imgldlink alt=modal3><picture>
<source theme=dark srcset=/posts/qad/img/modal3-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal3-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal3-light.png></picture></a></div></div><br></p><p><strong>A distribution with 4 modes:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal4-den-light.png target=_blank class=imgldlink alt=modal4-den><picture>
<source theme=dark srcset=/posts/qad/img/modal4-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal4-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal4-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/modal4-light.png target=_blank class=imgldlink alt=modal4><picture>
<source theme=dark srcset=/posts/qad/img/modal4-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal4-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal4-light.png></picture></a></div></div><br></p><p><strong>A distribution with 5 modes:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal5-den-light.png target=_blank class=imgldlink alt=modal5-den><picture>
<source theme=dark srcset=/posts/qad/img/modal5-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal5-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal5-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/modal5-light.png target=_blank class=imgldlink alt=modal5><picture>
<source theme=dark srcset=/posts/qad/img/modal5-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal5-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal5-light.png></picture></a></div></div><br></p><p><strong>A distribution with 10 modes:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/modal10-den-light.png target=_blank class=imgldlink alt=modal10-den><picture>
<source theme=dark srcset=/posts/qad/img/modal10-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal10-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal10-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/modal10-light.png target=_blank class=imgldlink alt=modal10><picture>
<source theme=dark srcset=/posts/qad/img/modal10-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/modal10-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/modal10-light.png></picture></a></div></div><br></p><p><strong>A distribution with lower outliers:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/outliers-lower-den-light.png target=_blank class=imgldlink alt=outliers-lower-den><picture>
<source theme=dark srcset=/posts/qad/img/outliers-lower-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/outliers-lower-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/outliers-lower-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/outliers-lower-light.png target=_blank class=imgldlink alt=outliers-lower><picture>
<source theme=dark srcset=/posts/qad/img/outliers-lower-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/outliers-lower-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/outliers-lower-light.png></picture></a></div></div><br></p><p><strong>A distribution with upper outliers:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/outliers-upper-den-light.png target=_blank class=imgldlink alt=outliers-upper-den><picture>
<source theme=dark srcset=/posts/qad/img/outliers-upper-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/outliers-upper-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/outliers-upper-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/outliers-upper-light.png target=_blank class=imgldlink alt=outliers-upper><picture>
<source theme=dark srcset=/posts/qad/img/outliers-upper-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/outliers-upper-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/outliers-upper-light.png></picture></a></div></div><br></p><p><strong>A distribution with lower and upper outliers:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/outliers-both-den-light.png target=_blank class=imgldlink alt=outliers-both-den><picture>
<source theme=dark srcset=/posts/qad/img/outliers-both-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/outliers-both-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/outliers-both-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/outliers-both-light.png target=_blank class=imgldlink alt=outliers-both><picture>
<source theme=dark srcset=/posts/qad/img/outliers-both-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/outliers-both-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/outliers-both-light.png></picture></a></div></div><br></p><p><strong>A right-skewed distribution:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/skewed-right-den-light.png target=_blank class=imgldlink alt=skewed-right-den><picture>
<source theme=dark srcset=/posts/qad/img/skewed-right-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/skewed-right-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/skewed-right-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/skewed-right-light.png target=_blank class=imgldlink alt=skewed-right><picture>
<source theme=dark srcset=/posts/qad/img/skewed-right-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/skewed-right-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/skewed-right-light.png></picture></a></div></div><br></p><p><strong>A left-skewed distribution:</strong></p><p><div class=row><div class=mx-auto><a href=/posts/qad/img/skewed-left-den-light.png target=_blank class=imgldlink alt=skewed-left-den><picture>
<source theme=dark srcset=/posts/qad/img/skewed-left-den-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/skewed-left-den-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/skewed-left-den-light.png></picture></a></div></div><br><div class=row><div class=mx-auto><a href=/posts/qad/img/skewed-left-light.png target=_blank class=imgldlink alt=skewed-left><picture>
<source theme=dark srcset=/posts/qad/img/skewed-left-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/qad/img/skewed-left-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/qad/img/skewed-left-light.png></picture></a></div></div><br></p><h3 id=conclusion>Conclusion</h3><p>In this post, I showed how to generalize
the <em>median absolute deviation (<span class="math inline">\(\mathcal{MAD}\)</span>) around the median</em> to
the <em>quantile absolute deviation (<span class="math inline">\(\mathcal{QAD}\)</span>) around the given quantile</em>.
We discussed a few kinds of insightful visualization that may help you understand
the nature of this metric.</p><p>I believe that the <span class="math inline">\(\mathcal{QAD}\)</span> is a powerful way to describe the statistical dispersion around the given quantile.
In future blog posts, I will show how to use it to describe the overall distribution properties
and how to use it to determine the quantile estimation errors.</p><h3 id=references>References</h3><ul><li><b id=Harrell1982>[Harrell1982]</b><br>Harrell, F.E. and Davis, C.E., 1982. A new distribution-free quantile estimator.
<em>Biometrika</em>, 69(3), pp.635-640.<br><a href=https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf>https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf</a></li></ul><br><br><div class=row><div class="mx-auto share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f&title=Quantile%20absolute%20deviation%3a%20estimating%20statistical%20dispersion%20around%20quantiles" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Quantile%20absolute%20deviation%3a%20estimating%20statistical%20dispersion%20around%20quantiles&url=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x"></i></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fqad%2f&title=Quantile%20absolute%20deviation%3a%20estimating%20statistical%20dispersion%20around%20quantiles" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div></div></div><hr></div></div></main></div><footer class=blog-footer><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub></i></a><a href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter></i></a><a href=https://aakinshin.net/posts/index.xml><i class="fas fa-rss" title=RSS></i></a>|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.082780cb948cc57eabbc0d80172a7a5347d5572b599938b4c9876dfd7978b424.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/anchor.min.js></script><script src=https://aakinshin.net/js/custom.min.11932490dde776463ed165b345838c701accc0cfdedf2e0868f13415f41f0872.js></script><script>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true,},options:{skipHtmlTags:['script','noscript','style','textarea','pre'],ignoreHtmlClass:'tex2jax_ignore',processHtmlClass:'tex2jax_process'}};</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>