<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Optimal window of the trimmed Harrell-Davis quantile estimator,Research: Building trimmed Harrell-Davis quantile estimator"><title>Optimal window of the trimmed Harrell-Davis quantile estimator, Part 2: Trying Planck-taper window | Andrey Akinshin</title><meta name=description content="In the previous post, I discussed the problem of non-smooth quantile-respectful density estimation (QRDE) which is generated by the trimmed Harrell-Davis q..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=https://aakinshin.net/sass/bootstrap-light.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=https://aakinshin.net/sass/bootstrap-dark.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.d7f6578e23ad3f0c33c589f9bcb34f995b45121f1f3ce888869c86b26826c845.js></script>
<script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.9e68d431432744c07a43381a8a833ffe0921cc0e006d84ad97f0b0d43c5cd82d.mjs></script>
<link href=https://aakinshin.net/css/main.min.d3894e60e337fa8d9f2c81dcda5dcb9144502462aaabed3c6bad2fcf178a8410.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body class="d-flex flex-column min-vh-100"><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><svg class="fai"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></li><li class=nav-item><a class=nav-link id=nav-link-posts href=https://aakinshin.net/posts/>Posts</a></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Optimal window of the trimmed Harrell-Davis quantile estimator, Part 2: Trying Planck-taper window</h1><span class=blog-post-meta><svg class="fai"><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2021-10-12>October 12, 2021</time>
&nbsp;&nbsp;<svg class="fai"><use xlink:href="/img/fa/all.svg#tag"/></svg>
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/research/ class="badge badge-info">Research</a>
<a href=https://aakinshin.net/tags/optimal-window-of-the-trimmed-harrell-davis-quantile-estimator/ class="badge badge-info">Optimal window of the trimmed Harrell-Davis quantile estimator</a>
<a href=https://aakinshin.net/tags/research-thdqe/ class="badge badge-info">Research: Building trimmed Harrell-Davis quantile estimator</a></span><br><br><strong>Update: this blog post is a part of research that aimed to build a statistically efficient and robust quantile estimator. A <a href=/posts/pub-thdqe/>paper with final results</a> is available in <em>Communications in Statistics - Simulation and Computation</em> (DOI: <a href=https://www.tandfonline.com/doi/abs/10.1080/03610918.2022.2050396>10.1080/03610918.2022.2050396</a>). A preprint is available on arXiv: <a href=https://arxiv.org/abs/2111.11776>arXiv:2111.11776 [stat.ME]</a>. Some information in this blog post can be obsolete: please, use the official paper as the primary reference.</strong><br><br><p>In the <a href=https://aakinshin.net/posts/thdqe-ow1/>previous post</a>,
I discussed the problem of non-smooth quantile-respectful density estimation (QRDE)
which is generated by the trimmed Harrell-Davis quantile estimator
based on the highest density interval of the given width.
I assumed that non-smoothness was caused by a non-smooth rectangular window
which was used to build the truncated beta distribution.
In this post, we are going to try another option: the Planck-taper window.</p><div class=row><div class=mx-auto><a href=/posts/thdqe-ow2/img/qrde-light.png target=_blank class=imgldlink alt=qrde><picture><source theme=dark srcset=/posts/thdqe-ow2/img/qrde-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/thdqe-ow2/img/qrde-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/thdqe-ow2/img/qrde-light.png></picture></a></div></div><br><p>All posts from this series:</p><ul><li><a href=https://aakinshin.net/posts/thdqe-ow1/>Optimal window of the trimmed Harrell-Davis quantile estimator, Part 1: Problems with the rectangular window</a> <i>(October 5, 2021)</i></li><li><a href=https://aakinshin.net/posts/thdqe-ow2/>Optimal window of the trimmed Harrell-Davis quantile estimator, Part 2: Trying Planck-taper window</a> <i>(October 12, 2021)</i></li></ul><h3 id=planck-taper-window>Planck-taper window</h3><p>The Planck-taper window on <span class="math inline">\([0;1]\)</span> could be expressed using the following function:</p><p><span class="math display">\[h_\varepsilon(x) = \begin{cases}
0, & \textrm{for }\, x = 0,\\
\big( 1+e^{\frac{\varepsilon}{x} - \frac{\varepsilon}{\varepsilon - x}} \big)^{-1}, & \textrm{for }\, 0 < x < \varepsilon,\\
1, & \textrm{for }\, \varepsilon \leq x \leq 1 - \varepsilon,\\
\big( 1+e^{\frac{\varepsilon}{1 - x} - \frac{\varepsilon}{\varepsilon - (1 - x)}} \big)^{-1}, & \textrm{for }\, 1 - \varepsilon < x < 1,\\
0, & \textrm{for }\, x = 1.\\
\end{cases}
\]</span></p><p>Here is an example of such function for <span class="math inline">\(\varepsilon = 0.1\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/thdqe-ow2/img/ptw-light.png target=_blank class=imgldlink alt=ptw><picture><source theme=dark srcset=/posts/thdqe-ow2/img/ptw-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/thdqe-ow2/img/ptw-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/thdqe-ow2/img/ptw-light.png></picture></a></div></div><br><h3 id=planck-taper-powered-trimmed-harrell-davis-quantile-estimator>Planck-taper-powered trimmed Harrell-Davis quantile estimator</h3><p>In the <a href=https://aakinshin.net/posts/thdqe-ow1/>previous post</a>,
we discussed how to build a trimmed Harrell-Davis quantile estimator using a rectangular window.
The suggested approach is based on the multiplication of
the probability density function of the Beta distribution <span class="math inline">\(f_{\operatorname{HD}}\)</span>
(which is used in the classic Harrell-Davis quantile estimator)
and the rectangular window <span class="math inline">\(f_{\operatorname{rw}}\)</span>:</p><p><span class="math display">\[f_{\operatorname{HD}}(x) = \frac{x^{\alpha - 1} (1 - x)^{\beta - 1}}{\operatorname{B}(\alpha, \beta)}.
\]</span></p><p><span class="math display">\[f_{\operatorname{rw}}(x) = \begin{cases}
0, & \textrm{if }\, x < L,\\
1, & \textrm{if }\, L \leq x \leq R,\\
0, & \textrm{if }\, R < x.\\
\end{cases}
\]</span></p><p><span class="math display">\[f_{\operatorname{THD/rw}}(x) = \dfrac{f_{\operatorname{HD}}(x) \cdot f_{\operatorname{rw}}(x)}{
\int_0^1 f_{\operatorname{HD}}(u) \cdot f_{\operatorname{rw}}(u) du}
\]</span></p><p><span class="math display">\[F_{\operatorname{THD/rw}}(x) = \int_0^x f_{\operatorname{THD/rw}}(t) dt
\]</span></p><p>This time, we are going to use the same procedure for the following multiplier function based on the Planck-taper window:</p><p><span class="math display">\[f_{\operatorname{ptw}}(x) = \begin{cases}
0, & \textrm{if }\, x < L,\\
h_\varepsilon((x - L) / (R - L)), & \textrm{if }\, L \leq x \leq R,\\
0, & \textrm{if }\, R < x.\\
\end{cases}
\]</span></p><p><span class="math display">\[f_{\operatorname{THD/ptw}}(x) = \dfrac{f_{\operatorname{HD}}(x) \cdot f_{\operatorname{ptw}}(x)}{
\int_0^1 f_{\operatorname{HD}}(u) \cdot f_{\operatorname{ptw}}(u) du}
\]</span></p><p><span class="math display">\[F_{\operatorname{THD/ptw}}(x) = \int_0^x f_{\operatorname{THD/ptw}}(t) dt
\]</span></p><h2 id=simulation-results>Simulation results</h2><p>I have tried multiple combinations of sample sizes, <span class="math inline">\(\varepsilon\)</span> values, and trimming percentage values.
In most cases, the Planck-taper-powered estimator gives quantile-respectful density estimation that
<em>a little bit</em> smoother than the estimation in the rectangular window case.</p><p><div class=row><div class=mx-auto><a href=/posts/thdqe-ow2/img/qrde-light.png target=_blank class=imgldlink alt=qrde><picture><source theme=dark srcset=/posts/thdqe-ow2/img/qrde-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/thdqe-ow2/img/qrde-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/thdqe-ow2/img/qrde-light.png></picture></a></div></div><br><em>(Quantile estimator based on the Planck-taper window is denoted as <code>THD-SQRT*</code>)</em></p><h2 id=discussion>Discussion</h2><p>It seems that we can&rsquo;t obtain smooth density estimation using trimmed quantile estimators regardless of the window form.
Here is the intuition behind the density estimation discontinuous points (that looks like steps).
Imagine that we slowly change the probability <span class="math inline">\(p\)</span> of the target quantile from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span>
and build the corresponding density function values.
Each <span class="math inline">\(p\)</span> value gives us the <span class="math inline">\([L;R]\)</span> interval which defines the set of order statistics that are actually used to build
the quantile estimation.
While we change <span class="math inline">\(p\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span>, we also change <span class="math inline">\([L;R]\)</span> from <span class="math inline">\([0;w]\)</span> to <span class="math inline">\([1-w;1]\)</span> where <span class="math inline">\(w\)</span> is the interval width.
When the <span class="math inline">\([L;R]\)</span> interval crosses a border between two order statistics, it starts to cover another sample element.
If the gap between these two order statistics is huge, we could observe a density functions step
<em>regardless</em> of the smoothness of <span class="math inline">\(W_i(p)\)</span>.
Using different window functions, we could improve smoothness <em>a little bit</em>, but it seems to be impossible
to get rid of steps completely.
Apparently, this is the price of estimator robustness.</p><br><br><div class=row><div class="justify-content-center share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fthdqe-ow2%2f&title=Optimal%20window%20of%20the%20trimmed%20Harrell-Davis%20quantile%20estimator%2c%20Part%202%3a%20Trying%20Planck-taper%20window" target=_blank title="Share on Reddit"><svg class="fai"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Optimal%20window%20of%20the%20trimmed%20Harrell-Davis%20quantile%20estimator%2c%20Part%202%3a%20Trying%20Planck-taper%20window&url=https%3a%2f%2faakinshin.net%2fposts%2fthdqe-ow2%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fthdqe-ow2%2f" target=_blank title="Share on HackerNews"><svg class="fai"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fthdqe-ow2%2f&title=Optimal%20window%20of%20the%20trimmed%20Harrell-Davis%20quantile%20estimator%2c%20Part%202%3a%20Trying%20Planck-taper%20window" target=_blank title="Add to Pocket"><svg class="fai"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><hr></div></div></main></div><footer class="blog-footer mt-auto"><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><svg class="fai"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a><a href=https://twitter.com/andrey_akinshin><svg class="fai"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a><a href=https://aakinshin.net/posts/index.xml><svg class="fai"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a>|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://aakinshin.net/js/theme-after.min.29520a8e1176193da7ea4e6cb56cf9b3e634b867c9979234d8dafb5ab61dd494.js></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>