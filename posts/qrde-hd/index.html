<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.3"><meta name=author content='Andrey Akinshin'><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content='Mathematics,Statistics,Research,PDF,Quantile-Respectful Density Estimation,Harrell-Davis Quantile Estimator'><title>Quantile-respectful density estimation based on the Harrell-Davis quantile estimator | Andrey Akinshin</title>
<meta name=description content="The idea of this post was born when I was working on a presentation for my recent DotNext talk. It had a slide with a density plot like this:
Here we can see a density plot based on a sample with highlighted decile locations that split the plot into 10 equa..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.bd72d325bdc38834419d4aa1c4290c598efcdc8d2ce65313792adf9c745dd7f6.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-2 xs:px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Quantile-Respectful Density Estimation Based on the Harrell-Davis Quantile Estimator</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2020-10-27>October 27, 2020</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/pdf/>PDF</a>
<a class=label-link href=https://aakinshin.net/tags/qrde/>Quantile-Respectful Density Estimation</a>
<a class=label-link href=https://aakinshin.net/tags/harrell-davis-quantile-estimator/>Harrell-Davis Quantile Estimator</a></div></div><br><div class=main-content><p>The idea of this post was born when I was working on a presentation for my recent <a href=https://dotnext.ru/en/>DotNext</a> <a href="https://www.youtube.com/watch?v=gc3yVybPuaY&list=PL21xssNXOJNGUROqzSTOC8uZL4W2QZpvK&index=1">talk</a>.
It had a <a href=https://slides.aakinshin.net/dotnext-piter2020/#193>slide</a> with a density plot like this:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/riddle-light.png target=_blank alt=riddle><img src=/posts/qrde-hd/img/riddle-light.png width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/riddle-dark.png target=_blank alt=riddle><img src=/posts/qrde-hd/img/riddle-dark.png width=800></a></div><p>Here we can see a density plot based on a sample with highlighted <a href=https://en.wikipedia.org/wiki/Decile>decile</a> locations that split the plot into 10 equal parts.
Before the conference, I have been reviewed by <a href=https://twitter.com/VladimirSitnikv>@VladimirSitnikv</a>.
He raised a reasonable concern: it doesn&rsquo;t look like all the density plot segments are equal and contain exactly 10% of the whole plot.
And he was right!</p><p>However, I didn&rsquo;t make any miscalculations.
I generated a real sample with 61 elements.
Next, I build a density plot with the kernel density estimation (KDE) using the Sheather & Jones method and the normal kernel.
Next, I calculated decile values using the Harrell-Davis quantile estimator.
Although both the density plot and the decile values are calculated correctly and consistent with the sample,
they are not consistent with each other!
Indeed, such a density plot is just an estimation of the underlying distribution.
It has its own decile values, which are not equal to the sample decile values regardless of the used quantile estimator.
This problem is common for different kinds of visualization that presents density and quantiles at the same time (e.g., <a href=https://towardsdatascience.com/violin-plots-explained-fb1d115e023d>violin plots</a>)</p><p>It leads us to a question: how should we present the shape of our data together with quantile values without confusing inconsistency in the final image?
Today I will present a good solution: we should use the quantile-respectful density estimation based on the Harrell-Davis quantile estimator!
I know the title is a bit long, but it&rsquo;s not so complicated as it sounds.
In this post, I will show how to build such plots.
Also I will compare them to the classic histograms and kernel density estimations.
As a bonus, I will demonstrate how awesome these plots are for multimodality detection.</p><h3 id=the-problem>The problem</h3><p>To understand the problem better, consider a sample with three elements: $x = \{ 3, 4, 7 \}$.
Let&rsquo;s build a probability density function (PDF) based on kernel density estimation using the Sheather & Jones method and the normal kernel.
Let&rsquo;s also calculate the median and the $95^{\textrm{th}}$ percentile using three different methods:</p><ul><li><strong>Type 7 quantile estimator</strong><br>It&rsquo;s the most popular quantile estimator which is used by default in
R, Julia, NumPy, Excel (<code>PERCENTILE</code>, <code>PERCENTILE.INC</code>), Python (<code>inclusive</code> method).
We call it &ldquo;Type 7&rdquo; according to notation from <a href=https://aakinshin.net/library/papers/hyndman1996/>[hyndman1996]</a>,
where Rob J. Hyndman and Yanan Fan described nine quantile algorithms which are used in statistical computer packages.</li><li><strong>The Harrell-Davis quantile estimator</strong><br>A quantile estimator that is described in <a href=https://aakinshin.net/library/papers/harrell1982/>[harrell1982]</a>.
It&rsquo;s more efficient, and it provides more reliable estimations.</li><li><strong>KDE-based quantile estimator</strong><br>Quantile values that are obtained from the kernel density estimation instead of the original sample.</li></ul><p>Here is the density plot with highlighted quantiles:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/three-elements-light.svg target=_blank alt=three-elements><img src=/posts/qrde-hd/img/three-elements-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/three-elements-dark.svg target=_blank alt=three-elements><img src=/posts/qrde-hd/img/three-elements-dark.svg width=800></a></div><p>As you can see, all three quantile estimators produced different values.
However, only the KDE-based quantile estimator is consistent with the density plot.
For example, the KDE-based median estimation splits the density plot into two equal parts while
two other estimators produce other ratios.
The problem becomes more obvious if we look at the $95^{\textrm{th}}$ percentile.
As we can see, the KDE-based value (7.73) is bigger than the maximum sample element $x_{\max} = 7$.
It&rsquo;s an expected situation: the kernel density estimation estimates the whole underlying distribution.
If we use the normal kernel, some parts of the density plot will always be between $x_{\max}$ and positive infinity.
It means that some of the high quantiles will always be bigger than $x_{\max}$.
However, we can&rsquo;t say the same about the Type 7 and Harrell-Davis quantile estimators.
For a sample-based estimator, no quantile estimation can exceed $x_{\max}$.</p><p>Thus, it&rsquo;s not a good idea to present sample-based quantile estimation with the kernel density estimation because
they are not consistent with each other.
To make it consistent, we have two possible solutions:</p><ul><li>Present KDE-based quantile values that are consistent with the existing density plot</li><li>Present another density plot that is consistent with the existing quantile values</li></ul><p>The first option may confuse people.
Indeed, let&rsquo;s say we want to present the $99.9^{\textrm{th}}$ percentile.
In the case of the KDE-based quantiles, this value may be extremely high or even tend to infinity.
Most people will expect to see a value based on the existing data rather than on the KDE.</p><p>Let&rsquo;s try the second option, where we try to build a density plot using the estimated quantile values.</p><h3 id=quantile-respectful-density-estimation>Quantile-respectful density estimation</h3><p>Let&rsquo;s introduce a new term: <em>quantile-respectful density estimation</em><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> (QRDE).
It&rsquo;s a density estimation that matches the given quantile values.
Obviously, it highly depends on the used quantile estimator.
In this section, we compare two different variations of QRDE that are based
on the Type 7 quantile estimator (QRDE-T7) and
on the HarrellDavis quantile estimator (QRDE-HD).</p><p>From the computational point of view, the easiest way to evaluate QRDE is to present it
as a <a href=https://en.wikipedia.org/wiki/Step_function>step function</a> based on several quantile values.
It&rsquo;s convenient to consider the minimum and the maximum values as additional quantile values
(although it&rsquo;s not correct from the formal point of view).
It&rsquo;s also convenient to think about this step function as a <em>density histogram</em>.
For each pair of consecutive quantiles values, we should draw a bin.
The left and the right borders of the bin are equal to the quantile values.
We want to make the QRDE consistent with the quantile values, so each bin&rsquo;s area should be equal to $1 / p$ when we work with $p$-quantiles.
Since we know the width and the area of each bin, it&rsquo;s easy to calculate its height:</p>$$
h_i = \frac{\textrm{Area}_i}{\textrm{Width}_i} = \frac{1/p}{q_{i + 1} - q_i} = \frac{1}{p(q_{i + 1} - q_i)}.
$$<p>Now let&rsquo;s look at some examples.
For simplification, we start with deciles.
They split our distribution into 10 equal sizes.
Thus, we should get 10 bins, the area of each bin is 0.1.
For the above sample $x = \{ 3, 4, 7 \}$, we have the following plots:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/qrde-347-light.svg target=_blank alt=qrde-347><img src=/posts/qrde-hd/img/qrde-347-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/qrde-347-dark.svg target=_blank alt=qrde-347><img src=/posts/qrde-hd/img/qrde-347-dark.svg width=800></a></div><p>The Type 7 quantile estimator presents a nice visualization of this concept.
The median of the sample (which equals 4 with the given estimator) splits the QRDE into two equal parts.
Since this quantile estimator is based on linear interpolation, we have a flat area in each part.</p><p>The Harrell-Davis quantile estimator gives us more smoothness.
At the start, you may be confused by the spikes at the ends of the plot.
However, if you think about it a little bit, this phenomenon becomes pretty obvious and natural.
Indeed, the sample&rsquo;s corner elements are &ldquo;magic&rdquo; points, where a huge portion of density arises from nowhere.
We have zero density on one side and a high positive density on another side.
You may also observe such spikes with the KDE if you cut down parts before the minimum element and after the maximum element.</p><p>Now let&rsquo;s increase the number of elements and consider a 500-element sample from the normal distribution:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/qrde-norm-500-01-light.svg target=_blank alt=qrde-norm-500-01><img src=/posts/qrde-hd/img/qrde-norm-500-01-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/qrde-norm-500-01-dark.svg target=_blank alt=qrde-norm-500-01><img src=/posts/qrde-hd/img/qrde-norm-500-01-dark.svg width=800></a></div><p>We can recognize the bell-shape of the normal distribution, but it&rsquo;s pretty rough.
Also, we do not see a significant difference between the presented quantile estimators.
The difference becomes more obvious if we reduce the quantization step value and switch to percentiles:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/qrde-norm-500-001-light.svg target=_blank alt=qrde-norm-500-001><img src=/posts/qrde-hd/img/qrde-norm-500-001-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/qrde-norm-500-001-dark.svg target=_blank alt=qrde-norm-500-001><img src=/posts/qrde-hd/img/qrde-norm-500-001-dark.svg width=800></a></div><p>Now we can see that the Harrell-Davis gives us a smoother version of the QRDE.
The Type7-based QRDE looks too spiky, which makes it not so useful.
With a very small quantization step, it becomes completely useless because
in most cases, we will observe only a few bins that have the maximum density:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/qrde-norm-500-0001-t7-light.svg target=_blank alt=qrde-norm-500-0001-t7><img src=/posts/qrde-hd/img/qrde-norm-500-0001-t7-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/qrde-norm-500-0001-t7-dark.svg target=_blank alt=qrde-norm-500-0001-t7><img src=/posts/qrde-hd/img/qrde-norm-500-0001-t7-dark.svg width=800></a></div><p>Meanwhile, the Harrell-Davis-based QRDE keeps its smooth form:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/qrde-norm-500-0001-hd-light.svg target=_blank alt=qrde-norm-500-0001-hd><img src=/posts/qrde-hd/img/qrde-norm-500-0001-hd-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/qrde-norm-500-0001-hd-dark.svg target=_blank alt=qrde-norm-500-0001-hd><img src=/posts/qrde-hd/img/qrde-norm-500-0001-hd-dark.svg width=800></a></div><p>Of course, it&rsquo;s not as smooth as the KDE.
We have such a wobbly plot because it describes our real data instead of oversmoothed estimation of the underlying distribution.
If we don&rsquo;t know the actual distribution and we want to just explore the data in the collected sample,
the Harrell-Davis-based QRDE is one of the best ways to do it.</p><p>The most important fact about this plot is that it&rsquo;s consistent with the quantile values.
The estimated value of median splits this plot into two equal parts,
the estimated decile values split this plot into ten equal parts,
and so on.</p><h3 id=qrde-and-multimodal-distributions>QRDE and multimodal distributions</h3><p>The true power of the QRDE manifests itself when you start working with multimodal distributions.
Let&rsquo;s check out some advantages of the QRDE against classic histograms and the KDE.</p><p><strong>It highlights multimodality without parameter tuning.</strong></p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/comparison-4-light.svg target=_blank alt=comparison-4><img src=/posts/qrde-hd/img/comparison-4-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/comparison-4-dark.svg target=_blank alt=comparison-4><img src=/posts/qrde-hd/img/comparison-4-dark.svg width=800></a></div><p>Here we have a distribution with four modes (a combination of $\mathcal{N}(0, 4)$, $\mathcal{N}(0, 8)$, $\mathcal{N}(0, 12)$, $\mathcal{N}(0, 16)$; 30 elements from each).
For the classic histogram, we should choose the offset and the bandwidth, which may be a <a href=https://aakinshin.net/posts/misleading-histograms/>problem</a>.
For KDE, we should choose the bandwidth and the kernel, which also may be <a href=https://aakinshin.net/posts/kde-bw/>problem</a>.
With Harrell-Davis-based QRDE, we don&rsquo;t have any parameters to tune: the plot is uniquely defined, and it almost always presents what we want to see.</p><p><strong>It highlights multimodality even if two modes are close to each other.</strong></p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/comparison-2-light.svg target=_blank alt=comparison-2><img src=/posts/qrde-hd/img/comparison-2-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/comparison-2-dark.svg target=_blank alt=comparison-2><img src=/posts/qrde-hd/img/comparison-2-dark.svg width=800></a></div><p>Here we have a bimodal distribution with background noise (1000 elements from $\mathcal{U}(0; 10)$, 100 elements from $\mathcal{N}(5, 0.1^2)$, 100 elements from $\mathcal{N}(5.5, 0.1^2)$).
It&rsquo;s always impossible to see signs of multimodality on the classic histograms or the KDE plots.
Meanwhile, the Harrell-Davis-based QRDE solves highlights multimodality without any problems.
When two modes are clearly expressed, we will always see it on such a plot regardless of the total range, the distance between modes, and the noise pattern.</p><p><strong>It highlights multimodality even there are too many modes.</strong></p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/qrde-hd/img/comparison-20-light.svg target=_blank alt=comparison-20><img src=/posts/qrde-hd/img/comparison-20-light.svg width=800>
</a><a class="img-dark hidden" href=/posts/qrde-hd/img/comparison-20-dark.svg target=_blank alt=comparison-20><img src=/posts/qrde-hd/img/comparison-20-dark.svg width=800></a></div><p>Here we have a multimodal distribution with 20 modes (a combination of $\mathcal{N}(4i, 1^2)$ for $i \in \{ 1..20\}$; 100 elements from each).
It&rsquo;s completely impossible to detect such multimodality using the KDE; these plots are too smooth for this problem.
It&rsquo;s also impossible to distinguish such a situation from regular noise using classic histograms (another example of the bandwidth problem).
In contrast, the Harrell-Davis-based QRDE doesn&rsquo;t have a limitation on the number of modes:
it always able to detect all the modes while they are clearly expressed.</p><h3 id=conclusion>Conclusion</h3><p>Currently, the QRDE-HD quantile estimator is my favorite way to present the collected sample&rsquo;s raw shape.
I want to highlight one more time two main advantages that I described in this post:</p><ul><li><strong>Quantile-consistency</strong><br>It&rsquo;s safe to show quantile values on such a plot: it will always be consistent with the presented density.</li><li><strong>Multimodality detection</strong><br>It will not hide multimodality phenomena from you, which makes it a convenient tool to explore samples from non-parametric distributions.
In future posts, I will present an algorithm that detects locations of all existing modes.</li></ul><h3 id=references>References</h3><ul><li><b id=Hyndman1996>[Hyndman1996]</b><br>Hyndman, R. J. and Fan, Y. 1996. Sample quantiles in statistical packages, <em>American Statistician</em> 50, 361–365.<br><a href=https://doi.org/10.2307/2684934>https://doi.org/10.2307/2684934</a></li><li><b id=Harrell1982>[Harrell1982]</b><br>Harrell, F.E. and Davis, C.E., 1982. A new distribution-free quantile estimator.
<em>Biometrika</em>, 69(3), pp.635-640.<br><a href=https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf>https://pdfs.semanticscholar.org/1a48/9bb74293753023c5bb6bff8e41e8fe68060f.pdf</a></li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>In the first version of this post, I used term &ldquo;empirical probability density function.&rdquo;
After some thoughts, I decided to rename it to &ldquo;quantile-respectful density estimation.&rdquo;
The new term is not so confusing
(the suggested function is significantly different from the <a href=https://en.wikipedia.org/wiki/Empirical_distribution_function>empirical function</a>)
and it describes the underlying concept much better.
<a href=http://thecodelesscode.com/case/220>Naming is hard</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><br><br></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>