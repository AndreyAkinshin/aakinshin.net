<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research"><title>Discrete performance distributions | Andrey Akinshin</title><meta name=description content="When we collect software performance measurements, we get a bunch of time intervals. Typically, we tend to interpret time values as continuous values. Howe..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script src=https://cdn.tailwindcss.com/3.2.4></script>
<script>tailwind.config={darkMode:"class"}</script><style type=text/tailwindcss>
    @layer base {
       
       
      body {
        @apply bg-white dark:bg-zinc-800;
        @apply text-black dark:text-gray-400;
      }
      nav {
        @apply bg-sky-800 dark:bg-zinc-900;
      }
      a {
        @apply text-sky-600 dark:text-white;
        @apply no-underline;
      }
      .main-content a:not(.label-link) {
        @apply hover:underline;
      }
      hr {
        @apply h-px my-3 border-0 bg-gray-300 dark:bg-gray-600;
      }
      h1, h2, h3, h4, h5, h6 {
        @apply leading-tight;
      }
      h1, h2, h3 {
        @apply text-4xl py-4;
      }
      h4 {
        @apply text-3xl py-3;
      }
      h5, h6 {
        @apply text-2xl py-2;
      }
      table {
        @apply border self-center mx-auto;
      }
      th, td {
        @apply border p-2
      }
      blockquote {
        @apply border-l-8 border-gray-300 bg-gray-100 dark:border-zinc-600 dark:bg-zinc-700;
        @apply ml-4 my-4 pl-4 py-2;
      }

       
      .main ul {
        @apply list-disc ml-10 my-2;
      }
      .main ol {
        @apply list-decimal ml-10 my-2;
      }
      .main p {
        @apply mb-3;
      }

       
      .label {
        @apply mx-1 px-1 py-0.5;
        @apply rounded border border-gray-400 dark:border-gray-500;
      }
      .label-link {
        @apply mx-1 px-1 py-0.5;
        @apply rounded border border-sky-600 dark:border-slate-400;
        @apply hover:bg-sky-200 dark:hover:bg-gray-500;
      }
      .nav-item {
        @apply text-white hover:bg-sky-700 dark:hover:bg-gray-700;
      }

       
      .paginator {
        @apply flex flex-wrap justify-center mb-4;
      }
      .paginator .page-item {
        @apply inline-flex border rounded px-3 py-1;
      }
      .paginator .page-item:not(.active):not(.disabled) {
        @apply border-gray-400 dark:border-gray-400;
      }
      .paginator .page-item.active {
        @apply border-sky-600 dark:border-white;
      }
      .paginator .page-item.disabled {
        @apply bg-gray-50 dark:bg-gray-500 dark:border-gray-400;
      }
      .paginator .page-item.disabled a {
        @apply text-gray-400 dark:text-gray-400;
      }

       
      .anchorjs-link {
        transition: all .25s linear;
      }
      *:hover > .anchorjs-link {
        margin-left: -1.125em !important;
      }

       
      .block-example {
        margin-top: 10px;
        margin-bottom: 10px;
      
        margin-left: 10px;
        padding-left: 10px;
      
        border-left: 5px solid;
        border-color: grey;
      }
      .block-example-title::before {  
        counter-increment: example;
        content: "Example " counter(example);
      }
      body {
        counter-reset: example;
      }

       
      #about-profiles svg {
        margin-right: 0.7rem;
      }
      #about p, #about ul {
        margin-top: 0rem;
        margin-bottom: 0rem;
      }
      #about ol {
        @apply ml-10;
      }
      #about img {
        height: 18px;
        @apply inline-flex;
      }
      .about-compact p {
        text-indent: 20px !important;
        margin: 0 !important;
      }

       
      .d-none { display:none; }

       
      code.has-jax {
        -webkit-font-smoothing: antialiased;
        background: inherit !important;
        border: none !important;
        font-size: 100%;
      }

       
      .fai {
        @apply inline-flex;
        height: 1.2em;
        width: 1.2em;
        padding-right: 0.4em;
        fill: currentColor;
      }
      .fai-link {
        @apply hover:text-sky-400 dark:hover:text-blue-400;
      }
      .label-link .fai {
        @apply pl-1 pb-1;
        height: 1.5em;
        width: 1.5em;
      }

       
      .chroma {
        @apply my-5 overflow-y-scroll;
        border-radius: 3px;
        border: 1px solid #C3CCD0;
        padding: 0.5em;
      }
        .chroma { background-color: #ffffff }
        .chroma .x {  }
        .chroma .err { color: #a61717; background-color: #e3d2d2 }
        .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
        .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
        .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
        .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .chroma .k { color: #000000; font-weight: bold }
        .chroma .kc { color: #000000; font-weight: bold }
        .chroma .kd { color: #000000; font-weight: bold }
        .chroma .kn { color: #000000; font-weight: bold }
        .chroma .kp { color: #000000; font-weight: bold }
        .chroma .kr { color: #000000; font-weight: bold }
        .chroma .kt { color: #445588; font-weight: bold }
        .chroma .n {  }
        .chroma .na { color: #008080 }
        .chroma .nb { color: #0086b3 }
        .chroma .bp { color: #999999 }
        .chroma .nc { color: #445588; font-weight: bold }
        .chroma .no { color: #008080 }
        .chroma .nd { color: #3c5d5d; font-weight: bold }
        .chroma .ni { color: #800080 }
        .chroma .ne { color: #990000; font-weight: bold }
        .chroma .nf { color: #990000; font-weight: bold }
        .chroma .fm {  }
        .chroma .nl { color: #990000; font-weight: bold }
        .chroma .nn { color: #555555 }
        .chroma .nx {  }
        .chroma .py {  }
        .chroma .nt { color: #000080 }
        .chroma .nv { color: #008080 }
        .chroma .vc { color: #008080 }
        .chroma .vg { color: #008080 }
        .chroma .vi { color: #008080 }
        .chroma .vm {  }
        .chroma .l {  }
        .chroma .ld {  }
        .chroma .s { color: #dd1144 }
        .chroma .sa { color: #dd1144 }
        .chroma .sb { color: #dd1144 }
        .chroma .sc { color: #dd1144 }
        .chroma .dl { color: #dd1144 }
        .chroma .sd { color: #dd1144 }
        .chroma .s2 { color: #dd1144 }
        .chroma .se { color: #dd1144 }
        .chroma .sh { color: #dd1144 }
        .chroma .si { color: #dd1144 }
        .chroma .sx { color: #dd1144 }
        .chroma .sr { color: #009926 }
        .chroma .s1 { color: #dd1144 }
        .chroma .ss { color: #990073 }
        .chroma .m { color: #009999 }
        .chroma .mb { color: #009999 }
        .chroma .mf { color: #009999 }
        .chroma .mh { color: #009999 }
        .chroma .mi { color: #009999 }
        .chroma .il { color: #009999 }
        .chroma .mo { color: #009999 }
        .chroma .o { color: #000000; font-weight: bold }
        .chroma .ow { color: #000000; font-weight: bold }
        .chroma .p {  }
        .chroma .c { color: #999988; font-style: italic }
        .chroma .ch { color: #999988; font-style: italic }
        .chroma .cm { color: #999988; font-style: italic }
        .chroma .c1 { color: #999988; font-style: italic }
        .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
        .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
        .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
        .chroma .g {  }
        .chroma .gd { color: #000000; background-color: #ffdddd }
        .chroma .ge { color: #000000; font-style: italic }
        .chroma .gr { color: #aa0000 }
        .chroma .gh { color: #999999 }
        .chroma .gi { color: #000000; background-color: #ddffdd }
        .chroma .go { color: #888888 }
        .chroma .gp { color: #555555 }
        .chroma .gs { font-weight: bold }
        .chroma .gu { color: #aaaaaa }
        .chroma .gt { color: #aa0000 }
        .chroma .gl { text-decoration: underline }
        .chroma .w { color: #bbbbbb }
        .dark.chroma { color: #f8f8f2; background-color: #272822 }
        .dark .chroma { color: #f8f8f2; background-color: #272822 }
        .dark .chroma .x {  }
        .dark .chroma .err { color: #960050; background-color: #1e0010 }
        .dark .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
        .dark .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
        .dark .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
        .dark .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .dark .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
        .dark .chroma .k { color: #66d9ef }
        .dark .chroma .kc { color: #66d9ef }
        .dark .chroma .kd { color: #66d9ef }
        .dark .chroma .kn { color: #f92672 }
        .dark .chroma .kp { color: #66d9ef }
        .dark .chroma .kr { color: #66d9ef }
        .dark .chroma .kt { color: #66d9ef }
        .dark .chroma .n {  }
        .dark .chroma .na { color: #a6e22e }
        .dark .chroma .nb {  }
        .dark .chroma .bp {  }
        .dark .chroma .nc { color: #a6e22e }
        .dark .chroma .no { color: #66d9ef }
        .dark .chroma .nd { color: #a6e22e }
        .dark .chroma .ni {  }
        .dark .chroma .ne { color: #a6e22e }
        .dark .chroma .nf { color: #a6e22e }
        .dark .chroma .fm {  }
        .dark .chroma .nl {  }
        .dark .chroma .nn {  }
        .dark .chroma .nx { color: #a6e22e }
        .dark .chroma .py {  }
        .dark .chroma .nt { color: #f92672 }
        .dark .chroma .nv {  }
        .dark .chroma .vc {  }
        .dark .chroma .vg {  }
        .dark .chroma .vi {  }
        .dark .chroma .vm {  }
        .dark .chroma .l { color: #ae81ff }
        .dark .chroma .ld { color: #e6db74 }
        .dark .chroma .s { color: #e6db74 }
        .dark .chroma .sa { color: #e6db74 }
        .dark .chroma .sb { color: #e6db74 }
        .dark .chroma .sc { color: #e6db74 }
        .dark .chroma .dl { color: #e6db74 }
        .dark .chroma .sd { color: #e6db74 }
        .dark .chroma .s2 { color: #e6db74 }
        .dark .chroma .se { color: #ae81ff }
        .dark .chroma .sh { color: #e6db74 }
        .dark .chroma .si { color: #e6db74 }
        .dark .chroma .sx { color: #e6db74 }
        .dark .chroma .sr { color: #e6db74 }
        .dark .chroma .s1 { color: #e6db74 }
        .dark .chroma .ss { color: #e6db74 }
        .dark .chroma .m { color: #ae81ff }
        .dark .chroma .mb { color: #ae81ff }
        .dark .chroma .mf { color: #ae81ff }
        .dark .chroma .mh { color: #ae81ff }
        .dark .chroma .mi { color: #ae81ff }
        .dark .chroma .il { color: #ae81ff }
        .dark .chroma .mo { color: #ae81ff }
        .dark .chroma .o { color: #f92672 }
        .dark .chroma .ow { color: #f92672 }
        .dark .chroma .p {  }
        .dark .chroma .c { color: #75715e }
        .dark .chroma .ch { color: #75715e }
        .dark .chroma .cm { color: #75715e }
        .dark .chroma .c1 { color: #75715e }
        .dark .chroma .cs { color: #75715e }
        .dark .chroma .cp { color: #75715e }
        .dark .chroma .cpf { color: #75715e }
        .dark .chroma .g {  }
        .dark .chroma .gd { color: #f92672 }
        .dark .chroma .ge { font-style: italic }
        .dark .chroma .gr {  }
        .dark .chroma .gh {  }
        .dark .chroma .gi { color: #a6e22e }
        .dark .chroma .go {  }
        .dark .chroma .gp {  }
        .dark .chroma .gs { font-weight: bold }
        .dark .chroma .gu { color: #75715e }
        .dark .chroma .gt {  }
        .dark .chroma .gl {  }
        .dark .chroma .w {  }
    }
  </style><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-6 h-6"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Discrete performance distributions</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai"><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2021-06-15>June 15, 2021</time><svg class="fai ml-3"><use xlink:href="/img/fa/all.svg#tag"/></svg>
<a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a></div><br><div class=main-content><p>When we collect software performance measurements, we get a bunch of time intervals.
Typically, we tend to interpret time values as continuous values.
However, the obtained values are actually discrete due to the limited resolution of our measurement tool.
In simple cases, we can treat these discrete values as continuous and get meaningful results.
Unfortunately, discretization may produce strange phenomena like pseudo-multimodality or zero dispersion.
If we want to set up a reliable system that automatically analyzes such distributions,
we should be aware of such problems so we could correctly handle them.</p><p>In this post, I want to share a few of discretization problems in real-life performance data sets
(based on the <a href=https://www.jetbrains.com/rider/>Rider</a> performance tests).</p><h3 id=general-discretization>General discretization</h3><p>The most simple way to get discretization phenomena
is to limit the resolution of your performance measurements to milliseconds.
It&rsquo;s a perfectly legitimate approach when you don&rsquo;t care about better precision.
As a result, we can obtain a timeline plot like this:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-timeline-light.png target=_blank alt=startup-base_LaF_creation-timeline><img src=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-timeline-light.png width=800></a>
<a class="img-dark hidden" href=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-timeline-dark.png target=_blank alt=startup-base_LaF_creation-timeline><img src=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-timeline-dark.png width=800></a></div><p>And here is the corresponding histogram (binwidth = 1):</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-hist-light.png target=_blank alt=startup-base_LaF_creation-hist><img src=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-hist-light.png width=800></a>
<a class="img-dark hidden" href=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-hist-dark.png target=_blank alt=startup-base_LaF_creation-hist><img src=/posts/discrete-performance-distributions/img/startup-base_LaF_creation-hist-dark.png width=800></a></div><p>This histogram can be treated as an estimation of
the <a href=https://en.wikipedia.org/wiki/Probability_mass_function>probability mass function</a>
of the underlying discrete distribution.
However, if we try to treat this distribution as a continuous one and build a density estimation,
we can get a <a href=https://aakinshin.net/posts/kde-discrete/>corrupted visualization</a>.
This problem can be resolved for different kinds of density estimations using jittering
(I already blogged about how to do it for the <a href=https://aakinshin.net/posts/discrete-sample-jittering/>kernel density estimation (KDE)</a>
and <a href=https://aakinshin.net/posts/qrde-discrete/>quantile-respectful density estimation (QRDE)</a>).</p><h3 id=zero-median-and-zero-mad>Zero median and zero MAD</h3><p>Here is another timeline plot based on real-life performance measurements:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/discrete-performance-distributions/img/findusages-total-timeline-light.png target=_blank alt=findusages-total-timeline><img src=/posts/discrete-performance-distributions/img/findusages-total-timeline-light.png width=800></a>
<a class="img-dark hidden" href=/posts/discrete-performance-distributions/img/findusages-total-timeline-dark.png target=_blank alt=findusages-total-timeline><img src=/posts/discrete-performance-distributions/img/findusages-total-timeline-dark.png width=800></a></div><p>And here is the corresponding histogram:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/discrete-performance-distributions/img/findusages-total-hist-light.png target=_blank alt=findusages-total-hist><img src=/posts/discrete-performance-distributions/img/findusages-total-hist-light.png width=800></a>
<a class="img-dark hidden" href=/posts/discrete-performance-distributions/img/findusages-total-hist-dark.png target=_blank alt=findusages-total-hist><img src=/posts/discrete-performance-distributions/img/findusages-total-hist-dark.png width=800></a></div><p>It&rsquo;s hard to work with such a histogram because of the scale, so here is its raw data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>   <span class=mi>0</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>3</span>    <span class=mi>4</span>    <span class=mi>5</span>    <span class=mi>6</span>    <span class=mi>7</span>    <span class=mi>8</span>    <span class=mi>9</span>   <span class=mi>10</span>   <span class=mi>11</span>   <span class=mi>12</span>   <span class=mi>13</span>   <span class=mi>14</span>   <span class=mi>15</span> 
</span></span><span class=line><span class=cl><span class=mi>1996</span>   <span class=mi>92</span>   <span class=mi>45</span>   <span class=mi>23</span>   <span class=mi>20</span>   <span class=mi>21</span>   <span class=mi>14</span>    <span class=mi>5</span>   <span class=mi>11</span>    <span class=mi>5</span>    <span class=mi>8</span>    <span class=mi>8</span>    <span class=mi>3</span>    <span class=mi>3</span>    <span class=mi>9</span>    <span class=mi>5</span> 
</span></span><span class=line><span class=cl>  <span class=mi>16</span>   <span class=mi>17</span>   <span class=mi>18</span>   <span class=mi>19</span>   <span class=mi>20</span>   <span class=mi>21</span>   <span class=mi>22</span>   <span class=mi>23</span>   <span class=mi>25</span>   <span class=mi>26</span>   <span class=mi>27</span>   <span class=mi>31</span>   <span class=mi>33</span>   <span class=mi>34</span>   <span class=mi>35</span>   <span class=mi>36</span> 
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mi>5</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>3</span>    <span class=mi>5</span>    <span class=mi>4</span>    <span class=mi>1</span>    <span class=mi>4</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span> 
</span></span><span class=line><span class=cl>  <span class=mi>37</span>   <span class=mi>41</span>   <span class=mi>46</span>   <span class=mi>49</span>   <span class=mi>56</span>   <span class=mi>62</span>   <span class=mi>63</span>   <span class=mi>65</span>   <span class=mi>71</span>   <span class=mi>72</span>   <span class=mi>73</span>   <span class=mi>85</span>   <span class=mi>91</span>   <span class=mi>94</span>   <span class=mi>95</span>   <span class=mi>97</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl>  <span class=mi>98</span>  <span class=mi>100</span>  <span class=mi>102</span>  <span class=mi>103</span>  <span class=mi>107</span>  <span class=mi>109</span>  <span class=mi>114</span>  <span class=mi>117</span>  <span class=mi>119</span>  <span class=mi>124</span>  <span class=mi>125</span>  <span class=mi>126</span>  <span class=mi>132</span>  <span class=mi>136</span>  <span class=mi>138</span>  <span class=mi>140</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span> 
</span></span><span class=line><span class=cl> <span class=mi>143</span>  <span class=mi>146</span>  <span class=mi>147</span>  <span class=mi>148</span>  <span class=mi>152</span>  <span class=mi>153</span>  <span class=mi>158</span>  <span class=mi>160</span>  <span class=mi>161</span>  <span class=mi>162</span>  <span class=mi>163</span>  <span class=mi>164</span>  <span class=mi>165</span>  <span class=mi>166</span>  <span class=mi>167</span>  <span class=mi>168</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>172</span>  <span class=mi>173</span>  <span class=mi>175</span>  <span class=mi>177</span>  <span class=mi>178</span>  <span class=mi>179</span>  <span class=mi>183</span>  <span class=mi>184</span>  <span class=mi>185</span>  <span class=mi>186</span>  <span class=mi>187</span>  <span class=mi>188</span>  <span class=mi>189</span>  <span class=mi>190</span>  <span class=mi>196</span>  <span class=mi>199</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>201</span>  <span class=mi>203</span>  <span class=mi>204</span>  <span class=mi>206</span>  <span class=mi>209</span>  <span class=mi>211</span>  <span class=mi>215</span>  <span class=mi>217</span>  <span class=mi>218</span>  <span class=mi>223</span>  <span class=mi>224</span>  <span class=mi>231</span>  <span class=mi>238</span>  <span class=mi>242</span>  <span class=mi>243</span>  <span class=mi>246</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>260</span>  <span class=mi>261</span>  <span class=mi>262</span>  <span class=mi>263</span>  <span class=mi>264</span>  <span class=mi>265</span>  <span class=mi>273</span>  <span class=mi>288</span>  <span class=mi>289</span>  <span class=mi>295</span>  <span class=mi>297</span>  <span class=mi>298</span>  <span class=mi>303</span>  <span class=mi>309</span>  <span class=mi>313</span>  <span class=mi>320</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>347</span>  <span class=mi>350</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span> 
</span></span></code></pre></div><p>These numbers mean the follow: we observed <code>0ms</code> 1996 times, <code>1ms</code> 92 times, <code>2ms</code> 45 times, and so on.
And here are the same set of numbers scaled to percents:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=mi>0</span>     <span class=mi>1</span>     <span class=mi>2</span>     <span class=mi>3</span>     <span class=mi>4</span>     <span class=mi>5</span>     <span class=mi>6</span>     <span class=mi>7</span>     <span class=mi>8</span>     <span class=mi>9</span>    <span class=mi>10</span>    <span class=mi>11</span>    <span class=mi>12</span> 
</span></span><span class=line><span class=cl><span class=mf>82.68</span>  <span class=mf>3.81</span>  <span class=mf>1.86</span>  <span class=mf>0.95</span>  <span class=mf>0.83</span>  <span class=mf>0.87</span>  <span class=mf>0.58</span>  <span class=mf>0.21</span>  <span class=mf>0.46</span>  <span class=mf>0.21</span>  <span class=mf>0.33</span>  <span class=mf>0.33</span>  <span class=mf>0.12</span> 
</span></span><span class=line><span class=cl>   <span class=mi>13</span>    <span class=mi>14</span>    <span class=mi>15</span>    <span class=mi>16</span>    <span class=mi>17</span>    <span class=mi>18</span>    <span class=mi>19</span>    <span class=mi>20</span>    <span class=mi>21</span>    <span class=mi>22</span>    <span class=mi>23</span>    <span class=mi>25</span>    <span class=mi>26</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.12</span>  <span class=mf>0.37</span>  <span class=mf>0.21</span>  <span class=mf>0.12</span>  <span class=mf>0.21</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.12</span>  <span class=mf>0.21</span>  <span class=mf>0.17</span>  <span class=mf>0.04</span>  <span class=mf>0.17</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>   <span class=mi>27</span>    <span class=mi>31</span>    <span class=mi>33</span>    <span class=mi>34</span>    <span class=mi>35</span>    <span class=mi>36</span>    <span class=mi>37</span>    <span class=mi>41</span>    <span class=mi>46</span>    <span class=mi>49</span>    <span class=mi>56</span>    <span class=mi>62</span>    <span class=mi>63</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span> 
</span></span><span class=line><span class=cl>   <span class=mi>65</span>    <span class=mi>71</span>    <span class=mi>72</span>    <span class=mi>73</span>    <span class=mi>85</span>    <span class=mi>91</span>    <span class=mi>94</span>    <span class=mi>95</span>    <span class=mi>97</span>    <span class=mi>98</span>   <span class=mi>100</span>   <span class=mi>102</span>   <span class=mi>103</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>107</span>   <span class=mi>109</span>   <span class=mi>114</span>   <span class=mi>117</span>   <span class=mi>119</span>   <span class=mi>124</span>   <span class=mi>125</span>   <span class=mi>126</span>   <span class=mi>132</span>   <span class=mi>136</span>   <span class=mi>138</span>   <span class=mi>140</span>   <span class=mi>143</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>146</span>   <span class=mi>147</span>   <span class=mi>148</span>   <span class=mi>152</span>   <span class=mi>153</span>   <span class=mi>158</span>   <span class=mi>160</span>   <span class=mi>161</span>   <span class=mi>162</span>   <span class=mi>163</span>   <span class=mi>164</span>   <span class=mi>165</span>   <span class=mi>166</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>167</span>   <span class=mi>168</span>   <span class=mi>172</span>   <span class=mi>173</span>   <span class=mi>175</span>   <span class=mi>177</span>   <span class=mi>178</span>   <span class=mi>179</span>   <span class=mi>183</span>   <span class=mi>184</span>   <span class=mi>185</span>   <span class=mi>186</span>   <span class=mi>187</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>188</span>   <span class=mi>189</span>   <span class=mi>190</span>   <span class=mi>196</span>   <span class=mi>199</span>   <span class=mi>201</span>   <span class=mi>203</span>   <span class=mi>204</span>   <span class=mi>206</span>   <span class=mi>209</span>   <span class=mi>211</span>   <span class=mi>215</span>   <span class=mi>217</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>218</span>   <span class=mi>223</span>   <span class=mi>224</span>   <span class=mi>231</span>   <span class=mi>238</span>   <span class=mi>242</span>   <span class=mi>243</span>   <span class=mi>246</span>   <span class=mi>260</span>   <span class=mi>261</span>   <span class=mi>262</span>   <span class=mi>263</span>   <span class=mi>264</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>265</span>   <span class=mi>273</span>   <span class=mi>288</span>   <span class=mi>289</span>   <span class=mi>295</span>   <span class=mi>297</span>   <span class=mi>298</span>   <span class=mi>303</span>   <span class=mi>309</span>   <span class=mi>313</span>   <span class=mi>320</span>   <span class=mi>347</span>   <span class=mi>350</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>
</span></span></code></pre></div><p>Thus, we observed <code>0ms</code> in the 92.69% cases, <code>1ms</code> in the 3.81% cases, <code>2ms</code> in 1.86% cases, and so on.
In this data set, both the median and the median absolute deviations are zero.
It produces some complications if you use the median as the primary summary metric.</p><p>There are two main ways to resolve this problem.
The first one is to work with higher quantiles instead of the median.
In this case, we can describe the dispersion using the <a href=https://aakinshin.net/posts/qad/>quantile absolute deviation (QAD)</a>
instead of the median absolute deviation (MAD).
The second way is to build a model that describes the underlying distribution.
In the above example, the observed data could be perfectly described using the
<a href=https://en.wikipedia.org/wiki/Discrete_Weibull_distribution>discrete Weibull distribution</a>.
However, this approach is much more complicated in the general case and
it requires decent skills in the extreme value theory.</p><h3 id=dirac-delta-function>Dirac delta function</h3><p>And here is one more timeline plot:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-timeline-light.png target=_blank alt=orchard-AllAssembliesCount-timeline><img src=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-timeline-light.png width=800></a>
<a class="img-dark hidden" href=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-timeline-dark.png target=_blank alt=orchard-AllAssembliesCount-timeline><img src=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-timeline-dark.png width=800></a></div><p>All the observed values are equal, so the corresponding histogram contains a single bin:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-hist-light.png target=_blank alt=orchard-AllAssembliesCount-hist><img src=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-hist-light.png width=800></a>
<a class="img-dark hidden" href=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-hist-dark.png target=_blank alt=orchard-AllAssembliesCount-hist><img src=/posts/discrete-performance-distributions/img/orchard-AllAssembliesCount-hist-dark.png width=800></a></div><p>This constant distribution can be described using the
<a href=https://en.wikipedia.org/wiki/Dirac_delta_function>Dirac delta function</a>.
Non-zero constant distribution is not so typical for time measurements,
but it&rsquo;s a common pattern for advanced performance metrics
like the number of garbage collections or the final memory footprint.</p><h3 id=conclusion>Conclusion</h3><p>The real-life samples are not always easy to analyze.
There is always a risk of getting a &ldquo;corner case&rdquo; distribution (e.g., with zero dispersion)
that will completely break your &ldquo;general case&rdquo; equations.
If you want to set up an automatic system that works with real-life data, it&rsquo;s always a good idea to think
about such cases in advance and implement corresponding checks.</p></div><br><br><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fdiscrete-performance-distributions%2f&title=Discrete%20performance%20distributions" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Discrete%20performance%20distributions&url=https%3a%2f%2faakinshin.net%2fposts%2fdiscrete-performance-distributions%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fdiscrete-performance-distributions%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fdiscrete-performance-distributions%2f&title=Discrete%20performance%20distributions" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2022 Andrey Akinshin</span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>anchors.options={placement:"left",icon:"§"},anchors.add("h1"),anchors.add("h2"),anchors.add("h3")</script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>