<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Effect Size,Research: Gamma Effect Size,MAD"><title>Calculating gamma effect size for samples with zero median absolute deviation | Andrey Akinshin</title><meta name=description content="In previous posts, I discussed the gamma effect size which is a Cohen&amp;rsquo;s d-consistent nonparametric and robust measure of the effect size. Also, I dis..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.62716e7c1ef4ceec024205096879cb60e17cf1138bc01a72d8d4b95b8822d168.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class="px-3 text-white" href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Calculating gamma effect size for samples with zero median absolute deviation</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg><time datetime=2021-06-22>June 22, 2021</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/research/>Research</a>
<a class=label-link href=https://aakinshin.net/tags/effect-size/>Effect Size</a>
<a class=label-link href=https://aakinshin.net/tags/research-gamma-es/>Research: Gamma Effect Size</a>
<a class=label-link href=https://aakinshin.net/tags/mad/>MAD</a></div></div><br><div class=main-content><p>In previous posts, I discussed the <a href=https://aakinshin.net/posts/nonparametric-effect-size/>gamma effect size</a>
which is a Cohen&rsquo;s d-consistent nonparametric and robust measure of the effect size.
Also, I discussed <a href=https://aakinshin.net/posts/nonparametric-effect-size2/>various ways to customize this metric</a>
and adjust it to different kinds of business requirements.
In this post, I want to briefly cover one more corner case that requires special adjustments.
We are going to discuss the situation when the median absolute deviation is zero.</p><h3 id=recall>Recall</h3><p>First of all, recall the general equation for the gamma effect size for the <span class="math inline">\(p^\textrm{th}\)</span> quantile:</p><p><span class="math display">\[\gamma_p = \frac{Q_p(y) - Q_p(x)}{\operatorname{PMAD}_{xy}}
\]</span></p><p>where <span class="math inline">\(Q_p\)</span> is a quantile estimator of the <span class="math inline">\(p^\textrm{th}\)</span> quantile,
<span class="math inline">\(\operatorname{PMAD}_{xy}\)</span> is the pooled median absolute deviation:</p><p><span class="math display">\[\operatorname{PMAD}_{xy} = \sqrt{\frac{(n_x - 1) \operatorname{MAD}^2_x + (n_y - 1) \operatorname{MAD}^2_y}{n_x + n_y - 2}},
\]</span></p><p><span class="math inline">\(\operatorname{MAD}_x\)</span> and <span class="math inline">\(\operatorname{MAD}_y\)</span> are the median absolute deviations of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>:</p><p><span class="math display">\[\operatorname{MAD}_x = C_{n_x} \cdot Q_{0.5}(|x_i - Q_{0.5}(x)|), \quad
\operatorname{MAD}_y = C_{n_y} \cdot Q_{0.5}(|y_i - Q_{0.5}(y)|),
\]</span></p><p><span class="math inline">\(C_{n_x}\)</span> and <span class="math inline">\(C_{n_y}\)</span> are consistency constants
that makes <span class="math inline">\(\operatorname{MAD}\)</span> a consistent estimator for the standard deviation estimation.</p><h3 id=the-problem>The problem</h3><p>Here is a real-life dataset from <a href=https://aakinshin.net/posts/discrete-performance-distributions/>my previous post</a>:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/zero-mad-gamma-es/img/findusages-total-timeline-light.png target=_blank alt=findusages-total-timeline><img src=/posts/zero-mad-gamma-es/img/findusages-total-timeline-light.png width=800></a>
<a class="img-dark hidden" href=/posts/zero-mad-gamma-es/img/findusages-total-timeline-dark.png target=_blank alt=findusages-total-timeline><img src=/posts/zero-mad-gamma-es/img/findusages-total-timeline-dark.png width=800></a></div><p>And here is the corresponding histogram:</p><div class="flex my-7 justify-center"><a class="img-light hidden" href=/posts/zero-mad-gamma-es/img/findusages-total-hist-light.png target=_blank alt=findusages-total-hist><img src=/posts/zero-mad-gamma-es/img/findusages-total-hist-light.png width=800></a>
<a class="img-dark hidden" href=/posts/zero-mad-gamma-es/img/findusages-total-hist-dark.png target=_blank alt=findusages-total-hist><img src=/posts/zero-mad-gamma-es/img/findusages-total-hist-dark.png width=800></a></div><p>It&rsquo;s hard to work with such a histogram because of the scale, so here is its raw data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>   <span class=mi>0</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>3</span>    <span class=mi>4</span>    <span class=mi>5</span>    <span class=mi>6</span>    <span class=mi>7</span>    <span class=mi>8</span>    <span class=mi>9</span>   <span class=mi>10</span>   <span class=mi>11</span>   <span class=mi>12</span>   <span class=mi>13</span>   <span class=mi>14</span>   <span class=mi>15</span> 
</span></span><span class=line><span class=cl><span class=mi>1996</span>   <span class=mi>92</span>   <span class=mi>45</span>   <span class=mi>23</span>   <span class=mi>20</span>   <span class=mi>21</span>   <span class=mi>14</span>    <span class=mi>5</span>   <span class=mi>11</span>    <span class=mi>5</span>    <span class=mi>8</span>    <span class=mi>8</span>    <span class=mi>3</span>    <span class=mi>3</span>    <span class=mi>9</span>    <span class=mi>5</span> 
</span></span><span class=line><span class=cl>  <span class=mi>16</span>   <span class=mi>17</span>   <span class=mi>18</span>   <span class=mi>19</span>   <span class=mi>20</span>   <span class=mi>21</span>   <span class=mi>22</span>   <span class=mi>23</span>   <span class=mi>25</span>   <span class=mi>26</span>   <span class=mi>27</span>   <span class=mi>31</span>   <span class=mi>33</span>   <span class=mi>34</span>   <span class=mi>35</span>   <span class=mi>36</span> 
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mi>5</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>3</span>    <span class=mi>5</span>    <span class=mi>4</span>    <span class=mi>1</span>    <span class=mi>4</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span> 
</span></span><span class=line><span class=cl>  <span class=mi>37</span>   <span class=mi>41</span>   <span class=mi>46</span>   <span class=mi>49</span>   <span class=mi>56</span>   <span class=mi>62</span>   <span class=mi>63</span>   <span class=mi>65</span>   <span class=mi>71</span>   <span class=mi>72</span>   <span class=mi>73</span>   <span class=mi>85</span>   <span class=mi>91</span>   <span class=mi>94</span>   <span class=mi>95</span>   <span class=mi>97</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl>  <span class=mi>98</span>  <span class=mi>100</span>  <span class=mi>102</span>  <span class=mi>103</span>  <span class=mi>107</span>  <span class=mi>109</span>  <span class=mi>114</span>  <span class=mi>117</span>  <span class=mi>119</span>  <span class=mi>124</span>  <span class=mi>125</span>  <span class=mi>126</span>  <span class=mi>132</span>  <span class=mi>136</span>  <span class=mi>138</span>  <span class=mi>140</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span> 
</span></span><span class=line><span class=cl> <span class=mi>143</span>  <span class=mi>146</span>  <span class=mi>147</span>  <span class=mi>148</span>  <span class=mi>152</span>  <span class=mi>153</span>  <span class=mi>158</span>  <span class=mi>160</span>  <span class=mi>161</span>  <span class=mi>162</span>  <span class=mi>163</span>  <span class=mi>164</span>  <span class=mi>165</span>  <span class=mi>166</span>  <span class=mi>167</span>  <span class=mi>168</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>172</span>  <span class=mi>173</span>  <span class=mi>175</span>  <span class=mi>177</span>  <span class=mi>178</span>  <span class=mi>179</span>  <span class=mi>183</span>  <span class=mi>184</span>  <span class=mi>185</span>  <span class=mi>186</span>  <span class=mi>187</span>  <span class=mi>188</span>  <span class=mi>189</span>  <span class=mi>190</span>  <span class=mi>196</span>  <span class=mi>199</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>201</span>  <span class=mi>203</span>  <span class=mi>204</span>  <span class=mi>206</span>  <span class=mi>209</span>  <span class=mi>211</span>  <span class=mi>215</span>  <span class=mi>217</span>  <span class=mi>218</span>  <span class=mi>223</span>  <span class=mi>224</span>  <span class=mi>231</span>  <span class=mi>238</span>  <span class=mi>242</span>  <span class=mi>243</span>  <span class=mi>246</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>260</span>  <span class=mi>261</span>  <span class=mi>262</span>  <span class=mi>263</span>  <span class=mi>264</span>  <span class=mi>265</span>  <span class=mi>273</span>  <span class=mi>288</span>  <span class=mi>289</span>  <span class=mi>295</span>  <span class=mi>297</span>  <span class=mi>298</span>  <span class=mi>303</span>  <span class=mi>309</span>  <span class=mi>313</span>  <span class=mi>320</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>2</span>    <span class=mi>1</span>    <span class=mi>1</span>    <span class=mi>1</span> 
</span></span><span class=line><span class=cl> <span class=mi>347</span>  <span class=mi>350</span> 
</span></span><span class=line><span class=cl>   <span class=mi>1</span>    <span class=mi>1</span> 
</span></span></code></pre></div><p>These numbers mean the follow: we observed <code>0ms</code> 1996 times, <code>1ms</code> 92 times, <code>2ms</code> 45 times, and so on.
And here are the same set of numbers scaled to percents:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=mi>0</span>     <span class=mi>1</span>     <span class=mi>2</span>     <span class=mi>3</span>     <span class=mi>4</span>     <span class=mi>5</span>     <span class=mi>6</span>     <span class=mi>7</span>     <span class=mi>8</span>     <span class=mi>9</span>    <span class=mi>10</span>    <span class=mi>11</span>    <span class=mi>12</span> 
</span></span><span class=line><span class=cl><span class=mf>82.68</span>  <span class=mf>3.81</span>  <span class=mf>1.86</span>  <span class=mf>0.95</span>  <span class=mf>0.83</span>  <span class=mf>0.87</span>  <span class=mf>0.58</span>  <span class=mf>0.21</span>  <span class=mf>0.46</span>  <span class=mf>0.21</span>  <span class=mf>0.33</span>  <span class=mf>0.33</span>  <span class=mf>0.12</span> 
</span></span><span class=line><span class=cl>   <span class=mi>13</span>    <span class=mi>14</span>    <span class=mi>15</span>    <span class=mi>16</span>    <span class=mi>17</span>    <span class=mi>18</span>    <span class=mi>19</span>    <span class=mi>20</span>    <span class=mi>21</span>    <span class=mi>22</span>    <span class=mi>23</span>    <span class=mi>25</span>    <span class=mi>26</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.12</span>  <span class=mf>0.37</span>  <span class=mf>0.21</span>  <span class=mf>0.12</span>  <span class=mf>0.21</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.12</span>  <span class=mf>0.21</span>  <span class=mf>0.17</span>  <span class=mf>0.04</span>  <span class=mf>0.17</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>   <span class=mi>27</span>    <span class=mi>31</span>    <span class=mi>33</span>    <span class=mi>34</span>    <span class=mi>35</span>    <span class=mi>36</span>    <span class=mi>37</span>    <span class=mi>41</span>    <span class=mi>46</span>    <span class=mi>49</span>    <span class=mi>56</span>    <span class=mi>62</span>    <span class=mi>63</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span> 
</span></span><span class=line><span class=cl>   <span class=mi>65</span>    <span class=mi>71</span>    <span class=mi>72</span>    <span class=mi>73</span>    <span class=mi>85</span>    <span class=mi>91</span>    <span class=mi>94</span>    <span class=mi>95</span>    <span class=mi>97</span>    <span class=mi>98</span>   <span class=mi>100</span>   <span class=mi>102</span>   <span class=mi>103</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>107</span>   <span class=mi>109</span>   <span class=mi>114</span>   <span class=mi>117</span>   <span class=mi>119</span>   <span class=mi>124</span>   <span class=mi>125</span>   <span class=mi>126</span>   <span class=mi>132</span>   <span class=mi>136</span>   <span class=mi>138</span>   <span class=mi>140</span>   <span class=mi>143</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>146</span>   <span class=mi>147</span>   <span class=mi>148</span>   <span class=mi>152</span>   <span class=mi>153</span>   <span class=mi>158</span>   <span class=mi>160</span>   <span class=mi>161</span>   <span class=mi>162</span>   <span class=mi>163</span>   <span class=mi>164</span>   <span class=mi>165</span>   <span class=mi>166</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>167</span>   <span class=mi>168</span>   <span class=mi>172</span>   <span class=mi>173</span>   <span class=mi>175</span>   <span class=mi>177</span>   <span class=mi>178</span>   <span class=mi>179</span>   <span class=mi>183</span>   <span class=mi>184</span>   <span class=mi>185</span>   <span class=mi>186</span>   <span class=mi>187</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>188</span>   <span class=mi>189</span>   <span class=mi>190</span>   <span class=mi>196</span>   <span class=mi>199</span>   <span class=mi>201</span>   <span class=mi>203</span>   <span class=mi>204</span>   <span class=mi>206</span>   <span class=mi>209</span>   <span class=mi>211</span>   <span class=mi>215</span>   <span class=mi>217</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>218</span>   <span class=mi>223</span>   <span class=mi>224</span>   <span class=mi>231</span>   <span class=mi>238</span>   <span class=mi>242</span>   <span class=mi>243</span>   <span class=mi>246</span>   <span class=mi>260</span>   <span class=mi>261</span>   <span class=mi>262</span>   <span class=mi>263</span>   <span class=mi>264</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span> 
</span></span><span class=line><span class=cl>  <span class=mi>265</span>   <span class=mi>273</span>   <span class=mi>288</span>   <span class=mi>289</span>   <span class=mi>295</span>   <span class=mi>297</span>   <span class=mi>298</span>   <span class=mi>303</span>   <span class=mi>309</span>   <span class=mi>313</span>   <span class=mi>320</span>   <span class=mi>347</span>   <span class=mi>350</span> 
</span></span><span class=line><span class=cl> <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.08</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>  <span class=mf>0.04</span>
</span></span></code></pre></div><p>Thus, we observed <code>0ms</code> in the 92.69% cases, <code>1ms</code> in the 3.81% cases, <code>2ms</code> in 1.86% cases, and so on.
In this data set, both the median and the median absolute deviations are zero.
Here the observed data could be perfectly described using the
<a href=https://en.wikipedia.org/wiki/Discrete_Weibull_distribution>discrete Weibull distribution</a>.</p><p>If we try to compare samples from similar distributions using the gamma effect size,
we get a problem because of the zero denominator.</p><h3 id=qad-to-the-rescue>QAD to the rescue</h3><p>In the above scenario, it&rsquo;s meaningless to compare medians values.
We can have a situation of different distributions with equal median values (and zero median absolute deviations).
In such cases, it makes sense to compare higher quantiles instead of the median.
However, it doesn&rsquo;t solve the zero denominator problem.</p><p>The problem can be solved using the <a href=https://aakinshin.net/posts/qad/>Quantile Absolute Deviation(QAD)</a> around the given quantile:</p><p><span class="math display">\[\operatorname{QAD}_x(p, q) = C_n \cdot Q_q(|x_i - Q_p(x)|)
\]</span></p><p>It&rsquo;s easy to see that the <span class="math inline">\(\operatorname{MAD}\)</span> is just a special case of <span class="math inline">\(\operatorname{QAD}\)</span>:</p><p><span class="math display">\[\operatorname{MAD}_x = \operatorname{QAD}_x(0.5, 0.5).
\]</span></p><p>By analogy with <span class="math inline">\(\operatorname{MAD}\)</span>, we can define the <em>pooled quantile absolute deviation</em> <span class="math inline">\(\operatorname{PQAD}_{xy}\)</span>:</p><p><span class="math display">\[\operatorname{PQAD}_{xy}(p, q) = \sqrt{\frac{
(n_x - 1) \operatorname{QAD}^2_x(p, q) +
(n_y - 1) \operatorname{QAD}^2_y(p, q)}{n_x + n_y - 2}},
\]</span></p><p>When we estimate the gamma effect size of the <span class="math inline">\(p^\textrm{th}\)</span> quantile <span class="math inline">\(\gamma_p\)</span>,
it makes perfect sense to evaluate the quantile absolute deviation around the same quantile.
Although I don&rsquo;t have specific recommendations for the value of <span class="math inline">\(q\)</span>,
we can start with <span class="math inline">\(q=0.5\)</span> as a starting point and adjust it if necessary.</p><h3 id=conclusion>Conclusion</h3><p>We should always remember that real-life data contains tons of corner cases
that may become a problem if we want to analyze this data.
It&rsquo;s better to think about these corner cases in advance
and come up with proper solutions.
In this post, we patched the gamma effect size for distribution with zero median absolute deviation
using the <a href=https://aakinshin.net/posts/qad/>quantile absolute deviation</a>.
This trick allows comparing higher quantiles for such distributions.
A typical real-life example is the Weibull distribution.</p></div><br><br><div class="flex flex-wrap justify-center items-center">The source code of this post and all the relevant files are&nbsp;<a href=https://github.com/AndreyAkinshin/aakinshin.net/tree/master/content/en/posts/2021/06/zero-mad-gamma-es/index.md>available on GitHub</a>.</div><div class="flex flex-wrap justify-center items-center mb-5"><span>Share:</span><div class="text-4xl pl-3"><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fzero-mad-gamma-es%2f&title=Calculating%20gamma%20effect%20size%20for%20samples%20with%20zero%20median%20absolute%20deviation" target=_blank title="Share on Reddit"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#reddit"/></svg></a></div><div class="text-4xl pl-3"><a href="https://twitter.com/intent/tweet?text=Calculating%20gamma%20effect%20size%20for%20samples%20with%20zero%20median%20absolute%20deviation&url=https%3a%2f%2faakinshin.net%2fposts%2fzero-mad-gamma-es%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></div><div class="text-4xl pl-3"><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fzero-mad-gamma-es%2f" target=_blank title="Share on HackerNews"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#hacker-news"/></svg></a></div><div class="text-4xl pl-3"><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fzero-mad-gamma-es%2f&title=Calculating%20gamma%20effect%20size%20for%20samples%20with%20zero%20median%20absolute%20deviation" target=_blank title="Add to Pocket"><svg class="fai fai-link"><use xlink:href="/img/fa/all.svg#get-pocket"/></svg></a></div></div></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")})),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2023 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>