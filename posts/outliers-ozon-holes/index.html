<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.122.0"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Thoughts,Outliers"><title>Thoughts about outlier removal and ozone holes | Andrey Akinshin</title>
<meta name=description content="Imagine you work with some data and assume that the underlying distribution is approximately normal. In such cases, the data analysis typically involves non-robust statistics like the mean and the standard deviation. While these metrics are highly efficient..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link href=https://aakinshin.net/css/main.min.c056b741a0efe35319184ebf3e3a44fe6bf28153de5ee0750ebc95602b0b3ebc.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"></head><body><nav><div class="container flex flex-wrap items-center justify-between mx-auto max-w-6xl h-12 px-6"><div class="flex items-center justify-start justify-self-start"><div class="flex nav-item h-12 w-12 items-center justify-center"><a class=text-white href=https://aakinshin.net/><svg class="fai w-5 h-5 pr-0 mb-0.5"><use xlink:href="/img/fa/all.svg#house-chimney"/></svg></a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/posts/>Posts</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/research/>Research</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/library/>Library</a></div><div class="flex nav-item h-12 items-center"><a class=text-white href=https://aakinshin.net/about/>About</a></div></div><button id=theme-toggle type=button title="Alt+Click to match OS color theme" class="nav-item p-3 content-center justify-self-end"><svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></nav><div class="main container mx-auto max-w-6xl px-6"><div class=main-post><h1 class=blog-post-title id=post-title>Thoughts about outlier removal and ozone holes</h1><div class="flex flex-wrap justify-start items-center"><svg class="fai text-accent-l dark:text-front-d"><title>Date</title><use xlink:href="/img/fa/all.svg#calendar-days"/></svg>
<time datetime=2023-01-31>January 31, 2023</time><svg class="fai ml-3 text-accent-l dark:text-front-d"><title>Tags</title><use xlink:href="/img/fa/all.svg#tag"/></svg><div class="flex flex-wrap gap-y-1"><a class=label-link href=https://aakinshin.net/tags/mathematics/>Mathematics</a>
<a class=label-link href=https://aakinshin.net/tags/statistics/>Statistics</a>
<a class=label-link href=https://aakinshin.net/tags/thoughts/>Thoughts</a>
<a class=label-link href=https://aakinshin.net/tags/outliers/>Outliers</a></div></div><br><div class=main-content><p>Imagine you work with some data and assume that the underlying distribution is approximately normal.
In such cases, the data analysis typically involves non-robust statistics like the mean and the standard deviation.
While these metrics are highly efficient under normality, they make the analysis procedure fragile:
a single extreme value can corrupt all the results.
You may not expect any significant outliers, but you can never be 100% sure.
To avoid unexpected surprises and ensure the reliability of the results,
it may be tempting to automatically exclude all outliers from the collected samples.
While this approach is widely adopted, it conceals an essential part of the obtained data
and can lead to fallacious conclusions.</p><p>Let me recite a classic story about ozone holes,
which is typically used to illustrate the danger of blind outlier removal:</p><blockquote><p>The discovery of the ozone hole <strong>was announced in 1985</strong> by a British team working on the ground
with “conventional” instruments and examining its observations in detail.
Only later, after reexamining the data transmitted by the TOMS instrument on NASA’s Nimbus 7 satellite,
was it found that <strong>the hole had been forming for several years</strong>.
Why had nobody noticed it?
The reason was simple:
the systems processing the TOMS data, designed in accordance with predictions derived from models,
which in turn were established on the basis of what was thought to be “reasonable”,
<strong>had rejected the very (“excessively”) low values</strong> observed above the Antarctic during the Southern spring.
As far as the program was concerned, there must have been an operating defect in the instrument.</p><p>&mdash; R. Kandel, Our Changing Climate (1991)</p></blockquote><p>According to the cited fragment, the research team had enough data to detect the ozone holes,
but the software automatically discarded this information
because it recognized unusual values as outliers that should be removed.</p><p>However, there is another version of this story
that claims that there was no automatic outlier removal of the TOMS data.
According to the letter from Dr. Richard McPeters (Head of the Ozone Processing Team at NASA) to
Dr. Pukelsheim (<a href=#Pukelsheim1990>[Pukelsheim1990]</a>):</p><blockquote><p>This myth was the result of a statement made by one of my colleagues in reply
to a question during an interview on the science program NOVA in which he was asked
why NASA did not discover the ozone hole first.
He was not directly involved in ozone processing at that time and his answer was <em>not</em> correct.</p></blockquote><p>In this letter, Dr. Richard McPeters explains that NASA engineers were aware of the anomalous data
collected by NASA&rsquo;s Nimbus-7 satellite
(the software did not throw the outliers away, it reported them properly).
In order to investigate untypical values and verify their correctness,
they compared them with the data from the South Pole Dobson ground station.
Unfortunately, the Dobson values for the relevant period of time were &ldquo;erroneous and uncorrectable,&rdquo;
so it was impossible to verify if the satellite data were anomalous
due to an instrument error or due to an actual physical phenomenon.</p><p>A similar story can be found in <a href=#Bhartia2009>[Bhartia2009]</a>:</p><blockquote><p>Unfortunately, some in the scientific community have derived incorrect conclusions from this experience.
It has been widely but incorrectly reported that the TOMS team missed the discovery of the ozone hole since
&ldquo;they rejected the data and discovered it only after the publication of Farman et al. 1985 paper&rdquo;
(see Seinfeld & Pandis 1998, page 189, for a typical example).
In fact when the South Pole Dobson data from October 1984 became available to the TOMS team in late 1984,
well before the publication of Farman et al. paper,
there was no doubt on the validity of satellite total ozone retrievals.
(Ironically, October 1983 total ozone values initially reported by the S. Pole station showed normal ozone values
that were much larger than that being reported by TOMS.
These data were later withdrawn by the station.)
The correct conclusion that should be derived from this experience is that remote sensing techniques,
such as those used by nadir-viewing satellites,
depend critically on information generated by in-situ techniques because of their dependence on prior information.
When the retrievals are pushed beyond the limits set by prior information the data become suspect.
To report such data without proper validation is scientifically irresponsible.
The TOMS team followed the correct approach even though it caused several months delay in reporting the data
to the scientific community.</p></blockquote><p>While the original story is supposed to be a myth, there is a reason why it became so popular:
the automatic removal of outliers is regrettably widespread in data analysis.
This is understandable: it is much easier to discard inconvenient data rather than properly examine it.
However, such a shortcut can lead to unfortunate consequences and wrong conclusions.
A proper data analysis procedure should provide not only a clear definition of outliers but also explain their origin.</p><p>If outliers appear in the data, it is a good idea to investigate them manually rather than automatically remove them
so that the outliers do not interfere with non-robust analysis procedures.
Of course, it can be impractical to involve humans every time when we detect extreme values
(especially if we have to process a lot of data).
Once the source of outliers is determined,
we can try to automate the outlier examination process
by implementing logic that recognizes special types of outliers.
However, if we fail to match the obtained extreme values to one of the known patterns,
such a situation should be flagged for manual investigation.
Using such an approach, we can iteratively extend our knowledge base and
support handling different types of exceptional situations.
Remember that outliers are not inconvenient values;
they are an essential part of the data, which may provide valuable insights.</p><h3 id=acknowledgments>Acknowledgments</h3><p>The author thanks <a href=https://www.ilr.cornell.edu/people/paul-velleman>Paul Velleman</a> for valuable discussions.</p><h3 id=references>References</h3><ul><li><b id=Pukelsheim1990>[Pukelsheim1990]</b><br>Pukelsheim, Friedrich. &ldquo;Robustness of statistical gossip and the Antarctic ozone hole.&rdquo; (1990)<br><a href=https://www.math.uni-augsburg.de/htdocs/emeriti/pukelsheim/1990c.pdf>https://www.math.uni-augsburg.de/htdocs/emeriti/pukelsheim/1990c.pdf</a></li><li><b id=Bhartia2009>[Bhartia2009]</b><br>Bhartia, Pawan K. &ldquo;Role of satellite measurements in the discovery of stratospheric ozone depletion.&rdquo;
In Twenty Years of Ozone Decline: Proceedings of the Symposium for the 20th Anniversary of the Montreal Protocol,
pp. 183-189. Springer Netherlands (2009)<br>DOI: <a href=https://dx.doi.org/10.1007/978-90-481-2469-5_13>10.1007/978-90-481-2469-5_13</a></li></ul><h3 id=see-also>See also</h3><ul><li>Gavin Schmidt. &ldquo;What did NASA know? and when did they know it?&rdquo; (2017)<br><a href=https://www.realclimate.org/index.php/archives/2017/12/what-did-nasa-know-and-when-did-they-know-it/>https://www.realclimate.org/index.php/archives/2017/12/what-did-nasa-know-and-when-did-they-know-it/</a></li><li>Rob J Hyndman. &ldquo;Omitting outliers&rdquo; (2016)<br><a href=https://robjhyndman.com/hyndsight/omitting-outliers/>https://robjhyndman.com/hyndsight/omitting-outliers/</a></li><li>Farhana Ismail. &ldquo;Investigating outliers&rdquo; (2021)<br><a href=https://www.papergiant.net/news/investigating-outliers>https://www.papergiant.net/news/investigating-outliers</a></li></ul></div><br><br></div></div><script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");const imagesDark=document.querySelectorAll(".img-dark"),imagesLight=document.querySelectorAll(".img-light");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(themeToggleLightIcon.classList.remove("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")})):(themeToggleDarkIcon.classList.remove("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}));function toggleTheme(e){e?(document.documentElement.classList.add("dark"),themeToggleLightIcon.classList.remove("hidden"),themeToggleDarkIcon.classList.add("hidden"),imagesDark.forEach(e=>{e.classList.remove("hidden")}),imagesLight.forEach(e=>{e.classList.add("hidden")})):(document.documentElement.classList.remove("dark"),themeToggleDarkIcon.classList.remove("hidden"),themeToggleLightIcon.classList.add("hidden"),imagesLight.forEach(e=>{e.classList.remove("hidden")}),imagesDark.forEach(e=>{e.classList.add("hidden")}))}themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),imagesLight.forEach(e=>{e.classList.toggle("hidden")}),imagesDark.forEach(e=>{e.classList.toggle("hidden")}),event.altKey?(localStorage.removeItem("color-theme"),toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches)):localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(localStorage.getItem("color-theme")===null){const t=e.matches?"dark":"light";toggleTheme(t==="dark")}})</script><footer class="z-20 p-4 md:p-6 mt-3 w-full border-t border-gray-200 shadow flex items-center justify-center dark:border-gray-600 bg-white dark:bg-zinc-800"><span class="dark:text-gray-400 text-center">© 2013—2024 <span class=whitespace-nowrap>Andrey Akinshin</span></span><ul class="flex flex-wrap items-center px-4 mb-1"><li><a href=https://github.com/AndreyAkinshin><svg class="fai fai-link w-5 h-5"><title>GitHub</title><use xlink:href="/img/fa/all.svg#github"/></svg></a></li><li><a href=https://twitter.com/andrey_akinshin><svg class="fai fai-link w-5 h-5"><title>Twitter</title><use xlink:href="/img/fa/all.svg#twitter"/></svg></a></li><li><a href=https://aakinshin.net/posts/index.xml><svg class="fai fai-link w-5 h-5"><title>RSS</title><use xlink:href="/img/fa/all.svg#rss"/></svg></a></li></ul><div class=main-content><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></div></footer><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+=" has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></body></html>