<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics,Research,Research: Weighted quantile estimators"><title>Weighted quantile estimators for exponential smoothing and mixture distributions | Andrey Akinshin</title><meta name=description content="There are various ways to estimate quantiles of weighted samples. The proper choice of the most appropriate weighted quantile estimator depends not only on..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=https://aakinshin.net/sass/bootstrap-light.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=https://aakinshin.net/sass/bootstrap-dark.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.d7f6578e23ad3f0c33c589f9bcb34f995b45121f1f3ce888869c86b26826c845.js></script>
<script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.9e68d431432744c07a43381a8a833ffe0921cc0e006d84ad97f0b0d43c5cd82d.mjs></script>
<link href=https://aakinshin.net/css/fontawesome-all.min.178e95bba6ea2e9a90838cd646658f4bf6667a6ceaa057cb587bf7e6eb8412d3.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.60773ab7266ecc6e9625306f57c0a82a219b011dc3ea2d83763d1ecdf11c86d2.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.7e186db80d8c431d196b3e0718afb0636b82a269a8c92521c11a55267a24fc27.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"><script src=/js/jquery-3.3.1.slim.min.js></script></head><body class="d-flex flex-column min-vh-100"><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class=nav-item><a class=nav-link id=nav-link-posts href=https://aakinshin.net/posts/>Posts</a></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Weighted quantile estimators for exponential smoothing and mixture distributions</h1><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2022-09-20>September 20, 2022</time>
&nbsp;&nbsp;
<i class="fas fa-tag"></i>
&nbsp;
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a>
<a href=https://aakinshin.net/tags/research/ class="badge badge-info">Research</a>
<a href=https://aakinshin.net/tags/research-wqe/ class="badge badge-info">Research: Weighted quantile estimators</a></span><br><br><p>There are various ways to estimate quantiles of weighted samples.
The proper choice of the most appropriate weighted quantile estimator depends not only on the own estimator properties
but also on the goal.</p><p>Let us consider two problems:</p><ol><li><em>Estimating quantiles of a weighted mixture distribution.</em><br>In this problem, we have a weighted mixture distribution given by <span class="math inline">\(F = \sum_{i=1}^m w_i F_i\)</span>.
We collect samples <span class="math inline">\(\mathbf{x_1}, \mathbf{x_2}, \ldots, \mathbf{x_m}\)</span> from <span class="math inline">\(F_1, F_2, \ldots F_m\)</span>,
and want to estimate quantile function <span class="math inline">\(F^{-1}\)</span> of the mixture distribution based on the given samples.</li><li><em>Quantile exponential smoothing.</em><br>In this problem, we have a time series <span class="math inline">\(\mathbf{x} = \{ x_1, x_2, \ldots, x_n \}\)</span>.
We want to describe the distribution &ldquo;at the end&rdquo; of this time series.
The latest series element <span class="math inline">\(x_n\)</span> is the most &ldquo;actual&rdquo; one, but we cannot build a distribution based on a single element.
Therefore, we have to consider more elements at the end of <span class="math inline">\(\mathbf{x}\)</span>.
However, if we take too many elements, we may corrupt the estimations due to obsolete measurements.
To resolve this problem, we can assign weights to all elements according to the exponential law
and estimate weighted quantiles.</li></ol><p>In both problems, the usage of weighted quantile estimators looks like a reasonable solution.
However, in each problem, we have different expectations of the estimator behavior.
In this post, we provide an example that illustrates the difference in these expectations.</p><p>Let us consider the following distribution:</p><p><span class="math display">\[\newcommand{\eps}{\varepsilon}
F =
\eps F_{\delta_{-1000}} +
\frac{1-3\eps}{2} F_{\mathcal{U}(0,1)} +
\eps F_{\delta_{10}} +
\frac{1-3\eps}{2} F_{\mathcal{U}(99,100)} +
\eps F_{\delta_{1000}},
\]</span></p><p>where <span class="math inline">\(\delta_t\)</span> is the Dirac delta function (it has all its mass at <span class="math inline">\(t\)</span>),
<span class="math inline">\(\mathcal{U}(a, b)\)</span> is the continuous uniform distribution on <span class="math inline">\([a;b]\)</span>,
<span class="math inline">\(\eps\)</span> is a small constant.</p><p>When we consider the problem of obtaining the true quantile values of the mixture distribution <span class="math inline">\(F\)</span>,
we should expect <span class="math inline">\(F^{-1}(0) = -1000\)</span>, <span class="math inline">\(F^{-1}(0.5) = 10\)</span>, <span class="math inline">\(F^{-1}(1) = 1000\)</span>.</p><p>However, in the smoothing problem, we want to have a negligible impact of
<span class="math inline">\(F_{\delta_{-1000}}\)</span>, <span class="math inline">\(F_{\delta_{10}}\)</span>, <span class="math inline">\(F_{\delta_{1000}}\)</span> on the quantile estimations when <span class="math inline">\(\eps \to 0\)</span>.
More specifically, we expect <span class="math inline">\(F^{-1}(0) \approx 0\)</span>, <span class="math inline">\(F^{-1}(0.5) \approx 50\)</span>, <span class="math inline">\(F^{-1}(1) \approx 101\)</span>.</p><p>Thus, there is not a single weighted quantile estimator that fits all the problems.
In each case, we have to choose the proper estimator based on the estimator properties and the research goals.</p><br><br><div class=row><div class="justify-content-center share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fwqe-smoothing-mixture%2f&title=Weighted%20quantile%20estimators%20for%20exponential%20smoothing%20and%20mixture%20distributions" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Weighted%20quantile%20estimators%20for%20exponential%20smoothing%20and%20mixture%20distributions&url=https%3a%2f%2faakinshin.net%2fposts%2fwqe-smoothing-mixture%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x"></i></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fwqe-smoothing-mixture%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fwqe-smoothing-mixture%2f&title=Weighted%20quantile%20estimators%20for%20exponential%20smoothing%20and%20mixture%20distributions" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div></div></div><hr></div></div></main></div><footer class="blog-footer mt-auto"><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub></i></a>
<a href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter></i></a>
<a href=https://aakinshin.net/posts/index.xml><i class="fas fa-rss" title=RSS></i></a>
|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.c26550621ac13c2221d7f6f5e6fe862345d3919723c50d730893e3e4856ecf35.js></script>
<script src=/js/bootstrap.bundle.min.js></script>
<script src=/js/anchor.min.js></script>
<script src=https://aakinshin.net/js/custom.min.f6e5d13fe39f305056cc743ee4cb8d117c1aba26176e58c82c79a480d02fe4b7.js></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>