<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.103.0-DEV"><meta name=author content="Andrey Akinshin"><link href=/img/favicon.ico rel=icon type=image/x-icon><meta name=keywords content="Mathematics,Statistics"><title>Misleading kurtosis | Andrey Akinshin</title><meta name=description content="I already discussed misleadingness of such metrics like standard deviation and skewness. It&amp;rsquo;s time to discuss misleadingness of the measure of tailed..."><meta name=twitter:site content="@andrey_akinshin"><meta name=twitter:creator content="@andrey_akinshin"><link href=https://aakinshin.net/sass/bootstrap-light.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=https://aakinshin.net/sass/bootstrap-dark.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.d7f6578e23ad3f0c33c589f9bcb34f995b45121f1f3ce888869c86b26826c845.js></script>
<script type=module src=https://aakinshin.net/js/dark-mode-toggle.min.9e68d431432744c07a43381a8a833ffe0921cc0e006d84ad97f0b0d43c5cd82d.mjs></script>
<link href=https://aakinshin.net/css/fontawesome-all.min.178e95bba6ea2e9a90838cd646658f4bf6667a6ceaa057cb587bf7e6eb8412d3.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.60773ab7266ecc6e9625306f57c0a82a219b011dc3ea2d83763d1ecdf11c86d2.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.7e186db80d8c431d196b3e0718afb0636b82a269a8c92521c11a55267a24fc27.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/posts/index.xml title="RSS Feed"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVB6MXSX32"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZVB6MXSX32")</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-41419012-5"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-41419012-5")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(28700916,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/28700916 style=position:absolute;left:-9999px alt></div></noscript><script src=/js/jquery-3.3.1.slim.min.js></script></head><body class="d-flex flex-column min-vh-100"><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-sm navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Blog</a><ul class="dropdown-menu bg-primary"><li><a class=dropdown-item href=https://aakinshin.net/posts/>All Posts</a></li><li><a class=dropdown-item href=https://aakinshin.net/tags/statistics/>Posts about Statistics</a></li><li></li><a class=dropdown-item href=https://aakinshin.net/tags/>All Tags</a></li></ul></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/about/>About</a></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class="blog-post table-sm"><h1 class=blog-post-title id=post-title>Misleading kurtosis</h1><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2021-11-16>November 16, 2021</time>
&nbsp;&nbsp;
<i class="fas fa-tag"></i>
&nbsp;
<a href=https://aakinshin.net/tags/mathematics/ class="badge badge-info">Mathematics</a>
<a href=https://aakinshin.net/tags/statistics/ class="badge badge-info">Statistics</a></span><br><br><p>I already discussed misleadingness of such metrics like
<a href=https://aakinshin.net/posts/misleading-stddev/>standard deviation</a> and <a href=https://aakinshin.net/posts/misleading-skewness/>skewness</a>.
It&rsquo;s time to discuss misleadingness of the measure of tailedness: kurtosis
(which, sometimes, could be incorrectly interpreted as a measure of peakedness).
Typically, the concept of kurtosis is explained with the help of images like this:</p><div class=row><div class=mx-auto><a href=/posts/misleading-kurtosis/img/kurt_intro-light.png target=_blank class=imgldlink alt=kurt_intro><picture><source theme=dark srcset=/posts/misleading-kurtosis/img/kurt_intro-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/misleading-kurtosis/img/kurt_intro-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/misleading-kurtosis/img/kurt_intro-light.png></picture></a></div></div><br><p>Unfortunately, the raw kurtosis value may provide wrong insights about distribution properties.
In this post, we briefly discuss the sources of its misleadingness:</p><ul><li>There are multiple definitions of kurtosis.
The most significant confusion arises between &ldquo;kurtosis&rdquo; and &ldquo;excess kurtosis,&rdquo;
but there are other definitions of this measure.</li><li>Kurtosis may work fine for unimodal distributions, but it performs not so clear for multimodal distributions.</li><li>The classic definition of kurtosis is not robust: it could be easily spoiled by extreme outliers.</li></ul><h3 id=multiple-definitions>Multiple Definitions</h3><p>The classic kurtosis <em>of a distribution</em> <span class="math inline">\(X\)</span> is typically defined as the fourth standardized moment:</p><p><span class="math display">\[\operatorname{Kurt}(X) = \operatorname{E} \Bigg( \bigg( \frac{X - \mu}{\sigma} \bigg)^4 \Bigg).
\]</span></p><p>For the standard normal distribution, <span class="math inline">\(\operatorname{Kurt}(\mathcal{N}(0, 1)) = 3\)</span>.
This &ldquo;default&rdquo; value is not convenient.
Thus, many people use so-called &ldquo;excess kurtosis&rdquo; instead of the original one:</p><p><span class="math display">\[\operatorname{Kurt}'(X) = \operatorname{Kurt}(X) - 3.
\]</span></p><p>For the standard normal distribution, <span class="math inline">\(\operatorname{Kurt}'(\mathcal{N}(0, 1)) = 0\)</span>,
which makes it a more handy way to work with the metric.
Unfortunately, people often omit the &ldquo;excess&rdquo; word and refer <span class="math inline">\(\operatorname{Kurt}\)</span> as just &ldquo;kurtosis.&rdquo;
It could be a major source of confusion and misunderstanding.</p><p>While these definitions are straightforward for a distribution,
there are multiple ways to estimate kurtosis based on the given sample.
Following notation from <a href=#Joanes1998>[Joanes1998]</a>
(that we used in the <a href=https://aakinshin.net/posts/misleading-skewness/>post about skewness</a>),
we could consider three different ways to estimate the excess kurtosis:</p><p><span class="math display">\[g_2 =
\frac{m_4}{m_2^2} - 3 =
\frac{\frac{1}{n} \sum(x_i - \overline{x})^4}{\Big( \frac{1}{n} \sum(x_i - \overline{x})^2 \Big)^2} - 3,
\]</span></p><p><span class="math display">\[G_2 = \frac{((n+1) g_2 + 6) \cdot (n-1)}{(n-2)(n-3)},
\]</span></p><p><span class="math display">\[b_2 = m_4 / s^4 - 3 = (g_2 + 3) (1 - 1/n)^2 - 3.
\]</span></p><p>Alongside the classic definitions, there are alternative robust measures of kurtosis
(see <a href=#Kim2004>[Kim2004]</a> and <a href=#Bastianin2020>[Bastianin2020]</a> for details).</p><p>Here is a definition of kurtosis by Moors (see <a href=#Moors1988>[Moors1988]</a>):</p><p><span class="math display">\[\operatorname{Kurt}'_\textrm{Moors} =
\frac{(Q_{0.875}-Q_{0.625})+(Q_{0.375}-Q_{0.125})}{Q_{0.75}-Q_{0.25}} - 1.233.
\]</span></p><p>Here is a definition of kurtosis by Hogg (see <a href=#Hogg1972>[Hogg1972]</a>):</p><p><span class="math display">\[\operatorname{Kurt}'_\textrm{Hogg} =
\frac{U_{0.05}-L_{0.05}}{U_{0.5}-L_{0.5}} - 2.585,
\]</span></p><p>where <span class="math inline">\(L_\alpha\)</span> and <span class="math inline">\(U_\alpha\)</span> are averages of lower and upper quantiles:
<span class="math inline">\(L_\alpha = \frac{1}{\alpha} \int_0^\alpha Q(u)du\)</span>,
<span class="math inline">\(U_\alpha = \frac{1}{\alpha} \int_{1-\alpha}^1 Q(u)du\)</span>.</p><p>Here is a definition of kurtosis by Crow and Siddiqui (see <a href=#Crow1967>[Crow1967]</a>):</p><p><span class="math display">\[\operatorname{Kurt}'_\textrm{CrowSiddiqui} =
\frac{Q_{0.975}+Q_{0.025}}{Q_{0.75}-Q_{0.25}} - 2.906.
\]</span></p><h3 id=multimodality>Multimodality</h3><p>Kurtosis is often incorrectly interpreted as a measure of peakedness which makes sense only for unimodal distributions.
In fact, kurtosis is a measure of tailedness: it describes the extremity of outliers.
However, in real life, people tend to interpret kurtosis
by matching it to one of the &ldquo;standard&rdquo; PDF images for similar kurtosis values.
In this case, such a value could be quite misleading.</p><div class=row><div class=mx-auto><a href=/posts/misleading-kurtosis/img/multimodal-light.png target=_blank class=imgldlink alt=multimodal><picture><source theme=dark srcset=/posts/misleading-kurtosis/img/multimodal-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/misleading-kurtosis/img/multimodal-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/misleading-kurtosis/img/multimodal-light.png></picture></a></div></div><br><h3 id=non-robustness>Non-robustness</h3><p>If we use the classic non-robust kurtosis definition, a single outlier could completely spoil our results.
Letâ€™s illustrate the problem with an example.
Imagine we build a sample with 10000 elements randomly taken from the standard normal distribution <span class="math inline">\(\mathcal{N}(0, 1)\)</span>:</p><div class=row><div class=mx-auto><a href=/posts/misleading-kurtosis/img/normal-light.png target=_blank class=imgldlink alt=normal><picture><source theme=dark srcset=/posts/misleading-kurtosis/img/normal-dark.png media="(prefers-color-scheme: dark)"><source theme=light srcset=/posts/misleading-kurtosis/img/normal-light.png media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><img class="mx-auto d-block img-fluid" width=800 src=/posts/misleading-kurtosis/img/normal-light.png></picture></a></div></div><br><p>I have generated such a sample and evaluated its excess kurtosis.
The excess kurtosis estimation was <code>-0.01050842</code> (which is expected for <span class="math inline">\(\mathcal{N}(0, 1)\)</span>).
Next, I have added an outlier <code>-1000</code>.
The &ldquo;new&rdquo; excess kurtosis value was <code>9794.628</code>!
Thus, a single extreme outlier
could easily corrupt kurtosis estimation of a sample with thousands of &ldquo;well-formed&rdquo; elements.</p><p>However, if we recall that kurtosis is actually a measure of tailedness,
such a change could be expected.
Unfortunately, non-robustness leads to irreproducibility: we can&rsquo;t rely on the kurtosis value from a single sample.</p><p>Here is a short R snippet that reproduces this experiment:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>library</span><span class=p>(</span><span class=n>e1071</span><span class=p>)</span> <span class=c1># kurtosis from e1071 uses Joanes-Gill Type 3 approach (b2) by default</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>set.seed</span><span class=p>(</span><span class=m>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>kurtosis</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>[1]</span> <span class=m>-0.01050842</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>kurtosis</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=m>-1000</span><span class=p>,</span> <span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>[1]</span> <span class=m>9794.628</span>
</span></span></code></pre></div><h3 id=conclusion>Conclusion</h3><p>In this post, we briefly covered some sources of kurtosis misleadingness.
It&rsquo;s too easy to get invalid insights about a distribution based on a standalone kurtosis value.
If you still want to work with kurtosis, make sure that:</p><ul><li>You are sure that the underlying distribution is unimodal.</li><li>You clearly understand the target kurtosis definition.</li><li>If samples contain extreme outliers (e.g., the distribution is heavy-tailed),
a non-robust kurtosis may be corrupted.</li></ul><h3 id=references>References</h3><ul><li><b id=Joanes1998>[Joanes1998]</b><br>Joanes, Derrick N., and Christine A. Gill.
&ldquo;Comparing measures of sample skewness and kurtosis.&rdquo;
Journal of the Royal Statistical Society: Series D (The Statistician) 47, no. 1 (1998): 183-189.<br><a href=https://doi.org/10.1111%2F1467-9884.00122>https://doi.org/10.1111%2F1467-9884.00122</a></li><li><b id=Bastianin2020>[Bastianin2020]</b><br>Bastianin, Andrea.
&ldquo;Robust measures of skewness and kurtosis for macroeconomic and financial time series.&rdquo;
Applied Economics 52, no. 7 (2020): 637-670.<br><a href=https://doi.org/10.1080/00036846.2019.1640862>https://doi.org/10.1080/00036846.2019.1640862</a></li><li><b id=Kim2004>[Kim2004]</b><br>Kim, Tae-Hwan, and Halbert White.
&ldquo;On more robust estimation of skewness and kurtosis.&rdquo;
Finance Research Letters 1, no. 1 (2004): 56-73.<br><a href=https://doi.org/10.1016/S1544-6123(03)00003-5>https://doi.org/10.1016/S1544-6123(03)00003-5</a></li><li><b id=Moors1988>[Moors1988]</b><br>Moors, J. J. A.
&ldquo;A quantile alternative for kurtosis.&rdquo;
Journal of the Royal Statistical Society: Series D (The Statistician) 37, no. 1 (1988): 25-32.<br><a href=https://doi.org/10.2307/2348376>https://doi.org/10.2307/2348376</a></li><li><b id=Hogg1972>[Hogg1972]</b><br>Hogg, Robert V.
&ldquo;More light on the kurtosis and related statistics.&rdquo;
Journal of the American Statistical Association 67, no. 338 (1972): 422-424.<br><a href=https://doi.org/10.2307/2284397>https://doi.org/10.2307/2284397</a></li><li><b id=Crow1967>[Crow1967]</b><br>Crow, Edwin L., and M. M. Siddiqui.
&ldquo;Robust estimation of location.&rdquo;
Journal of the American Statistical Association 62, no. 318 (1967): 353-389.</li></ul><br><br><div class=row><div class="justify-content-center share-block"><div class=share-title>Share:</div><div class=share-button><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-kurtosis%2f&title=Misleading%20kurtosis" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=share-button><a href="https://twitter.com/intent/tweet?text=Misleading%20kurtosis&url=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-kurtosis%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x"></i></a></div><div class=share-button><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-kurtosis%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=share-button><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fposts%2fmisleading-kurtosis%2f&title=Misleading%20kurtosis" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div></div></div><hr></div></div></main></div><footer class="blog-footer mt-auto"><div class=container><p>&copy; 2013&mdash;2022 Andrey Akinshin
|
<a href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub></i></a>
<a href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter></i></a>
<a href=https://aakinshin.net/posts/index.xml><i class="fas fa-rss" title=RSS></i></a>
|
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.c26550621ac13c2221d7f6f5e6fe862345d3919723c50d730893e3e4856ecf35.js></script>
<script src=/js/bootstrap.bundle.min.js></script>
<script src=/js/anchor.min.js></script>
<script src=https://aakinshin.net/js/custom.min.f6e5d13fe39f305056cc743ee4cb8d117c1aba26176e58c82c79a480d02fe4b7.js></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>