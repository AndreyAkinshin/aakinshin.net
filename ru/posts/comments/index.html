<!doctype html><html lang=ru class=h-100><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.74.3"><meta name=author content="Андрей Акиньшин"><link href=/img/favicon.ico rel=icon type=image/x-icon><title>Комментировать или не комментировать? | Андрей Акиньшин</title><link href=/css/lumen-bootstrap.min.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/slate-bootstrap.min.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><link href=/css/syntax-light.css theme=light rel=stylesheet type=text/css media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link href=/css/syntax-dark.css theme=dark rel=stylesheet type=text/css media="(prefers-color-scheme: dark)"><script src=https://aakinshin.net/js/theme-before.min.26d61b7027fe55e642f0001cef94cb75b567d721086492aab6b4e32d9ee7811d.js></script><script type=module src=https://googlechromelabs.github.io/dark-mode-toggle/src/dark-mode-toggle.mjs></script><link href=https://aakinshin.net/css/fontawesome-all.min.e78467baec0179d7ccd2ef995e0c94f25b4a63a3191a93c3547e22bdf590ef5d.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/about.min.2a76db7cc14055b3bafacc363f453917ab54a818a7db2a0a9b2409c0f6bf07c5.css rel=stylesheet type=text/css media=all><link href=https://aakinshin.net/css/blog.min.a9ad336a30411929ac042537ef03ddbe3b2b28af5aa50655711f870419408467.css rel=stylesheet type=text/css media=all><link rel=alternate type=application/rss+xml href=https://aakinshin.net/ru/posts/index.xml title="RSS Feed"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-XXXXX-Y','auto');ga('send','pageview');</script><script type=text/javascript>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");ym(28700916,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src=https://mc.yandex.ru/watch/28700916 style=position:absolute;left:-9999px alt></div></noscript><script src=/js/jquery-3.3.1.slim.min.js></script></head><body><div class=bg-primary><div class="container bg-primary"><nav class="navbar navbar-expand-lg navbar-dark bg-primary"><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/ru/><i class="fas fa-home" title=Home style=color:#fff></i></a></li><li class=nav-item><a class=nav-link id=nav-link-blog href=https://aakinshin.net/ru/posts/>Посты</a></li><li class=nav-item><a class=nav-link id=nav-link-about href=https://aakinshin.net/ru/about/>Об авторе</a></li><li class=nav-item><a class=nav-link id=nav-link-about href>Pro .NET Benchmarking</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" data-toggle=dropdown href=# role=button aria-haspopup=true aria-expanded=false>RU</a><div class=dropdown-menu><a class=dropdown-item href=https://aakinshin.net/posts/comments/>EN</a></div></li><li class=nav-item></li><dark-mode-toggle permanent=true></dark-mode-toggle></li></ul><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://github.com/AndreyAkinshin><i class="fab fa-github" title=GitHub style=color:#fff></i></a></li><li class=nav-item><a class=nav-link href=https://twitter.com/andrey_akinshin><i class="fab fa-twitter" title=Twitter style=color:#fff></i></a></li><li class=nav-item><a class=nav-link href=https://aakinshin.net/ru/posts/index.xml><i class="fas fa-rss" title=RSS style=color:#fff></i></a></li></ul></nav></div></div><div class=container><main id=main><div class=blog-main><div class=blog-post><h2 class=blog-post-title id=post-title>Комментировать или не комментировать?</h2><span class=blog-post-meta><div class=faicon><i class="far fa-calendar-alt"></i></div><time datetime=2013-08-28>28 августа 2013</time>
&nbsp;&nbsp;<div class=faicon><i class="fas fa-tag"></i></div><a href=https://aakinshin.net/tags/perfectcode class="badge badge-info">PerfectCode</a></span><br><br><p><em>По-настоящему хороший комментарий — тот, без которого вам удалось обойтись. © Дядюшка Боб</em></p><p class=center><img src=/img/posts/dev/refactoring/front.png height=250px></p><p>В последнее время меня стали очень утомлять оживлённые дебаты о том, нужно ли комментировать код. Как правило, по одну сторону баррикад — самоуверенные джуниоры, имеющие непререкаемую позицию вида <em>«А как же его не комментировать, ведь без комментариев непонятно будет!»</em>. По другую — умудрённые опытом сеньоры. Они понимают, что если возможно обойтись без комментариев, то <em>«Лучше бы, чёрт возьми, так и сделать!»</em>. Наверное, у многих жажда комментировать идёт со студенческой скамьи, когда товарищи преподаватели заставляли комментировать каждую строчку,
<em>«чтобы студент лучше разобрался»</em>. В реальном проекте не должно быть кучи комментариев, которые только и делают, что засоряют код. Впрочем, я не агитирую вообще не писать комментарии, но если вам удалось написать такой код, который не требует пояснений, то расценивайте это как свою маленькую победу. Сразу хотелось бы сослаться на несколько очень умных книжек, на основе которых формировалась моя позиция. Я люблю и уважаю авторов этих работ, полностью разделяя их мнение.</p><ul><li><a href=http://www.ozon.ru/context/detail/id/5508646/>С. Макконнелл, «Совершенный код. Мастер-класс»</a></li><li><a href=http://www.ozon.ru/context/detail/id/20216991/>Р. Мартин, «Чистый код. Создание, анализ и рефакторинг»</a></li><li><a href=http://www.ozon.ru/context/detail/id/8466390/>Д. Босуэлл, Т. Фаучер, «Читаемый код, или Программирование как искусство»</a></li></ul><p>Итак, что же меня так раздражает в комментариях? Приведу несколько основных тезисов:</p><ul><li>Комментарии захламляют непосредственный код, ухудшают его читаемость</li><li>Комментарии требуют время на написание и поддержку</li><li>Комментарии лгут (начинаем от криво написанных, заканчиваем устаревшими)</li></ul><p>В принципе, я согласен с тем, что в некоторых случаях комментарии всё-таки нужны. Но ваш код будет тем прекраснее, чем будет меньше таких случаев. Кроме того, написание хорошего комментария — это тоже искусство. Увы, им обладают не так много программистов, большинство пишут комментарии абы как. Польза от этого зачастую сомнительная. А чем тратить время и силы на написание хорошего грамотного комментария, не лучше ли потратиться на переписывание кода, чтобы он больше не требовал комментария?</p><p>Давайте обсудим некоторые типичные сценарии, в которых можно сказать что-нибудь определённое про надобность комментария. Примеры кода я привожу на C#, но для данной темы это не принципиально.</p><h2 id=когда-без-комментариев-можно-обойтись>Когда без комментариев можно обойтись</h2><h3 id=комментарии-которые-повторяют-код>Комментарии, которые повторяют код</h3><p>Давайте взглянем на код:</p><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=c1>// Этот метод отвечает за подсчёт суммы элементов массива
</span><span class=c1></span><span class=k>public</span> <span class=kt>int</span> <span class=n>CalcSumOfElement</span><span class=p>(</span><span class=kt>int</span><span class=p>[]</span> <span class=n>elements</span><span class=p>)</span> <span class=c1>// Метод принимает на вход массив элементов
</span><span class=c1></span><span class=p>{</span>
  <span class=kt>int</span> <span class=n>result</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=c1>// Заводим специальную переменную под результат
</span><span class=c1></span>  <span class=kt>int</span> <span class=n>n</span> <span class=p>=</span> <span class=n>elements</span><span class=p>.</span><span class=n>Length</span><span class=p>;</span> <span class=c1>// Узнаём длину массива, т.е. количество элементов
</span><span class=c1></span>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=p>++)</span> <span class=c1>// Запускаем цикл по всем элементам
</span><span class=c1></span>    <span class=n>result</span> <span class=p>+=</span> <span class=n>elements</span><span class=p>[</span><span class=n>i</span><span class=p>];</span> <span class=c1>// Прибавляем к результату очередной элемент
</span><span class=c1></span>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span> <span class=c1>// Возвращаем результат
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>Этот пример, конечно, искусственный, но, увы, я не утрирую. Я действительно не раз встречал подобный код. В данном примере комментарии не несут нам ничего нового — абсолютно всё и так понятно из кода. Но при этом прочитать этот код без захламляющего комментирования намного проще. Я уж не говорю про развитие кода: поддерживать такой уровень комментирования очень утомительно. Скорее всего при усложнении функционала половина кода останется вообще без комментариев, а другая — с кривыми устаревшими комментариями.</p><h3 id=комментарии-которые-поясняют-синтаксис>Комментарии, которые поясняют синтаксис</h3><p>Ну, а вот такой пример:</p><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=k>public</span> <span class=k>class</span> <span class=nc>Item</span>
<span class=p>{</span>
  <span class=k>private</span> <span class=kt>int</span> <span class=k>value</span><span class=p>;</span> <span class=c1>// Это приватное поле, извне оно не доступно
</span><span class=c1></span>
  <span class=c1>// Это конструктор
</span><span class=c1></span>  <span class=k>public</span> <span class=n>Item</span><span class=p>(</span><span class=kt>int</span> <span class=n>twoValue</span><span class=p>)</span>
  <span class=p>{</span>
    <span class=k>value</span> <span class=p>=</span> <span class=n>twoValue</span> <span class=p>&gt;&gt;</span> <span class=m>1</span><span class=p>;</span> <span class=c1>// Два знака больше означают побитовый сдвиг вправо
</span><span class=c1></span>    <span class=c1>// таким образом мы делим число на два
</span><span class=c1></span>  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>Если это лабораторная работа первокурсника, то всё нормально. А вот если это продакшн код, и ваши программисты нуждаются в таких комментариях, то у меня для вас плохие новости. Наверное, эта статья не для вас.</p><h3 id=комментарии-которые-поясняют-стандартные-классы>Комментарии, которые поясняют стандартные классы</h3><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=n>HashSet</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=k>set</span><span class=p>;</span> <span class=c1>// Это структура данных, которая называется Хеш-Сет
</span><span class=c1>// Она представляет собой множество элементов
</span><span class=c1>// Мы очень быстро можем узнать, есть ли элемент в этом множестве или нет
</span><span class=c1>// Подробнее про хеш-таблицы можно почитать в википедии: http://ru.wikipedia.org/wiki/%D0%A5%D0%B5%D1%88-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0
</span></code></pre></div><p>Если программист действительно не знает назначение какого-то стандартного класса или метода, то он всегда может погуглить / почитать документацию / спросить у товарища. А большинство нормальных программистов скорее всего и так всё знает. Поэтому польза таких комментариев ну очень сомнительна.</p><h3 id=комментарии-которые-компенсируют-плохие-наименования>Комментарии, которые компенсируют плохие наименования</h3><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=c1>// Устанавливаем соединение с сервером
</span><span class=c1>// public void DoIt()
</span></code></pre></div><p>Я согласен, что далеко не всегда удаётся придумать хорошее название для класса/метода/свойства/переменной. А если проект сдавать вчера, то времени на придумывание красивого названия просто нет. А давайте возьмём какое-нибудь произвольное название, а в комментарии объясним то, что происходит. Это же намного проще и быстрее! Или же всё-таки вы найдёте минутку-другую на придумывание понятного названия?</p><h3 id=комментарии-которые-объясняют-абзац>Комментарии, которые объясняют абзац</h3><p>Часто приходится слышать подобные заявления: <em>«Не, ну этот метод занимает 300 строк, он очень много всего делает. Без комментариев в нём не разобраться. Сейчас я напишу перед каждыми 10-строчками о том, что в них делается»</em>. Если действительно дела обстоят так, то, возможно, что-то вы делаете не так. Возможно, стоит разбить большой 300-строчный метод на несколько маленьких методов. И каждому маленькому методу дать понятное название — тогда и комментарии будут не нужны.</p><h3 id=комментарии-которые-поясняют-константы>Комментарии, которые поясняют константы</h3><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=k>public</span> <span class=kt>int</span> <span class=n>GetSeconds</span><span class=p>(</span><span class=kt>int</span> <span class=n>hours</span><span class=p>)</span>
<span class=p>{</span>
  <span class=k>return</span> <span class=n>hours</span> <span class=p>*</span> <span class=m>3600</span><span class=p>;</span> <span class=c1>// 3600 - это количество секунд, образующих час
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>Ну, в таком варианте, наличие комментария — это более адекватный вариант, чем просто магическое число, которое закралось в код и непонятно что обозначает. Но ещё лучше бы было сделать именованную константу, из названия которой всё было бы понятно. Например, так:</p><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=k>private</span> <span class=k>const</span> <span class=kt>int</span> <span class=n>SecondsInHour</span> <span class=p>=</span> <span class=m>3600</span><span class=p>;</span>
<span class=k>public</span> <span class=kt>int</span> <span class=n>GetSeconds</span><span class=p>(</span><span class=kt>int</span> <span class=n>hours</span><span class=p>)</span>
<span class=p>{</span>
  <span class=k>return</span> <span class=n>hours</span> <span class=p>*</span> <span class=n>SecondsInHour</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><h3 id=комментарии-которые-не-относятся-к-программированию>Комментарии, которые не относятся к программированию</h3><p>Мне очень нравится байка из «Совершенного кода» про то, как один программист всю ночь пытался расшифровать вот такой комментарий.</p><div class=highlight><pre class=chroma><code class=language-asm data-lang=asm><span class=nf>MOV</span> <span class=no>AX</span><span class=p>,</span> <span class=mi>723</span><span class=no>h</span> <span class=c>; R. I. P. L. V. В. 
</span></code></pre></div><p>А несколько месяцев спустя он встретился с автором этого кода и узнал, что комментарий расшифровывается следующим образом: «Rest in peace, Ludwig van Beethoven», т.к. 723 — это шестнадцатеричное представление года смерти Бетховена.</p><p>Увы, некоторые программисты считают программный код своеобразным форумом, в котором можно общаться. Некоторые пытаются проявить своё остроумие (чуть ли не анекдоты рассказывают), другие пытаются нам что-то рассказать о себе (типа <em>«Сейчас уже три часа ночи, но я всё равно пишу этот класс, ведь я так люблю программировать»</em>). Не нужно так делать, для общения есть сотни других способов. Если комментарий вставлен в код, то он должен нести в себе что-то полезное для проекта.</p><h3 id=комментарии-которые-содержат-мысли>Комментарии, которые содержат мысли</h3><p>Бывает, что в комментарии содержатся очень умные мысли, от которых много проку. Но в большинстве случаев это совсем не так.</p><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=k>public</span> <span class=k>void</span> <span class=n>Main</span><span class=p>()</span>
<span class=p>{</span>
  <span class=c1>// Ну, это очень полезный метод.
</span><span class=c1></span>  <span class=c1>// Он выполняет основную логику этого класса.
</span><span class=c1></span>  <span class=c1>// Сначала я хотел назвать его Run.
</span><span class=c1></span>  <span class=c1>// Но потом подумал, Run переводится «бежать».
</span><span class=c1></span>  <span class=c1>// А этот метод никуда не бежит, он очень медленный.
</span><span class=c1></span>  <span class=c1>// Я думал об этом, пока мыл посуду.
</span><span class=c1></span>  <span class=c1>// И когда я её домыл, я вернулся к компьютеру и переименовал метод в Main.
</span><span class=c1></span>  <span class=c1>// Ведь это главный метод данного класса, пусть он называется Main.
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><h3 id=комментарии-которые-содержат-примеры-использования>Комментарии, которые содержат примеры использования</h3><p>Иногда автор метода не уверен, что все правильно поймут, как пользоваться его методом. И тогда он приводит примеры использования, которые как бы говорят, что вернёт метод на определённых входных данных.</p><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=c1>// Sum(1, 2) == 3
</span><span class=c1>// Sum(2, 1) == 3
</span><span class=c1>// Sum(2, 2) == 4
</span><span class=c1></span><span class=k>public</span> <span class=kt>int</span> <span class=n>Sum</span><span class=p>(</span><span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>b</span><span class=p>)</span>
</code></pre></div><p>А я так считаю — для каждой задачи должен быть свой инструмент. Для этой задачи люди давно придумали удобный инструмент, он называется Unit-тесты. Очень толковая штука. Нужны ли на самом деле Unit-тесты или нет — также дискуссионная тема. Но если в проекте всё-таки возникла потребность описать для метода примеры возвращаемых результатов, то почему бы просто не сделать соответствующий Unit-тест?</p><h3 id=комментарии-которые-содержат-историю-написания>Комментарии, которые содержат историю написания</h3><p>К счастью, давненько я подобного не видел, но иногда доводится встречать комментарии вида:</p><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=c1>// 11.06.13: Исправил багу в методе. Раньше он работал так-то так-то, а теперь работает иначе. // 12.06.13: Ой, та бага — была не бага. Вернул всё обратно.
</span></code></pre></div><p>Повторю ещё раз свою мысль: для каждой задачи — свой инструмент. Системы контроля версий прекрасно умеют хранить историю изменений. Не нужно нагружать исходники никому не нужной историей того, как вы что писали. Если кого-то будет это интересовать, то он всегда может посмотреть в репозитории.</p><h3 id=комментарии-которые-содержат-код>Комментарии, которые содержат код</h3><p>Эти комментарии меня особенно печалят. Читаешь, скажем, код какого-нибудь хорошего класса. И тут:</p><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=c1>// int number = GetNumber()
</span><span class=c1>// int number = 4;
</span><span class=c1>// int number = 5;
</span><span class=c1></span><span class=kt>int</span> <span class=n>number</span> <span class=p>=</span> <span class=m>4</span><span class=p>;</span>
<span class=c1>// double number = 4.5;
</span><span class=c1>// decimal number = 4.5;
</span><span class=c1>// string number = &#34;Это число&#34;;
</span></code></pre></div><p>Вот что этим хотел сказать автор? Некоторые авторы хотят этим сказать: я провожу эксперименты по изменению кода, но при этом не хочу терять старые версии этих строчек, вдруг к ним придётся вернуться. Этот тезис возвращает нас к мысли про репозиторий, который умеет хранить все промежуточные версии вашей писанины — никуда они не пропадут. Пожалейте других разработчиков, которые будут читать ваш код. А хуже всего, что этот код в проекте теперь надолго. Автор после кучки экспериментов забывает удалить плохие версии, а его коллеги опасаются бездумно удалять то, назначение чего непонятно: <em>«я вот сейчас всё удалю, а потом окажется, что оно было ну очень нужно, тут был великий замысел, а я всё испортил».</em></p><h3 id=комментарии-которые-непонятны>Комментарии, которые непонятны</h3><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=kt>bool</span> <span class=n>flagA</span> <span class=p>=</span> <span class=k>true</span><span class=p>;</span>
<span class=kt>bool</span> <span class=n>flagB</span> <span class=p>=</span> <span class=k>false</span><span class=p>;</span>
<span class=kt>bool</span> <span class=n>flagC</span> <span class=p>=</span> <span class=k>true</span><span class=p>;</span>
<span class=k>if</span> <span class=p>(</span><span class=n>Condition</span><span class=p>(</span><span class=n>flagA</span><span class=p>,</span> <span class=n>flagB</span><span class=p>,</span> <span class=n>flagC</span><span class=p>))</span>
  <span class=n>Foo</span><span class=p>();</span>
<span class=c1>// else флаг равен true, выключение сервера
</span></code></pre></div><p>В подобных случаях никогда нельзя догадаться, что хотел сказать автор. Какой флаг равен true? Он всегда равен true в else-ветке или тут нужно дописать код, в котором нужно присвоить флагу значение true. А что за сервер, почему он выключается? Он выключится сам или нам нужно самим его выключить?</p><p>От подобных комментариев вреда больше, чем пользы. Сведений он в себе по факту не несёт, а вместо этого только смущает читателя. Не смущайте читателя вашего кода! Или не пишите ничего вовсе, или потратьте время на написание доходчивого сообщения, которое всем будет понятно.</p><h3 id=комментарии-которые-содержат-ну-очень-много-текста>Комментарии, которые содержат ну очень много текста</h3><p>Некоторые комментаторы очень боятся быть непонятыми. Ну, или написать слишком мало. Поэтому комментарий к методу из трёх строчек может занимать несколько экранов. В этом обширном сочинении вы узнаете об используемых алгоритмах, их временной сложности, почитаете псевдокод метода, блок-схему в ASCII-графике, обоснование именования переменных, соображения общего характера. Причём всё будет расписано настолько подробно, чтобы даже первоклассник понял.</p><p>Это плохой подход, он заставляет тратить читателя очень много времени на изучение вашего сочинения. Если вы уж решили писать комментарий, то вам следует озаботиться его лаконичностью (разумеется, не в ущерб понятности или информативности).</p><h3 id=комментарии-которые-врут>Комментарии, которые врут</h3><div class=highlight><pre class=chroma><code class=language-cs data-lang=cs><span class=c1>// Произведение двух чисел
</span><span class=c1></span><span class=k>public</span> <span class=kt>int</span> <span class=n>Sum</span><span class=p>(</span><span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>b</span><span class=p>)</span>
</code></pre></div><p>Вы опять смущаете вашего читателя. Что тут происходит? Возможно, метод когда-то считал произведение, а потом его переделали в сумму, комментарий стал устаревшим. А может, наоборот: комментарий обновили, а про название метода забыли. А может, метод с самого начала считал сумму, а программист ошибся при комментировании. Но как бы то ни было, если метод на самом деле очень сложный, придётся потратить много времени, чтобы разобраться, какая из черепашек обманывает.</p><h2 id=когда-можно-и-прокомментировать>Когда можно и прокомментировать</h2><h3 id=комментарии-которые-повышают-уровень-абстракции>Комментарии, которые повышают уровень абстракции</h3><p>Предметная область может быть очень сложна, не всегда возможно подобрать краткие названия для классов, из которых сразу будет понятно, чему они соответствуют. Поэтому вполне нормально подобрать какой-нибудь ёмкий термин для обозначения сложной сущности предметной области. Основные программисты команды и так его наизусть знают, а вот для новичков можно составить краткий комментарий, из которого всё сразу станет понятно.</p><h3 id=комментарии-которые-объясняют-необъяснимое>Комментарии, которые объясняют необъяснимое</h3><p>Увы, не всегда удаётся написать код, который понятен сам по себе. Возможно, используется очень хитрый алгоритм. Возможно, из-за требований к скорости пришлось написать быстрый, но не очень понятный код. Возможно, проект нужно сдавать вчера, и у вас просто нет времени «причёсывать» код. Не важно как, но в вашем проекте появился код, который ну очень трудно понять. Если с комментарием код становится более читаемым, то пусть этот комментарий действительно присутствует в проекте.</p><h3 id=комментарии-которые-todo>Комментарии, которые TODO</h3><p>Вопрос опять-таки дискуссионный. Одни скажут, что есть IssueTacker, давайте все задачи хранить там. Другие скажут, что зачем нам создавать много мелких Issue, когда можно просто расставить комментарии специального вида, которые будут обращать внимание разработчиков на то, что тут надо бы дописать функционал. Благо, современные IDE умеют находить все TODO-комментарии и выдавать их большим красивым списком, так что не нужно бояться потерять подобные инструкции на будущее. Нужно сразу договориться в команде о том, какая методология будет использоваться. Многие программисты считают TODO-комментарии очень удобными, ничего особо криминального в их использовании нет.</p><h3 id=комментарии-которые-обращают-внимание>Комментарии, которые обращают внимание</h3><p>Иногда в коде появляются какие-то важные моменты, на которые обязательно нужно обратить внимание читателя, но средствами кода это сделать не удаётся. Например, нужно предупредить читателя, что метод выполняется очень долго. Или, класс сейчас активно разрабатывается и рефакторится несколькими людьми, в нём есть какой-то невзрачный кусок кода, который так и хочется удалить или переписать. Но лучше бы этого не делать, т.к. на самом деле он очень важный, без него всё сломается. В общем, если есть какие-то важные, но не особо очевидные аспекты вашего кода — можно и прокомментировать, лишним такой комментарий не назовёшь.</p><h3 id=комментарии-которые-документируют>Комментарии, которые документируют</h3><p>Многие генерируют документацию на основе комментариев специального вида (такой подход используется во многих языках). Есть и другие инструменты по созданию документации без комментариев, но в силу разных обстоятельств в некоторых проектах принципиально использовать именно комментарии для документирования, тут уж никуда не деться. Но тут речь идёт скорее о публичном API, а не о private-методе во внутреннем проекте. В команде должна быть договорённость о том, когда и где будет использоваться подобный подход к документации. Ваше время очень ценно, не следует его тратить на создание такой документации, которая никогда никем не будет использоваться.</p><h3 id=комментарии-которые-содержат-юридическую-информацию>Комментарии, которые содержат юридическую информацию</h3><p>В ряде проектов необходимо в каждый файл с кодом вставлять шапку-комментарий с информацией о копирайте, лицензии и т.п. Ну, если надо — то надо, обсуждения тут излишни.</p><h2 id=резюме>Резюме</h2><p>Ещё раз хотелось бы акцентировать внимание на основной мысли: хоть я и настаиваю на уменьшении количества комментариев, это вовсе не означает, что комментарии — абсолютное зло, которое никак не должно появляться в проекте. Если вы можете обосновать необходимость комментария в данном месте, если без него не обойтись, если вы можете его составить грамотно и лаконично — то пожалуйста, пишите комментарий, ведь вы делаете исходный код более информативным. Но, увы, в реальности большинство комментариев не несут в себе особой пользы, а лишь захламляют исходники. Если ваши руки потянулись к написанию ещё одного <em>отличного</em> комментария, то сначала дайте себе немного времени на раздумье — а действительно ли этот комментарий такой <em>отличный</em>, а нельзя ли без него как-нибудь обойтись.</p><p>Хочется заметить, что в реальных условиях многое зависит от языка программирования, от проекта, от стадии разработки, от соглашений в команде. Возможно, конкретно в вашей ситуации есть необходимость писать много комментариев (это может быть сложный алгоритм, низкоуровневый код, хитрые оптимизации и т.п.). Возможно, вы сейчас пишете локальный код, а с комментариями вам намного удобнее работать над кодом (впрочем, никто не заставляет вас коммитить комментарии в общий репозиторий). Возможно, у вас весь проект на 100 строк, и намного проще поставить несколько комментариев, чем создавать сложную расширяемую архитектуру. В статье я изложил некоторые общие рекомендации для большого проекта на языке высокого уровня, которые могут в будущем избавить вас и ваших коллег от лишней головной боли. Но не нужно относиться к предложенным практикам как к абсолютным правилам: всегда нужно смотреть по ситуации — уместно ли поставить очередной комментарий, нужен ли он тут, или же лучше будет без него. Старайтесь уделять внимание таким моментам — и ваш код будет намного лучше.</p><h2 id=кросс-посты>Кросс-посты</h2><ul><li><a href=http://habrahabr.ru/post/182574/>Хабрахабр</a></li></ul><br><br><div class=mx-auto>Поделиться:<div class=faicon><a href="https://twitter.com/intent/tweet?text=%d0%9a%d0%be%d0%bc%d0%bc%d0%b5%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c%20%d0%b8%d0%bb%d0%b8%20%d0%bd%d0%b5%20%d0%ba%d0%be%d0%bc%d0%bc%d0%b5%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c%3f&url=https%3a%2f%2faakinshin.net%2fru%2fposts%2fcomments%2f&via=andrey_akinshin&related=andrey_akinshin" rel=nofollow target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-2x" title=Twitter></i></a></div><div class=faicon><a href="https://www.reddit.com/submit?url=https%3a%2f%2faakinshin.net%2fru%2fposts%2fcomments%2f&title=%d0%9a%d0%be%d0%bc%d0%bc%d0%b5%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c%20%d0%b8%d0%bb%d0%b8%20%d0%bd%d0%b5%20%d0%ba%d0%be%d0%bc%d0%bc%d0%b5%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c%3f" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-2x"></i></a></div><div class=faicon><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faakinshin.net%2fru%2fposts%2fcomments%2f" target=_blank title="Share on HackerNews"><i class="fab fa-hacker-news fa-2x"></i></a></div><div class=faicon><a href="https://facebook.com/sharer.php?u=https%3a%2f%2faakinshin.net%2fru%2fposts%2fcomments%2f" rel=nofollow target=_blank title="Share on Facebook"><i class="fab fa-facebook fa-2x"></i></a></div><div class=faicon><a href="http://vk.com/share.php?url=https%3a%2f%2faakinshin.net%2fru%2fposts%2fcomments%2f" target=_blank title="Share on VKontakte"><i class="fab fa-vk fa-2x"></i></a></div><div class=faicon><a href="https://getpocket.com/save?url=https%3a%2f%2faakinshin.net%2fru%2fposts%2fcomments%2f&title=%d0%9a%d0%be%d0%bc%d0%bc%d0%b5%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c%20%d0%b8%d0%bb%d0%b8%20%d0%bd%d0%b5%20%d0%ba%d0%be%d0%bc%d0%bc%d0%b5%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c%3f" target=_blank title="Add to Pocket"><i class="fab fa-get-pocket fa-2x"></i></a></div></div><hr></div></div></main></div><footer class=blog-footer><div class=container><p>&copy; 2013–2020 Андрей Акиньшин | <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></p></div></footer><script src=https://aakinshin.net/js/theme-after.min.ea4f51ac7f59c8e13f4df787df946eb1a447174ce2f1fc5349483de93a607ecb.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/anchor.min.js></script><script src=https://aakinshin.net/js/custom.min.11932490dde776463ed165b345838c701accc0cfdedf2e0868f13415f41f0872.js></script></body></html>